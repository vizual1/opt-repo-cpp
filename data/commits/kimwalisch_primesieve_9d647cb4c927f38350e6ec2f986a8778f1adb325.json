{
  "metadata": {
    "collection_date": "2026-02-03T20:03:16.896754",
    "repository": "https://github.com/kimwalisch/primesieve",
    "repository_name": "kimwalisch/primesieve"
  },
  "commit_info": {
    "old_sha": "286ecbea9c0ce924716951098b801a8ce4574c79",
    "new_sha": "9d647cb4c927f38350e6ec2f986a8778f1adb325",
    "commit_message": [
      "Multiple buffers in PreSieve, 4-8% speedup\n\nIntroduces multiple presieves with small primes distributed among them. This lets us significantly increase the number of pre-sieved primes while keeping a similar memory footprint.\r\n\r\nThe overall speed improvement for < 10^10 is about 5-8%."
    ],
    "commit_date": "2022-01-07T13:02:06+00:00",
    "patch": [
      "--- include/primesieve/PreSieve.hpp\n@@ -1,7 +1,22 @@\n ///\n-/// @file  PreSieve.hpp\n+/// @file   PreSieve.hpp\n+/// @brief  Pre-sieve multiples of small primes <= 59 to speed up the\n+///         sieve of Eratosthenes. The idea is to allocate several\n+///         arrays (buffers_) and remove the multiples of small primes\n+///         from them at initialization. Each buffer is assigned\n+///         different primes, for example:\n ///\n-/// Copyright (C) 2020 Kim Walisch, <kim.walisch@gmail.com>\n+///         Buffer 0 removes multiplies of:  7, 19, 23, 29\n+///         Buffer 1 removes multiplies of: 11, 13, 17, 37\n+///         Buffer 2 removes multiplies of: 31, 47, 59\n+///         Buffer 3 removes multiplies of: 41, 43, 53\n+///\n+///         Then whilst sieving, we perform a bitwise AND on the\n+///         buffers_ arrays and store the result in the sieve array.\n+///         Pre-sieving provides a speedup of up to 30% when\n+///         sieving the primes < 10^10 using primesieve.\n+///\n+/// Copyright (C) 2022 Kim Walisch, <kim.walisch@gmail.com>\n ///\n /// This file is distributed under the BSD License. See the COPYING\n /// file in the top level directory.\n@@ -11,41 +26,24 @@\n #define PRESIEVE_HPP\n \n #include <stdint.h>\n+#include <array>\n #include <vector>\n \n namespace primesieve {\n \n-/// PreSieve objects are used to pre-sieve multiples of small primes\n-/// e.g. <= 19 to speed up the sieve of Eratosthenes. The idea is to\n-/// allocate an array (buffer_) and remove the multiples of small\n-/// primes from it at initialization. Then whilst sieving, the\n-/// buffer_ array is copied to the sieve array at the beginning of\n-/// each new segment to pre-sieve the multiples of small\n-/// primes <= maxPrime_. Pre-sieving speeds up my sieve of Eratosthenes\n-/// implementation by about 20 percent when sieving < 10^10.\n-///\n-/// <b> Memory Usage </b>\n-///\n-/// - PreSieve objects use: primeProduct(maxPrime_) / 30 bytes of memory\n-/// - PreSieve multiples of primes <=  7 uses    7    bytes\n-/// - PreSieve multiples of primes <= 11 uses   77    bytes\n-/// - PreSieve multiples of primes <= 13 uses 1001    bytes\n-/// - PreSieve multiples of primes <= 17 uses   17.02 kilobytes\n-/// - PreSieve multiples of primes <= 19 uses  323.32 kilobytes\n-/// - PreSieve multiples of primes <= 23 uses    7.44 megabytes\n-///\n class PreSieve\n {\n public:\n-  void init(uint64_t, uint64_t);\n+  void init(uint64_t start, uint64_t stop);\n+  void preSieve(uint8_t* sieve, uint64_t sieveSize, uint64_t segmentLow) const;\n   uint64_t getMaxPrime() const { return maxPrime_; }\n-  void copy(uint8_t*, uint64_t, uint64_t) const;\n private:\n-  uint64_t maxPrime_ = 0;\n-  uint64_t primeProduct_ = 0;\n-  uint64_t size_ = 0;\n-  std::vector<uint8_t> buffer_;\n-  void initBuffer(uint64_t, uint64_t);\n+  uint64_t buffersDist_ = 0;\n+  uint64_t maxPrime_ = 13;\n+  std::array<std::vector<uint8_t>, 4> buffers_;\n+  void initBuffers();\n+  static void preSieveSmall(uint8_t* sieve, uint64_t sieveSize, uint64_t segmentLow);\n+  void preSieveLarge(uint8_t* sieve, uint64_t sieveSize, uint64_t segmentLow) const;\n };\n \n } // namespace\n--- src/Erat.cpp\n@@ -151,18 +151,16 @@ uint64_t Erat::byteRemainder(uint64_t n)\n   return n;\n }\n \n-/// Pre-sieve multiples of small primes e.g. <= 19\n+/// Pre-sieve multiples of small primes e.g. <= 59\n /// to speed up the sieve of Eratosthenes\n ///\n void Erat::preSieve()\n {\n-  preSieve_->copy(sieve_, sieveSize_, segmentLow_);\n+  preSieve_->preSieve(sieve_, sieveSize_, segmentLow_);\n \n   // unset bits < start\n   if (segmentLow_ <= start_)\n   {\n-    if (start_ <= maxPreSieve_)\n-      sieve_[0] = 0xff;\n     uint64_t rem = byteRemainder(start_);\n     sieve_[0] &= unsetSmaller[rem];\n   }\n--- src/PreSieve.cpp\n@@ -1,28 +1,22 @@\n ///\n /// @file   PreSieve.cpp\n-/// @brief  Pre-sieve multiples of small primes to speed up the sieve\n-///         of Eratosthenes. At startup primesieve initializes a small\n-///         buffer of size p1*p2*p3*pn and removes the multiples of\n-///         the first n primes from that buffer. Then while sieving at\n-///         the start of each new segment this buffer is simply copied\n-///         to the sieve array and now we can start sieving at p(n+1)\n-///         instead of p1. By default primesieve pre-sieves multiples\n-///         of primes <= 19, in practice pre-sieving using even larger\n-///         primes uses too much memory and slows things down. In\n-///         primesieve pre-sieving provides a minor speed of up to 20%\n-///         when the sieving distance is relatively small\n-///         e.g. < 10^10.\n+/// @brief  Pre-sieve multiples of small primes <= 59 to speed up the\n+///         sieve of Eratosthenes. The idea is to allocate several\n+///         arrays (buffers_) and remove the multiples of small primes\n+///         from them at initialization. Each buffer is assigned\n+///         different primes, for example:\n ///\n-///         The pre-sieve buffer can be both smaller or larger than\n-///         the actual sieve array so a little care needs to be taken\n-///         when copying the buffer to the sieve array. When the\n-///         buffer is smaller than the sieve array we need to\n-///         repeatedly copy the buffer to the sieve array until the\n-///         sieve array has been filled completely. When the buffer is\n-///         larger than the sieve array we only need to partially copy\n-///         it to the sieve array.\n+///         Buffer 0 removes multiplies of:  7, 19, 23, 29\n+///         Buffer 1 removes multiplies of: 11, 13, 17, 37\n+///         Buffer 2 removes multiplies of: 31, 47, 59\n+///         Buffer 3 removes multiplies of: 41, 43, 53\n ///\n-/// Copyright (C) 2020 Kim Walisch, <kim.walisch@gmail.com>\n+///         Then whilst sieving, we perform a bitwise AND on the\n+///         buffers_ arrays and store the result in the sieve array.\n+///         Pre-sieving provides a speedup of up to 30% when\n+///         sieving the primes < 10^10 using primesieve.\n+///\n+/// Copyright (C) 2022 Kim Walisch, <kim.walisch@gmail.com>\n ///\n /// This file is distributed under the BSD License. See the COPYING\n /// file in the top level directory.\n@@ -35,18 +29,140 @@\n #include <stdint.h>\n #include <algorithm>\n #include <array>\n-#include <iterator>\n+#include <cassert>\n #include <vector>\n \n-using namespace std;\n+using std::copy_n;\n+using std::size_t;\n \n namespace {\n \n-// Small primes >= 7\n-const array<uint64_t, 5> primes = { 7, 11, 13, 17, 19 };\n+/// Pre-sieve with the primes <= 13\n+const std::array<uint8_t, 7*11*13> buffer_7_11_13 =\n+{\n+  0xf8, 0xef, 0x77, 0x3f, 0xdb, 0xed, 0x9e, 0xfc, 0xea, 0x37,\n+  0xaf, 0xf9, 0xf5, 0xd3, 0x7e, 0x4f, 0x77, 0x9e, 0xeb, 0xf9,\n+  0xdd, 0xee, 0xad, 0x77, 0xb7, 0x73, 0xd9, 0xdf, 0x3e, 0xef,\n+  0x53, 0xaf, 0xeb, 0xfd, 0xde, 0xb6, 0x6f, 0x57, 0xb7, 0xba,\n+  0xfd, 0x5b, 0xfe, 0xcf, 0x65, 0xbf, 0xf1, 0x7c, 0x9f, 0xfe,\n+  0xae, 0x77, 0xbb, 0xfb, 0x6d, 0xdd, 0xde, 0xe7, 0x77, 0x9d,\n+  0xfa, 0xbc, 0xdf, 0xfa, 0xe7, 0x63, 0xbd, 0x7b, 0xf5, 0x5f,\n+  0xce, 0xef, 0x34, 0xbe, 0xbb, 0xfd, 0xcf, 0xf4, 0xeb, 0x77,\n+  0x3f, 0xdb, 0xdd, 0x8e, 0xfe, 0xe9, 0x76, 0xaf, 0xf9, 0xfd,\n+  0xd7, 0x7a, 0xcf, 0x77, 0xbe, 0xdb, 0xe9, 0xdf, 0xec, 0xec,\n+  0x37, 0xb7, 0x7b, 0xd5, 0xdb, 0xbe, 0x6f, 0x73, 0x9f, 0xeb,\n+  0xfd, 0xdd, 0xf6, 0x2f, 0x57, 0xbf, 0xb2, 0xf9, 0xdb, 0x7e,\n+  0xef, 0x55, 0xaf, 0xf3, 0x7d, 0xde, 0xbe, 0xae, 0x77, 0xb3,\n+  0xfb, 0xed, 0x5d, 0xfe, 0xc7, 0x67, 0x9f, 0xf9, 0xbc, 0x9f,\n+  0xfa, 0xef, 0x67, 0xb9, 0xfb, 0x75, 0x5f, 0xde, 0xef, 0x36,\n+  0xbd, 0xfa, 0xbd, 0xcf, 0xfc, 0xe7, 0x73, 0x3f, 0x5b, 0xfd,\n+  0x9e, 0xee, 0xeb, 0x75, 0xae, 0xb9, 0xfd, 0xd7, 0x76, 0xcb,\n+  0x77, 0x3e, 0xfb, 0xd9, 0xcf, 0xee, 0xed, 0x76, 0xb7, 0x7b,\n+  0xdd, 0xd7, 0xba, 0xef, 0x73, 0xbf, 0xcb, 0xed, 0xdf, 0xf4,\n+  0x6e, 0x17, 0xbf, 0xba, 0xf5, 0xdb, 0xfe, 0x6f, 0x75, 0x9f,\n+  0xe3, 0x7d, 0xdd, 0xfe, 0xae, 0x77, 0xbb, 0xf3, 0xe9, 0xdd,\n+  0x7e, 0xe7, 0x57, 0x8f, 0xfb, 0xbc, 0xde, 0xba, 0xef, 0x67,\n+  0xb5, 0xfb, 0xf5, 0x5f, 0xde, 0xcf, 0x26, 0xbf, 0xf9, 0xfc,\n+  0x8f, 0xfc, 0xef, 0x77, 0x3b, 0xdb, 0x7d, 0x9e, 0xde, 0xeb,\n+  0x77, 0xad, 0xf8, 0xbd, 0xd7, 0x7e, 0xc7, 0x73, 0xbe, 0x7b,\n+  0xf9, 0xdf, 0xee, 0xed, 0x75, 0xb6, 0x3b, 0xdd, 0xdf, 0xb6,\n+  0xeb, 0x73, 0x3f, 0xeb, 0xdd, 0xcf, 0xf6, 0x6d, 0x56, 0xbf,\n+  0xba, 0xfd, 0xd3, 0xfa, 0xef, 0x75, 0xbf, 0xd3, 0x6d, 0xdf,\n+  0xfc, 0xae, 0x37, 0xbb, 0xfb, 0xe5, 0xd9, 0xfe, 0x67, 0x77,\n+  0x9f, 0xeb, 0xbc, 0xdd, 0xfa, 0xaf, 0x67, 0xbd, 0xf3, 0xf1,\n+  0x5f, 0x5e, 0xef, 0x16, 0xaf, 0xfb, 0xfd, 0xce, 0xbc, 0xef,\n+  0x77, 0x37, 0xdb, 0xfd, 0x1e, 0xfe, 0xcb, 0x67, 0xaf, 0xf9,\n+  0xfc, 0x97, 0x7e, 0xcf, 0x77, 0xba, 0xfb, 0x79, 0xdf, 0xce,\n+  0xed, 0x77, 0xb5, 0x7a, 0x9d, 0xdf, 0xbe, 0xe7, 0x73, 0xbf,\n+  0x6b, 0xfd, 0xdf, 0xe6, 0x6f, 0x55, 0xbe, 0xba, 0xfd, 0xdb,\n+  0xf6, 0xeb, 0x75, 0x3f, 0xf3, 0x5d, 0xcf, 0xfe, 0xac, 0x76,\n+  0xbb, 0xfb, 0xed, 0xd5, 0xfa, 0xe7, 0x77, 0x9f, 0xdb, 0xac,\n+  0xdf, 0xf8, 0xee, 0x27, 0xbd, 0xfb, 0xf5, 0x5b, 0xde, 0x6f,\n+  0x36, 0x9f, 0xeb, 0xfd, 0xcd, 0xfc, 0xaf, 0x77, 0x3f, 0xd3,\n+  0xf9, 0x9e, 0x7e, 0xeb, 0x57, 0xaf, 0xf9, 0xfd, 0xd6, 0x3e,\n+  0xcf, 0x77, 0xb6, 0xfb, 0xf9, 0x5f, 0xee, 0xcd, 0x67, 0xb7,\n+  0x79, 0xdc, 0x9f, 0xbe, 0xef, 0x73, 0xbb, 0xeb, 0x7d, 0xdf,\n+  0xd6, 0x6f, 0x57, 0xbd, 0xba, 0xbd, 0xdb, 0xfe, 0xe7, 0x71,\n+  0xbf, 0x73, 0x7d, 0xdf, 0xee, 0xae, 0x75, 0xba, 0xbb, 0xed,\n+  0xdd, 0xf6, 0xe3, 0x77, 0x1f, 0xfb, 0x9c, 0xcf, 0xfa, 0xed,\n+  0x66, 0xbd, 0xfb, 0xf5, 0x57, 0xda, 0xef, 0x36, 0xbf, 0xdb,\n+  0xed, 0xcf, 0xfc, 0xee, 0x37, 0x3f, 0xdb, 0xf5, 0x9a, 0xfe,\n+  0x6b, 0x77, 0x8f, 0xe9, 0xfd, 0xd5, 0x7e, 0x8f, 0x77, 0xbe,\n+  0xf3, 0xf9, 0xdf, 0x6e, 0xed, 0x57, 0xa7, 0x7b, 0xdd, 0xde,\n+  0xbe, 0xef, 0x73, 0xb7, 0xeb, 0xfd, 0x5f, 0xf6, 0x4f, 0x47,\n+  0xbf, 0xb8, 0xfc, 0x9b, 0xfe, 0xef, 0x75, 0xbb, 0xf3, 0x7d,\n+  0xdf, 0xde, 0xae, 0x77, 0xb9, 0xfa, 0xad, 0xdd, 0xfe, 0xe7,\n+  0x73, 0x9f, 0x7b, 0xbc, 0xdf, 0xea, 0xef, 0x65, 0xbc, 0xbb,\n+  0xf5, 0x5f, 0xd6, 0xeb, 0x36, 0x3f, 0xfb, 0xdd, 0xcf, 0xfc,\n+  0xed, 0x76, 0x3f, 0xdb, 0xfd, 0x96, 0xfa, 0xeb, 0x77, 0xaf,\n+  0xd9, 0xed, 0xd7, 0x7c, 0xce, 0x37, 0xbe, 0xfb, 0xf1, 0xdb,\n+  0xee, 0x6d, 0x77, 0x97, 0x6b, 0xdd, 0xdd, 0xbe, 0xaf, 0x73,\n+  0xbf, 0xe3, 0xf9, 0xdf, 0x76, 0x6f, 0x57, 0xaf, 0xba, 0xfd,\n+  0xda, 0xbe, 0xef, 0x75, 0xb7, 0xf3, 0x7d, 0x5f, 0xfe, 0x8e,\n+  0x67, 0xbb, 0xf9, 0xec, 0x9d, 0xfe, 0xe7, 0x77, 0x9b, 0xfb,\n+  0x3c, 0xdf, 0xda, 0xef, 0x67, 0xbd, 0xfa, 0xb5, 0x5f, 0xde,\n+  0xe7, 0x32, 0xbf, 0x7b, 0xfd, 0xcf, 0xec, 0xef, 0x75, 0x3e,\n+  0x9b, 0xfd, 0x9e, 0xf6, 0xeb, 0x77, 0x2f, 0xf9, 0xdd, 0xc7,\n+  0x7e, 0xcd, 0x76, 0xbe, 0xfb, 0xf9, 0xd7, 0xea, 0xed, 0x77,\n+  0xb7, 0x5b, 0xcd, 0xdf, 0xbc, 0xee, 0x33, 0xbf, 0xeb, 0xf5,\n+  0xdb, 0xf6, 0x6f, 0x57, 0x9f, 0xaa, 0xfd, 0xd9, 0xfe, 0xaf,\n+  0x75, 0xbf, 0xf3, 0x79, 0xdf, 0x7e, 0xae, 0x57, 0xab, 0xfb,\n+  0xed, 0xdc, 0xbe, 0xe7, 0x77, 0x97, 0xfb, 0xbc, 0x5f, 0xfa,\n+  0xcf, 0x67, 0xbd, 0xf9, 0xf4, 0x1f, 0xde, 0xef, 0x36, 0xbb,\n+  0xfb, 0x7d, 0xcf, 0xdc, 0xef, 0x77, 0x3d, 0xda, 0xbd, 0x9e,\n+  0xfe, 0xe3, 0x73, 0xaf, 0x79, 0xfd, 0xd7, 0x6e, 0xcf, 0x75,\n+  0xbe, 0xbb, 0xf9, 0xdf, 0xe6, 0xe9, 0x77, 0x37, 0x7b, 0xdd,\n+  0xcf, 0xbe, 0xed, 0x72, 0xbf, 0xeb, 0xfd, 0xd7, 0xf2, 0x6f,\n+  0x57, 0xbf, 0x9a, 0xed, 0xdb, 0xfc, 0xee, 0x35, 0xbf, 0xf3,\n+  0x75, 0xdb, 0xfe, 0x2e, 0x77, 0x9b, 0xeb, 0xed, 0xdd, 0xfe,\n+  0xa7, 0x77, 0x9f, 0xf3, 0xb8, 0xdf, 0x7a, 0xef, 0x47, 0xad,\n+  0xfb, 0xf5, 0x5e, 0x9e, 0xef, 0x36, 0xb7, 0xfb, 0xfd, 0x4f,\n+  0xfc, 0xcf, 0x67, 0x3f, 0xd9, 0xfc, 0x9e, 0xfe, 0xeb, 0x77,\n+  0xab, 0xf9, 0x7d, 0xd7, 0x5e, 0xcf, 0x77, 0xbc, 0xfa, 0xb9,\n+  0xdf, 0xee, 0xe5, 0x73, 0xb7, 0x7b, 0xdd, 0xdf, 0xae, 0xef,\n+  0x71, 0xbe, 0xab, 0xfd, 0xdf, 0xf6, 0x6b, 0x57, 0x3f, 0xba,\n+  0xdd, 0xcb, 0xfe, 0xed, 0x74, 0xbf, 0xf3, 0x7d, 0xd7, 0xfa,\n+  0xae, 0x77, 0xbb, 0xdb, 0xed, 0xdd, 0xfc, 0xe6, 0x37, 0x9f,\n+  0xfb, 0xb4, 0xdb, 0xfa, 0x6f, 0x67, 0x9d, 0xeb, 0xf5, 0x5d,\n+  0xde, 0xaf, 0x36, 0xbf, 0xf3, 0xf9, 0xcf, 0x7c, 0xef, 0x57,\n+  0x2f, 0xdb, 0xfd, 0x9e, 0xbe, 0xeb, 0x77, 0xa7, 0xf9, 0xfd,\n+  0x57, 0x7e, 0xcf, 0x67, 0xbe, 0xf9, 0xf8, 0x9f, 0xee, 0xed,\n+  0x77, 0xb3, 0x7b, 0x5d, 0xdf, 0x9e, 0xef, 0x73, 0xbd, 0xea,\n+  0xbd, 0xdf, 0xf6, 0x67, 0x53, 0xbf, 0x3a, 0xfd, 0xdb, 0xee,\n+  0xef, 0x75, 0xbe, 0xb3, 0x7d, 0xdf, 0xf6, 0xaa, 0x77, 0x3b,\n+  0xfb, 0xcd, 0xcd, 0xfe, 0xe5, 0x76, 0x9f, 0xfb, 0xbc, 0xd7,\n+  0xfa, 0xef, 0x67, 0xbd, 0xdb, 0xe5, 0x5f, 0xdc, 0xee, 0x36,\n+  0xbf, 0xfb, 0xf5, 0xcb, 0xfc, 0x6f, 0x77, 0x1f, 0xcb, 0xfd,\n+  0x9c, 0xfe, 0xab, 0x77, 0xaf, 0xf1, 0xf9, 0xd7, 0x7e, 0xcf,\n+  0x57, 0xae, 0xfb, 0xf9, 0xde, 0xae, 0xed, 0x77, 0xb7, 0x7b,\n+  0xdd, 0x5f, 0xbe, 0xcf, 0x63, 0xbf, 0xe9, 0xfc, 0x9f, 0xf6,\n+  0x6f, 0x57, 0xbb, 0xba, 0x7d, 0xdb, 0xde, 0xef, 0x75, 0xbd,\n+  0xf2, 0x3d, 0xdf, 0xfe, 0xa6, 0x73, 0xbb, 0x7b, 0xed, 0xdd,\n+  0xee, 0xe7, 0x75, 0x9e, 0xbb, 0xbc, 0xdf, 0xf2, 0xeb, 0x67,\n+  0x3d, 0xfb, 0xd5, 0x4f, 0xde, 0xed, 0x36, 0xbf, 0xfb, 0xfd,\n+  0xc7\n+};\n+\n+/// Pre-sieve with the primes <= 59\n+const std::array<std::vector<uint64_t>, 4> bufferPrimes =\n+{{\n+  {  7, 19, 23, 29 }, // 89 KiB\n+  { 11, 13, 17, 37 }, // 90 KiB\n+  { 31, 47, 59 },     // 86 KiB\n+  { 41, 43, 53 }      // 93 KiB\n+}};\n \n-// Prime products of primes >= 7\n-const array<uint64_t, 5> primeProducts = { 210, 2310, 30030, 510510, 9699690 };\n+void andBuffers(const uint8_t* buf1,\n+                const uint8_t* buf2,\n+                const uint8_t* buf3,\n+                const uint8_t* buf4,\n+                uint8_t* output,\n+                size_t bytes)\n+{\n+  // This loop should be auto-vectorized\n+  for (size_t i = 0; i < bytes; i++)\n+    output[i] = buf1[i] & buf2[i] & buf3[i] & buf4[i];\n+}\n \n } // namespace\n \n@@ -55,54 +171,96 @@ namespace primesieve {\n void PreSieve::init(uint64_t start,\n                     uint64_t stop)\n {\n-  // The pre-sieve buffer should be at least 100\n+  // Already initialized\n+  if (!buffers_[0].empty())\n+    return;\n+\n+  // The pre-sieve buffers should be at least 30\n   // times smaller than the sieving distance\n   // in order to reduce initialization overhead.\n   uint64_t dist = stop - start;\n-  uint64_t threshold = max(dist, isqrt(stop)) / 100;\n-  auto last =  primeProducts.end() - 1;\n-  auto iter = lower_bound(primeProducts.begin(), last, threshold);\n-  auto i = distance(primeProducts.begin(), iter);\n+  uint64_t threshold = std::max(dist, isqrt(stop)) / 30;\n \n-  if (primes.at(i) > maxPrime_)\n-    initBuffer(primes[i], primeProducts[i]);\n+  if (!buffersDist_)\n+  {\n+    for (const auto& primes : bufferPrimes)\n+    {\n+      uint64_t bufferBytes = 1;\n+      for (auto prime : primes)\n+        bufferBytes *= prime;\n+      buffersDist_ += bufferBytes * 30;\n+    }\n+  }\n+\n+  // For small intervals we pre-sieve using the\n+  // static buffer_7_11_13 lookup table. In this\n+  // case no initialization is required.\n+  if (threshold < buffersDist_)\n+    return;\n+\n+  initBuffers();\n }\n \n-/// Initialize the buffer by removing the\n-/// multiples of primes <= maxPrime.\n+/// We are sieving a large interval, we have to\n+/// initialize all pre-sieve buffers.\n ///\n-void PreSieve::initBuffer(uint64_t maxPrime,\n-                          uint64_t primeProduct)\n+void PreSieve::initBuffers()\n {\n-  maxPrime_ = maxPrime;\n-  primeProduct_ = primeProduct;\n-  size_ = primeProduct_ / 30;\n+  for (size_t i = 0; i < buffers_.size(); i++)\n+  {\n+    uint64_t product = 30;\n+\n+    for (auto prime : bufferPrimes[i])\n+      product *= prime;\n \n-  buffer_.clear();\n-  buffer_.resize(size_, 0xff);\n+    uint64_t start = product;\n+    uint64_t stop = start + product;\n+    buffers_[i].resize(product / 30, 0xff);\n+    uint64_t maxPrime = bufferPrimes[i].back();\n+    assert(start >= maxPrime * maxPrime);\n+    maxPrime_ = std::max(maxPrime_, maxPrime);\n \n-  EratSmall eratSmall;\n-  uint64_t stop = primeProduct_ * 2;\n-  eratSmall.init(stop, size_, maxPrime_);\n+    EratSmall eratSmall;\n+    eratSmall.init(stop, buffers_[i].size(), maxPrime);\n \n-  for (uint64_t prime : primes)\n-    if (prime <= maxPrime_)\n-      eratSmall.addSievingPrime(prime, primeProduct_);\n+    for (uint64_t prime : bufferPrimes[i])\n+      eratSmall.addSievingPrime(prime, start);\n \n-  auto buffer = buffer_.data();\n-  eratSmall.crossOff(buffer, size_);\n+    eratSmall.crossOff(buffers_[i].data(), buffers_[i].size());\n+  }\n }\n \n-/// Copy pre-sieved buffer to sieve array\n-void PreSieve::copy(uint8_t* sieve,\n-                    uint64_t sieveSize,\n-                    uint64_t segmentLow) const\n+void PreSieve::preSieve(uint8_t* sieve,\n+                        uint64_t sieveSize,\n+                        uint64_t segmentLow) const\n {\n-  // Find segmentLow index\n-  uint64_t remainder = segmentLow % primeProduct_;\n-  uint64_t i = remainder / 30;\n-  uint64_t sizeLeft = size_ - i;\n-  auto buffer = buffer_.data();\n+  if (buffers_[0].empty())\n+    preSieveSmall(sieve, sieveSize, segmentLow);\n+  else\n+    preSieveLarge(sieve, sieveSize, segmentLow);\n+\n+  // Pre-sieving removes the primes <= 59. We\n+  // have to undo that work and reset these bits\n+  // to 1 (but 49 = 7 * 7 is not a prime).\n+  uint8_t bit49 = 1 << 4;\n+  size_t i = 0;\n+\n+  if (segmentLow < 30)\n+    sieve[i++] = 0xff;\n+  if (segmentLow < 60)\n+    sieve[i++] = 0xff ^ bit49;\n+}\n+\n+/// Pre-sieve with the primes <= 13\n+void PreSieve::preSieveSmall(uint8_t* sieve,\n+                             uint64_t sieveSize,\n+                             uint64_t segmentLow)\n+{\n+  uint64_t size = buffer_7_11_13.size();\n+  uint64_t primeProduct = size * 30;\n+  uint64_t i = (segmentLow % primeProduct) / 30;\n+  uint64_t sizeLeft = size - i;\n+  auto buffer = buffer_7_11_13.data();\n \n   if (sieveSize <= sizeLeft)\n     copy_n(&buffer[i], sieveSize, sieve);\n@@ -113,12 +271,48 @@ void PreSieve::copy(uint8_t* sieve,\n     copy_n(&buffer[i], sizeLeft, sieve);\n \n     // Restart copying at the beginning of buffer\n-    for (i = sizeLeft; i + size_ < sieveSize; i += size_)\n-      copy_n(buffer, size_, &sieve[i]);\n+    for (i = sizeLeft; i + size < sieveSize; i += size)\n+      copy_n(buffer, size, &sieve[i]);\n \n     // Copy the last remaining bytes\n     copy_n(buffer, sieveSize - i, &sieve[i]);\n   }\n }\n \n+/// Pre-sieve with the primes <= 59\n+void PreSieve::preSieveLarge(uint8_t* sieve,\n+                             uint64_t sieveSize,\n+                             uint64_t segmentLow) const\n+{\n+  uint64_t offset = 0;\n+  std::array<uint64_t, bufferPrimes.size()> pos;\n+\n+  for (size_t i = 0; i < buffers_.size(); i++)\n+    pos[i] = (segmentLow % (buffers_[i].size() * 30)) / 30;\n+\n+  while (offset < sieveSize) {\n+    uint64_t bytesToCopy = sieveSize - offset;\n+\n+    for (size_t i = 0; i < buffers_.size(); i++) {\n+      uint64_t left = buffers_[i].size() - pos[i];\n+      bytesToCopy = std::min(left, bytesToCopy);\n+    }\n+\n+    andBuffers(&buffers_[0][pos[0]],\n+               &buffers_[1][pos[1]],\n+               &buffers_[2][pos[2]],\n+               &buffers_[3][pos[3]],\n+               &sieve[offset],\n+               bytesToCopy);\n+\n+    offset += bytesToCopy;\n+\n+    for (size_t i = 0; i < buffers_.size(); i++) {\n+      pos[i] += bytesToCopy;\n+      if (pos[i] >= buffers_[i].size())\n+        pos[i] = 0;\n+    }\n+  }\n+}\n+\n } // namespace\n--- src/SievingPrimes.cpp\n@@ -2,7 +2,7 @@\n /// @file  SievingPrimes.cpp\n ///        Generates the sieving primes up n^(1/2).\n ///\n-/// Copyright (C) 2019 Kim Walisch, <kim.walisch@gmail.com>\n+/// Copyright (C) 2022 Kim Walisch, <kim.walisch@gmail.com>\n ///\n /// This file is distributed under the BSD License. See the COPYING\n /// file in the top level directory.\n@@ -32,6 +32,7 @@ void SievingPrimes::init(Erat* erat, PreSieve& preSieve)\n              erat->getSieveSize(),\n              preSieve);\n \n+  low_ = segmentLow_;\n   tinySieve();\n }\n "
    ],
    "files_changed": [
      {
        "filename": "include/primesieve/PreSieve.hpp",
        "status": "modified",
        "additions": 26,
        "deletions": 28,
        "changes": 54,
        "patch": "@@ -1,7 +1,22 @@\n ///\n-/// @file  PreSieve.hpp\n+/// @file   PreSieve.hpp\n+/// @brief  Pre-sieve multiples of small primes <= 59 to speed up the\n+///         sieve of Eratosthenes. The idea is to allocate several\n+///         arrays (buffers_) and remove the multiples of small primes\n+///         from them at initialization. Each buffer is assigned\n+///         different primes, for example:\n ///\n-/// Copyright (C) 2020 Kim Walisch, <kim.walisch@gmail.com>\n+///         Buffer 0 removes multiplies of:  7, 19, 23, 29\n+///         Buffer 1 removes multiplies of: 11, 13, 17, 37\n+///         Buffer 2 removes multiplies of: 31, 47, 59\n+///         Buffer 3 removes multiplies of: 41, 43, 53\n+///\n+///         Then whilst sieving, we perform a bitwise AND on the\n+///         buffers_ arrays and store the result in the sieve array.\n+///         Pre-sieving provides a speedup of up to 30% when\n+///         sieving the primes < 10^10 using primesieve.\n+///\n+/// Copyright (C) 2022 Kim Walisch, <kim.walisch@gmail.com>\n ///\n /// This file is distributed under the BSD License. See the COPYING\n /// file in the top level directory.\n@@ -11,41 +26,24 @@\n #define PRESIEVE_HPP\n \n #include <stdint.h>\n+#include <array>\n #include <vector>\n \n namespace primesieve {\n \n-/// PreSieve objects are used to pre-sieve multiples of small primes\n-/// e.g. <= 19 to speed up the sieve of Eratosthenes. The idea is to\n-/// allocate an array (buffer_) and remove the multiples of small\n-/// primes from it at initialization. Then whilst sieving, the\n-/// buffer_ array is copied to the sieve array at the beginning of\n-/// each new segment to pre-sieve the multiples of small\n-/// primes <= maxPrime_. Pre-sieving speeds up my sieve of Eratosthenes\n-/// implementation by about 20 percent when sieving < 10^10.\n-///\n-/// <b> Memory Usage </b>\n-///\n-/// - PreSieve objects use: primeProduct(maxPrime_) / 30 bytes of memory\n-/// - PreSieve multiples of primes <=  7 uses    7    bytes\n-/// - PreSieve multiples of primes <= 11 uses   77    bytes\n-/// - PreSieve multiples of primes <= 13 uses 1001    bytes\n-/// - PreSieve multiples of primes <= 17 uses   17.02 kilobytes\n-/// - PreSieve multiples of primes <= 19 uses  323.32 kilobytes\n-/// - PreSieve multiples of primes <= 23 uses    7.44 megabytes\n-///\n class PreSieve\n {\n public:\n-  void init(uint64_t, uint64_t);\n+  void init(uint64_t start, uint64_t stop);\n+  void preSieve(uint8_t* sieve, uint64_t sieveSize, uint64_t segmentLow) const;\n   uint64_t getMaxPrime() const { return maxPrime_; }\n-  void copy(uint8_t*, uint64_t, uint64_t) const;\n private:\n-  uint64_t maxPrime_ = 0;\n-  uint64_t primeProduct_ = 0;\n-  uint64_t size_ = 0;\n-  std::vector<uint8_t> buffer_;\n-  void initBuffer(uint64_t, uint64_t);\n+  uint64_t buffersDist_ = 0;\n+  uint64_t maxPrime_ = 13;\n+  std::array<std::vector<uint8_t>, 4> buffers_;\n+  void initBuffers();\n+  static void preSieveSmall(uint8_t* sieve, uint64_t sieveSize, uint64_t segmentLow);\n+  void preSieveLarge(uint8_t* sieve, uint64_t sieveSize, uint64_t segmentLow) const;\n };\n \n } // namespace"
      },
      {
        "filename": "src/Erat.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 4,
        "changes": 6,
        "patch": "@@ -151,18 +151,16 @@ uint64_t Erat::byteRemainder(uint64_t n)\n   return n;\n }\n \n-/// Pre-sieve multiples of small primes e.g. <= 19\n+/// Pre-sieve multiples of small primes e.g. <= 59\n /// to speed up the sieve of Eratosthenes\n ///\n void Erat::preSieve()\n {\n-  preSieve_->copy(sieve_, sieveSize_, segmentLow_);\n+  preSieve_->preSieve(sieve_, sieveSize_, segmentLow_);\n \n   // unset bits < start\n   if (segmentLow_ <= start_)\n   {\n-    if (start_ <= maxPreSieve_)\n-      sieve_[0] = 0xff;\n     uint64_t rem = byteRemainder(start_);\n     sieve_[0] &= unsetSmaller[rem];\n   }"
      },
      {
        "filename": "src/PreSieve.cpp",
        "status": "modified",
        "additions": 256,
        "deletions": 62,
        "changes": 318,
        "patch": "@@ -1,28 +1,22 @@\n ///\n /// @file   PreSieve.cpp\n-/// @brief  Pre-sieve multiples of small primes to speed up the sieve\n-///         of Eratosthenes. At startup primesieve initializes a small\n-///         buffer of size p1*p2*p3*pn and removes the multiples of\n-///         the first n primes from that buffer. Then while sieving at\n-///         the start of each new segment this buffer is simply copied\n-///         to the sieve array and now we can start sieving at p(n+1)\n-///         instead of p1. By default primesieve pre-sieves multiples\n-///         of primes <= 19, in practice pre-sieving using even larger\n-///         primes uses too much memory and slows things down. In\n-///         primesieve pre-sieving provides a minor speed of up to 20%\n-///         when the sieving distance is relatively small\n-///         e.g. < 10^10.\n+/// @brief  Pre-sieve multiples of small primes <= 59 to speed up the\n+///         sieve of Eratosthenes. The idea is to allocate several\n+///         arrays (buffers_) and remove the multiples of small primes\n+///         from them at initialization. Each buffer is assigned\n+///         different primes, for example:\n ///\n-///         The pre-sieve buffer can be both smaller or larger than\n-///         the actual sieve array so a little care needs to be taken\n-///         when copying the buffer to the sieve array. When the\n-///         buffer is smaller than the sieve array we need to\n-///         repeatedly copy the buffer to the sieve array until the\n-///         sieve array has been filled completely. When the buffer is\n-///         larger than the sieve array we only need to partially copy\n-///         it to the sieve array.\n+///         Buffer 0 removes multiplies of:  7, 19, 23, 29\n+///         Buffer 1 removes multiplies of: 11, 13, 17, 37\n+///         Buffer 2 removes multiplies of: 31, 47, 59\n+///         Buffer 3 removes multiplies of: 41, 43, 53\n ///\n-/// Copyright (C) 2020 Kim Walisch, <kim.walisch@gmail.com>\n+///         Then whilst sieving, we perform a bitwise AND on the\n+///         buffers_ arrays and store the result in the sieve array.\n+///         Pre-sieving provides a speedup of up to 30% when\n+///         sieving the primes < 10^10 using primesieve.\n+///\n+/// Copyright (C) 2022 Kim Walisch, <kim.walisch@gmail.com>\n ///\n /// This file is distributed under the BSD License. See the COPYING\n /// file in the top level directory.\n@@ -35,18 +29,140 @@\n #include <stdint.h>\n #include <algorithm>\n #include <array>\n-#include <iterator>\n+#include <cassert>\n #include <vector>\n \n-using namespace std;\n+using std::copy_n;\n+using std::size_t;\n \n namespace {\n \n-// Small primes >= 7\n-const array<uint64_t, 5> primes = { 7, 11, 13, 17, 19 };\n+/// Pre-sieve with the primes <= 13\n+const std::array<uint8_t, 7*11*13> buffer_7_11_13 =\n+{\n+  0xf8, 0xef, 0x77, 0x3f, 0xdb, 0xed, 0x9e, 0xfc, 0xea, 0x37,\n+  0xaf, 0xf9, 0xf5, 0xd3, 0x7e, 0x4f, 0x77, 0x9e, 0xeb, 0xf9,\n+  0xdd, 0xee, 0xad, 0x77, 0xb7, 0x73, 0xd9, 0xdf, 0x3e, 0xef,\n+  0x53, 0xaf, 0xeb, 0xfd, 0xde, 0xb6, 0x6f, 0x57, 0xb7, 0xba,\n+  0xfd, 0x5b, 0xfe, 0xcf, 0x65, 0xbf, 0xf1, 0x7c, 0x9f, 0xfe,\n+  0xae, 0x77, 0xbb, 0xfb, 0x6d, 0xdd, 0xde, 0xe7, 0x77, 0x9d,\n+  0xfa, 0xbc, 0xdf, 0xfa, 0xe7, 0x63, 0xbd, 0x7b, 0xf5, 0x5f,\n+  0xce, 0xef, 0x34, 0xbe, 0xbb, 0xfd, 0xcf, 0xf4, 0xeb, 0x77,\n+  0x3f, 0xdb, 0xdd, 0x8e, 0xfe, 0xe9, 0x76, 0xaf, 0xf9, 0xfd,\n+  0xd7, 0x7a, 0xcf, 0x77, 0xbe, 0xdb, 0xe9, 0xdf, 0xec, 0xec,\n+  0x37, 0xb7, 0x7b, 0xd5, 0xdb, 0xbe, 0x6f, 0x73, 0x9f, 0xeb,\n+  0xfd, 0xdd, 0xf6, 0x2f, 0x57, 0xbf, 0xb2, 0xf9, 0xdb, 0x7e,\n+  0xef, 0x55, 0xaf, 0xf3, 0x7d, 0xde, 0xbe, 0xae, 0x77, 0xb3,\n+  0xfb, 0xed, 0x5d, 0xfe, 0xc7, 0x67, 0x9f, 0xf9, 0xbc, 0x9f,\n+  0xfa, 0xef, 0x67, 0xb9, 0xfb, 0x75, 0x5f, 0xde, 0xef, 0x36,\n+  0xbd, 0xfa, 0xbd, 0xcf, 0xfc, 0xe7, 0x73, 0x3f, 0x5b, 0xfd,\n+  0x9e, 0xee, 0xeb, 0x75, 0xae, 0xb9, 0xfd, 0xd7, 0x76, 0xcb,\n+  0x77, 0x3e, 0xfb, 0xd9, 0xcf, 0xee, 0xed, 0x76, 0xb7, 0x7b,\n+  0xdd, 0xd7, 0xba, 0xef, 0x73, 0xbf, 0xcb, 0xed, 0xdf, 0xf4,\n+  0x6e, 0x17, 0xbf, 0xba, 0xf5, 0xdb, 0xfe, 0x6f, 0x75, 0x9f,\n+  0xe3, 0x7d, 0xdd, 0xfe, 0xae, 0x77, 0xbb, 0xf3, 0xe9, 0xdd,\n+  0x7e, 0xe7, 0x57, 0x8f, 0xfb, 0xbc, 0xde, 0xba, 0xef, 0x67,\n+  0xb5, 0xfb, 0xf5, 0x5f, 0xde, 0xcf, 0x26, 0xbf, 0xf9, 0xfc,\n+  0x8f, 0xfc, 0xef, 0x77, 0x3b, 0xdb, 0x7d, 0x9e, 0xde, 0xeb,\n+  0x77, 0xad, 0xf8, 0xbd, 0xd7, 0x7e, 0xc7, 0x73, 0xbe, 0x7b,\n+  0xf9, 0xdf, 0xee, 0xed, 0x75, 0xb6, 0x3b, 0xdd, 0xdf, 0xb6,\n+  0xeb, 0x73, 0x3f, 0xeb, 0xdd, 0xcf, 0xf6, 0x6d, 0x56, 0xbf,\n+  0xba, 0xfd, 0xd3, 0xfa, 0xef, 0x75, 0xbf, 0xd3, 0x6d, 0xdf,\n+  0xfc, 0xae, 0x37, 0xbb, 0xfb, 0xe5, 0xd9, 0xfe, 0x67, 0x77,\n+  0x9f, 0xeb, 0xbc, 0xdd, 0xfa, 0xaf, 0x67, 0xbd, 0xf3, 0xf1,\n+  0x5f, 0x5e, 0xef, 0x16, 0xaf, 0xfb, 0xfd, 0xce, 0xbc, 0xef,\n+  0x77, 0x37, 0xdb, 0xfd, 0x1e, 0xfe, 0xcb, 0x67, 0xaf, 0xf9,\n+  0xfc, 0x97, 0x7e, 0xcf, 0x77, 0xba, 0xfb, 0x79, 0xdf, 0xce,\n+  0xed, 0x77, 0xb5, 0x7a, 0x9d, 0xdf, 0xbe, 0xe7, 0x73, 0xbf,\n+  0x6b, 0xfd, 0xdf, 0xe6, 0x6f, 0x55, 0xbe, 0xba, 0xfd, 0xdb,\n+  0xf6, 0xeb, 0x75, 0x3f, 0xf3, 0x5d, 0xcf, 0xfe, 0xac, 0x76,\n+  0xbb, 0xfb, 0xed, 0xd5, 0xfa, 0xe7, 0x77, 0x9f, 0xdb, 0xac,\n+  0xdf, 0xf8, 0xee, 0x27, 0xbd, 0xfb, 0xf5, 0x5b, 0xde, 0x6f,\n+  0x36, 0x9f, 0xeb, 0xfd, 0xcd, 0xfc, 0xaf, 0x77, 0x3f, 0xd3,\n+  0xf9, 0x9e, 0x7e, 0xeb, 0x57, 0xaf, 0xf9, 0xfd, 0xd6, 0x3e,\n+  0xcf, 0x77, 0xb6, 0xfb, 0xf9, 0x5f, 0xee, 0xcd, 0x67, 0xb7,\n+  0x79, 0xdc, 0x9f, 0xbe, 0xef, 0x73, 0xbb, 0xeb, 0x7d, 0xdf,\n+  0xd6, 0x6f, 0x57, 0xbd, 0xba, 0xbd, 0xdb, 0xfe, 0xe7, 0x71,\n+  0xbf, 0x73, 0x7d, 0xdf, 0xee, 0xae, 0x75, 0xba, 0xbb, 0xed,\n+  0xdd, 0xf6, 0xe3, 0x77, 0x1f, 0xfb, 0x9c, 0xcf, 0xfa, 0xed,\n+  0x66, 0xbd, 0xfb, 0xf5, 0x57, 0xda, 0xef, 0x36, 0xbf, 0xdb,\n+  0xed, 0xcf, 0xfc, 0xee, 0x37, 0x3f, 0xdb, 0xf5, 0x9a, 0xfe,\n+  0x6b, 0x77, 0x8f, 0xe9, 0xfd, 0xd5, 0x7e, 0x8f, 0x77, 0xbe,\n+  0xf3, 0xf9, 0xdf, 0x6e, 0xed, 0x57, 0xa7, 0x7b, 0xdd, 0xde,\n+  0xbe, 0xef, 0x73, 0xb7, 0xeb, 0xfd, 0x5f, 0xf6, 0x4f, 0x47,\n+  0xbf, 0xb8, 0xfc, 0x9b, 0xfe, 0xef, 0x75, 0xbb, 0xf3, 0x7d,\n+  0xdf, 0xde, 0xae, 0x77, 0xb9, 0xfa, 0xad, 0xdd, 0xfe, 0xe7,\n+  0x73, 0x9f, 0x7b, 0xbc, 0xdf, 0xea, 0xef, 0x65, 0xbc, 0xbb,\n+  0xf5, 0x5f, 0xd6, 0xeb, 0x36, 0x3f, 0xfb, 0xdd, 0xcf, 0xfc,\n+  0xed, 0x76, 0x3f, 0xdb, 0xfd, 0x96, 0xfa, 0xeb, 0x77, 0xaf,\n+  0xd9, 0xed, 0xd7, 0x7c, 0xce, 0x37, 0xbe, 0xfb, 0xf1, 0xdb,\n+  0xee, 0x6d, 0x77, 0x97, 0x6b, 0xdd, 0xdd, 0xbe, 0xaf, 0x73,\n+  0xbf, 0xe3, 0xf9, 0xdf, 0x76, 0x6f, 0x57, 0xaf, 0xba, 0xfd,\n+  0xda, 0xbe, 0xef, 0x75, 0xb7, 0xf3, 0x7d, 0x5f, 0xfe, 0x8e,\n+  0x67, 0xbb, 0xf9, 0xec, 0x9d, 0xfe, 0xe7, 0x77, 0x9b, 0xfb,\n+  0x3c, 0xdf, 0xda, 0xef, 0x67, 0xbd, 0xfa, 0xb5, 0x5f, 0xde,\n+  0xe7, 0x32, 0xbf, 0x7b, 0xfd, 0xcf, 0xec, 0xef, 0x75, 0x3e,\n+  0x9b, 0xfd, 0x9e, 0xf6, 0xeb, 0x77, 0x2f, 0xf9, 0xdd, 0xc7,\n+  0x7e, 0xcd, 0x76, 0xbe, 0xfb, 0xf9, 0xd7, 0xea, 0xed, 0x77,\n+  0xb7, 0x5b, 0xcd, 0xdf, 0xbc, 0xee, 0x33, 0xbf, 0xeb, 0xf5,\n+  0xdb, 0xf6, 0x6f, 0x57, 0x9f, 0xaa, 0xfd, 0xd9, 0xfe, 0xaf,\n+  0x75, 0xbf, 0xf3, 0x79, 0xdf, 0x7e, 0xae, 0x57, 0xab, 0xfb,\n+  0xed, 0xdc, 0xbe, 0xe7, 0x77, 0x97, 0xfb, 0xbc, 0x5f, 0xfa,\n+  0xcf, 0x67, 0xbd, 0xf9, 0xf4, 0x1f, 0xde, 0xef, 0x36, 0xbb,\n+  0xfb, 0x7d, 0xcf, 0xdc, 0xef, 0x77, 0x3d, 0xda, 0xbd, 0x9e,\n+  0xfe, 0xe3, 0x73, 0xaf, 0x79, 0xfd, 0xd7, 0x6e, 0xcf, 0x75,\n+  0xbe, 0xbb, 0xf9, 0xdf, 0xe6, 0xe9, 0x77, 0x37, 0x7b, 0xdd,\n+  0xcf, 0xbe, 0xed, 0x72, 0xbf, 0xeb, 0xfd, 0xd7, 0xf2, 0x6f,\n+  0x57, 0xbf, 0x9a, 0xed, 0xdb, 0xfc, 0xee, 0x35, 0xbf, 0xf3,\n+  0x75, 0xdb, 0xfe, 0x2e, 0x77, 0x9b, 0xeb, 0xed, 0xdd, 0xfe,\n+  0xa7, 0x77, 0x9f, 0xf3, 0xb8, 0xdf, 0x7a, 0xef, 0x47, 0xad,\n+  0xfb, 0xf5, 0x5e, 0x9e, 0xef, 0x36, 0xb7, 0xfb, 0xfd, 0x4f,\n+  0xfc, 0xcf, 0x67, 0x3f, 0xd9, 0xfc, 0x9e, 0xfe, 0xeb, 0x77,\n+  0xab, 0xf9, 0x7d, 0xd7, 0x5e, 0xcf, 0x77, 0xbc, 0xfa, 0xb9,\n+  0xdf, 0xee, 0xe5, 0x73, 0xb7, 0x7b, 0xdd, 0xdf, 0xae, 0xef,\n+  0x71, 0xbe, 0xab, 0xfd, 0xdf, 0xf6, 0x6b, 0x57, 0x3f, 0xba,\n+  0xdd, 0xcb, 0xfe, 0xed, 0x74, 0xbf, 0xf3, 0x7d, 0xd7, 0xfa,\n+  0xae, 0x77, 0xbb, 0xdb, 0xed, 0xdd, 0xfc, 0xe6, 0x37, 0x9f,\n+  0xfb, 0xb4, 0xdb, 0xfa, 0x6f, 0x67, 0x9d, 0xeb, 0xf5, 0x5d,\n+  0xde, 0xaf, 0x36, 0xbf, 0xf3, 0xf9, 0xcf, 0x7c, 0xef, 0x57,\n+  0x2f, 0xdb, 0xfd, 0x9e, 0xbe, 0xeb, 0x77, 0xa7, 0xf9, 0xfd,\n+  0x57, 0x7e, 0xcf, 0x67, 0xbe, 0xf9, 0xf8, 0x9f, 0xee, 0xed,\n+  0x77, 0xb3, 0x7b, 0x5d, 0xdf, 0x9e, 0xef, 0x73, 0xbd, 0xea,\n+  0xbd, 0xdf, 0xf6, 0x67, 0x53, 0xbf, 0x3a, 0xfd, 0xdb, 0xee,\n+  0xef, 0x75, 0xbe, 0xb3, 0x7d, 0xdf, 0xf6, 0xaa, 0x77, 0x3b,\n+  0xfb, 0xcd, 0xcd, 0xfe, 0xe5, 0x76, 0x9f, 0xfb, 0xbc, 0xd7,\n+  0xfa, 0xef, 0x67, 0xbd, 0xdb, 0xe5, 0x5f, 0xdc, 0xee, 0x36,\n+  0xbf, 0xfb, 0xf5, 0xcb, 0xfc, 0x6f, 0x77, 0x1f, 0xcb, 0xfd,\n+  0x9c, 0xfe, 0xab, 0x77, 0xaf, 0xf1, 0xf9, 0xd7, 0x7e, 0xcf,\n+  0x57, 0xae, 0xfb, 0xf9, 0xde, 0xae, 0xed, 0x77, 0xb7, 0x7b,\n+  0xdd, 0x5f, 0xbe, 0xcf, 0x63, 0xbf, 0xe9, 0xfc, 0x9f, 0xf6,\n+  0x6f, 0x57, 0xbb, 0xba, 0x7d, 0xdb, 0xde, 0xef, 0x75, 0xbd,\n+  0xf2, 0x3d, 0xdf, 0xfe, 0xa6, 0x73, 0xbb, 0x7b, 0xed, 0xdd,\n+  0xee, 0xe7, 0x75, 0x9e, 0xbb, 0xbc, 0xdf, 0xf2, 0xeb, 0x67,\n+  0x3d, 0xfb, 0xd5, 0x4f, 0xde, 0xed, 0x36, 0xbf, 0xfb, 0xfd,\n+  0xc7\n+};\n+\n+/// Pre-sieve with the primes <= 59\n+const std::array<std::vector<uint64_t>, 4> bufferPrimes =\n+{{\n+  {  7, 19, 23, 29 }, // 89 KiB\n+  { 11, 13, 17, 37 }, // 90 KiB\n+  { 31, 47, 59 },     // 86 KiB\n+  { 41, 43, 53 }      // 93 KiB\n+}};\n \n-// Prime products of primes >= 7\n-const array<uint64_t, 5> primeProducts = { 210, 2310, 30030, 510510, 9699690 };\n+void andBuffers(const uint8_t* buf1,\n+                const uint8_t* buf2,\n+                const uint8_t* buf3,\n+                const uint8_t* buf4,\n+                uint8_t* output,\n+                size_t bytes)\n+{\n+  // This loop should be auto-vectorized\n+  for (size_t i = 0; i < bytes; i++)\n+    output[i] = buf1[i] & buf2[i] & buf3[i] & buf4[i];\n+}\n \n } // namespace\n \n@@ -55,54 +171,96 @@ namespace primesieve {\n void PreSieve::init(uint64_t start,\n                     uint64_t stop)\n {\n-  // The pre-sieve buffer should be at least 100\n+  // Already initialized\n+  if (!buffers_[0].empty())\n+    return;\n+\n+  // The pre-sieve buffers should be at least 30\n   // times smaller than the sieving distance\n   // in order to reduce initialization overhead.\n   uint64_t dist = stop - start;\n-  uint64_t threshold = max(dist, isqrt(stop)) / 100;\n-  auto last =  primeProducts.end() - 1;\n-  auto iter = lower_bound(primeProducts.begin(), last, threshold);\n-  auto i = distance(primeProducts.begin(), iter);\n+  uint64_t threshold = std::max(dist, isqrt(stop)) / 30;\n \n-  if (primes.at(i) > maxPrime_)\n-    initBuffer(primes[i], primeProducts[i]);\n+  if (!buffersDist_)\n+  {\n+    for (const auto& primes : bufferPrimes)\n+    {\n+      uint64_t bufferBytes = 1;\n+      for (auto prime : primes)\n+        bufferBytes *= prime;\n+      buffersDist_ += bufferBytes * 30;\n+    }\n+  }\n+\n+  // For small intervals we pre-sieve using the\n+  // static buffer_7_11_13 lookup table. In this\n+  // case no initialization is required.\n+  if (threshold < buffersDist_)\n+    return;\n+\n+  initBuffers();\n }\n \n-/// Initialize the buffer by removing the\n-/// multiples of primes <= maxPrime.\n+/// We are sieving a large interval, we have to\n+/// initialize all pre-sieve buffers.\n ///\n-void PreSieve::initBuffer(uint64_t maxPrime,\n-                          uint64_t primeProduct)\n+void PreSieve::initBuffers()\n {\n-  maxPrime_ = maxPrime;\n-  primeProduct_ = primeProduct;\n-  size_ = primeProduct_ / 30;\n+  for (size_t i = 0; i < buffers_.size(); i++)\n+  {\n+    uint64_t product = 30;\n+\n+    for (auto prime : bufferPrimes[i])\n+      product *= prime;\n \n-  buffer_.clear();\n-  buffer_.resize(size_, 0xff);\n+    uint64_t start = product;\n+    uint64_t stop = start + product;\n+    buffers_[i].resize(product / 30, 0xff);\n+    uint64_t maxPrime = bufferPrimes[i].back();\n+    assert(start >= maxPrime * maxPrime);\n+    maxPrime_ = std::max(maxPrime_, maxPrime);\n \n-  EratSmall eratSmall;\n-  uint64_t stop = primeProduct_ * 2;\n-  eratSmall.init(stop, size_, maxPrime_);\n+    EratSmall eratSmall;\n+    eratSmall.init(stop, buffers_[i].size(), maxPrime);\n \n-  for (uint64_t prime : primes)\n-    if (prime <= maxPrime_)\n-      eratSmall.addSievingPrime(prime, primeProduct_);\n+    for (uint64_t prime : bufferPrimes[i])\n+      eratSmall.addSievingPrime(prime, start);\n \n-  auto buffer = buffer_.data();\n-  eratSmall.crossOff(buffer, size_);\n+    eratSmall.crossOff(buffers_[i].data(), buffers_[i].size());\n+  }\n }\n \n-/// Copy pre-sieved buffer to sieve array\n-void PreSieve::copy(uint8_t* sieve,\n-                    uint64_t sieveSize,\n-                    uint64_t segmentLow) const\n+void PreSieve::preSieve(uint8_t* sieve,\n+                        uint64_t sieveSize,\n+                        uint64_t segmentLow) const\n {\n-  // Find segmentLow index\n-  uint64_t remainder = segmentLow % primeProduct_;\n-  uint64_t i = remainder / 30;\n-  uint64_t sizeLeft = size_ - i;\n-  auto buffer = buffer_.data();\n+  if (buffers_[0].empty())\n+    preSieveSmall(sieve, sieveSize, segmentLow);\n+  else\n+    preSieveLarge(sieve, sieveSize, segmentLow);\n+\n+  // Pre-sieving removes the primes <= 59. We\n+  // have to undo that work and reset these bits\n+  // to 1 (but 49 = 7 * 7 is not a prime).\n+  uint8_t bit49 = 1 << 4;\n+  size_t i = 0;\n+\n+  if (segmentLow < 30)\n+    sieve[i++] = 0xff;\n+  if (segmentLow < 60)\n+    sieve[i++] = 0xff ^ bit49;\n+}\n+\n+/// Pre-sieve with the primes <= 13\n+void PreSieve::preSieveSmall(uint8_t* sieve,\n+                             uint64_t sieveSize,\n+                             uint64_t segmentLow)\n+{\n+  uint64_t size = buffer_7_11_13.size();\n+  uint64_t primeProduct = size * 30;\n+  uint64_t i = (segmentLow % primeProduct) / 30;\n+  uint64_t sizeLeft = size - i;\n+  auto buffer = buffer_7_11_13.data();\n \n   if (sieveSize <= sizeLeft)\n     copy_n(&buffer[i], sieveSize, sieve);\n@@ -113,12 +271,48 @@ void PreSieve::copy(uint8_t* sieve,\n     copy_n(&buffer[i], sizeLeft, sieve);\n \n     // Restart copying at the beginning of buffer\n-    for (i = sizeLeft; i + size_ < sieveSize; i += size_)\n-      copy_n(buffer, size_, &sieve[i]);\n+    for (i = sizeLeft; i + size < sieveSize; i += size)\n+      copy_n(buffer, size, &sieve[i]);\n \n     // Copy the last remaining bytes\n     copy_n(buffer, sieveSize - i, &sieve[i]);\n   }\n }\n \n+/// Pre-sieve with the primes <= 59\n+void PreSieve::preSieveLarge(uint8_t* sieve,\n+                             uint64_t sieveSize,\n+                             uint64_t segmentLow) const\n+{\n+  uint64_t offset = 0;\n+  std::array<uint64_t, bufferPrimes.size()> pos;\n+\n+  for (size_t i = 0; i < buffers_.size(); i++)\n+    pos[i] = (segmentLow % (buffers_[i].size() * 30)) / 30;\n+\n+  while (offset < sieveSize) {\n+    uint64_t bytesToCopy = sieveSize - offset;\n+\n+    for (size_t i = 0; i < buffers_.size(); i++) {\n+      uint64_t left = buffers_[i].size() - pos[i];\n+      bytesToCopy = std::min(left, bytesToCopy);\n+    }\n+\n+    andBuffers(&buffers_[0][pos[0]],\n+               &buffers_[1][pos[1]],\n+               &buffers_[2][pos[2]],\n+               &buffers_[3][pos[3]],\n+               &sieve[offset],\n+               bytesToCopy);\n+\n+    offset += bytesToCopy;\n+\n+    for (size_t i = 0; i < buffers_.size(); i++) {\n+      pos[i] += bytesToCopy;\n+      if (pos[i] >= buffers_[i].size())\n+        pos[i] = 0;\n+    }\n+  }\n+}\n+\n } // namespace"
      },
      {
        "filename": "src/SievingPrimes.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "patch": "@@ -2,7 +2,7 @@\n /// @file  SievingPrimes.cpp\n ///        Generates the sieving primes up n^(1/2).\n ///\n-/// Copyright (C) 2019 Kim Walisch, <kim.walisch@gmail.com>\n+/// Copyright (C) 2022 Kim Walisch, <kim.walisch@gmail.com>\n ///\n /// This file is distributed under the BSD License. See the COPYING\n /// file in the top level directory.\n@@ -32,6 +32,7 @@ void SievingPrimes::init(Erat* erat, PreSieve& preSieve)\n              erat->getSieveSize(),\n              preSieve);\n \n+  low_ = segmentLow_;\n   tinySieve();\n }\n "
      }
    ],
    "lines_added": 286,
    "lines_removed": 95
  },
  "issues": [],
  "pull_requests": [],
  "build_info": {
    "old_build_script": [
      "apt-get update",
      "cmake -S /test_workspace/workspace/old -B /test_workspace/workspace/old/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DBUILD_TESTS=ON",
      "cmake --build /test_workspace/workspace/old/build -- -j 1"
    ],
    "new_build_script": [
      "apt-get update",
      "cmake -S /test_workspace/workspace/new -B /test_workspace/workspace/new/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DBUILD_TESTS=ON",
      "cmake --build /test_workspace/workspace/new/build -- -j 1"
    ],
    "old_test_script": [
      "cd /test_workspace/workspace/old/build",
      "ctest --output-on-failure"
    ],
    "new_test_script": [
      "cd /test_workspace/workspace/new/build",
      "ctest --output-on-failure"
    ],
    "build_system": "cmake"
  },
  "performance_analysis": {
    "is_significant": false,
    "p_value": 1.0,
    "is_pair_significant": false,
    "pair_p_value": 1.0,
    "is_binom_significant": false,
    "binom_p_value": 1.0,
    "is_wilcoxon_significant": false,
    "wilcoxon_p_value": 0.9999991338918834,
    "is_mannwhitney_significant": false,
    "mannwhitney_p_value": 0.07467629131807989,
    "relative_improvement": 0.002585646308357554,
    "absolute_improvement_ms": 167.0000000000016,
    "old_mean_ms": 64587.333333333336,
    "new_mean_ms": 64420.33333333333,
    "old_std_ms": 511.00936851748935,
    "new_std_ms": 228.4653951512321,
    "effect_size_cohens_d": 0.4219223688459921,
    "old_ci95_ms": [
      64396.51929918803,
      64778.14736747864
    ],
    "new_ci95_ms": [
      64335.02295274699,
      64505.643713919664
    ],
    "old_ci99_ms": [
      64330.17046853534,
      64844.496198131324
    ],
    "new_ci99_ms": [
      64305.35928560747,
      64535.307381059196
    ],
    "new_times_s": [
      64.69,
      64.64,
      64.48,
      64.2,
      64.23,
      64.66,
      64.57,
      64.4,
      63.89,
      64.18,
      64.43,
      64.3,
      64.63,
      64.56,
      64.57,
      64.55,
      64.45,
      64.29,
      64.69,
      64.16,
      64.51,
      64.41,
      64.48,
      64.91,
      64.79,
      64.15,
      64.29,
      64.11,
      64.58,
      64.36,
      64.14
    ],
    "old_times_s": [
      64.15,
      64.2,
      64.04,
      64.3,
      63.68,
      64.32,
      64.77,
      64.33,
      64.41,
      64.95,
      64.66,
      64.76,
      65.27,
      63.76,
      64.56,
      65.46,
      64.3,
      64.42,
      65.22,
      63.71,
      64.32,
      65.05,
      64.78,
      63.89,
      65.23,
      65.02,
      64.63,
      64.62,
      65.47,
      64.29,
      65.2
    ]
  },
  "tests": {
    "total_tests": 23,
    "significant_improvements": 2,
    "significant_improvements_tests": [
      "nth_prime1",
      "prev_prime2"
    ],
    "significant_regressions": 0,
    "significant_regressions_tests": [],
    "significant_pair_improvements": 2,
    "significant_pair_improvements_tests": [
      "nth_prime1",
      "prev_prime2"
    ],
    "significant_pair_regressions": 0,
    "significant_pair_regressions_tests": [],
    "significant_binom_improvements": 2,
    "significant_binom_improvements_tests": [
      "nth_prime1",
      "prev_prime2"
    ],
    "significant_binom_regressions": 0,
    "significant_binom_regressions_tests": [],
    "significant_wilcoxon_improvements": 2,
    "significant_wilcoxon_improvements_tests": [
      "nth_prime1",
      "prev_prime2"
    ],
    "significant_wilcoxon_regressions": 0,
    "significant_wilcoxon_regressions_tests": [],
    "significant_mannwhitney_improvements": 5,
    "significant_mannwhitney_improvements_tests": [
      "generate_primes2",
      "next_prime1",
      "nth_prime1",
      "nth_prime3",
      "prev_prime2"
    ],
    "significant_mannwhitney_regressions": 8,
    "significant_mannwhitney_regressions_tests": [
      "count_primes1",
      "count_primes2",
      "count_quadruplets",
      "count_quintuplets",
      "count_sextuplets",
      "count_triplets",
      "count_twins",
      "generate_n_primes1"
    ],
    "tests": [
      {
        "test_name": "count_primes1",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 0.9999999999999989,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999993416504204,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.9999966616381114,
        "relative_improvement": -0.024881516587677826,
        "absolute_improvement_ms": -7.241379310344853,
        "old_mean_ms": 291.03448275862064,
        "new_mean_ms": 298.2758620689655,
        "old_std_ms": 4.887906056356188,
        "new_std_ms": 6.0172166781431535,
        "effect_size_cohens_d": -1.3210048079613044,
        "old_ci95_ms": [
          289.1752227298469,
          292.8937427873944
        ],
        "new_ci95_ms": [
          295.98703525332036,
          300.56468888461063
        ],
        "old_ci99_ms": [
          288.52637617784234,
          293.542589339399
        ],
        "new_ci99_ms": [
          295.1882780249157,
          301.3634461130153
        ],
        "new_times": [
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.29,
          0.31,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.28,
          0.3,
          0.29,
          0.3,
          0.3,
          0.31,
          0.3,
          0.29,
          0.3,
          0.3,
          0.3,
          0.3,
          0.29,
          0.3,
          0.29,
          0.3,
          0.3
        ],
        "old_times": [
          0.29,
          0.29,
          0.29,
          0.29,
          0.29,
          0.29,
          0.28,
          0.29,
          0.3,
          0.28,
          0.29,
          0.29,
          0.29,
          0.29,
          0.29,
          0.29,
          0.29,
          0.3,
          0.29,
          0.29,
          0.29,
          0.3,
          0.29,
          0.29,
          0.29,
          0.3,
          0.29,
          0.29,
          0.3
        ]
      },
      {
        "test_name": "count_primes2",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999987356220623,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.999963405683149,
        "relative_improvement": -0.01653543307086629,
        "absolute_improvement_ms": -50.689655172413865,
        "old_mean_ms": 3065.5172413793107,
        "new_mean_ms": 3116.2068965517246,
        "old_std_ms": 39.513669144500966,
        "new_std_ms": 43.04597153073252,
        "effect_size_cohens_d": -1.2268300476150613,
        "old_ci95_ms": [
          3050.487045466477,
          3080.5474372921444
        ],
        "new_ci95_ms": [
          3099.8330846690783,
          3132.5807084343705
        ],
        "old_ci99_ms": [
          3045.241791632656,
          3085.7926911259656
        ],
        "new_ci99_ms": [
          3094.1189342980656,
          3138.2948588053832
        ],
        "new_times": [
          3.12,
          3.08,
          3.13,
          3.2,
          3.14,
          3.18,
          3.07,
          3.06,
          3.12,
          3.07,
          3.18,
          3.1,
          3.13,
          3.12,
          3.08,
          3.15,
          3.13,
          3.06,
          3.12,
          3.06,
          3.18,
          3.2,
          3.08,
          3.12,
          3.14,
          3.07,
          3.08,
          3.08,
          3.12
        ],
        "old_times": [
          3.03,
          3.03,
          3.07,
          3.12,
          3.06,
          3.13,
          3.01,
          3.07,
          3.09,
          3.09,
          3.05,
          3.03,
          3.06,
          3.04,
          3.06,
          3.06,
          3.02,
          3.12,
          3.05,
          3.03,
          3.07,
          3.01,
          3.14,
          3.01,
          3.09,
          3.08,
          3.15,
          3.09,
          3.04
        ]
      },
      {
        "test_name": "count_primes3",
        "is_significant": false,
        "p_value": 0.9999999999999969,
        "is_pair_significant": false,
        "pair_p_value": 0.9999999994490685,
        "is_binom_significant": false,
        "binom_p_value": 0.9999999441206455,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999978591177381,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.9173202230105404,
        "relative_improvement": -0.007095343680709383,
        "absolute_improvement_ms": -16.551724137931156,
        "old_mean_ms": 2332.758620689655,
        "new_mean_ms": 2349.310344827586,
        "old_std_ms": 48.61632234167413,
        "new_std_ms": 49.63661051530695,
        "effect_size_cohens_d": -0.3369025496073504,
        "old_ci95_ms": [
          2314.2659606766188,
          2351.251280702691
        ],
        "new_ci95_ms": [
          2330.429587949104,
          2368.191101706068
        ],
        "old_ci99_ms": [
          2307.812372420454,
          2357.704868958856
        ],
        "new_ci99_ms": [
          2323.8405612340407,
          2374.7801284211314
        ],
        "new_times": [
          2.35,
          2.4,
          2.3,
          2.31,
          2.35,
          2.32,
          2.35,
          2.34,
          2.45,
          2.43,
          2.38,
          2.24,
          2.32,
          2.36,
          2.35,
          2.37,
          2.39,
          2.33,
          2.35,
          2.31,
          2.36,
          2.38,
          2.33,
          2.26,
          2.4,
          2.26,
          2.43,
          2.34,
          2.37
        ],
        "old_times": [
          2.37,
          2.34,
          2.28,
          2.28,
          2.31,
          2.34,
          2.38,
          2.41,
          2.29,
          2.32,
          2.25,
          2.41,
          2.31,
          2.38,
          2.32,
          2.31,
          2.35,
          2.29,
          2.43,
          2.37,
          2.37,
          2.28,
          2.36,
          2.41,
          2.28,
          2.31,
          2.3,
          2.27,
          2.33
        ]
      },
      {
        "test_name": "count_quadruplets",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 0.9999999999999997,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999988282520229,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.9780480205851634,
        "relative_improvement": -0.00839630562552474,
        "absolute_improvement_ms": -6.896551724137945,
        "old_mean_ms": 821.3793103448274,
        "new_mean_ms": 828.2758620689655,
        "old_std_ms": 11.251710324287327,
        "new_std_ms": 12.555296411486871,
        "effect_size_cohens_d": -0.578504988116202,
        "old_ci95_ms": [
          817.0993886319123,
          825.6592320577427
        ],
        "new_ci95_ms": [
          823.5000827274357,
          833.0516414104951
        ],
        "old_ci99_ms": [
          815.6057769781911,
          827.1528437114638
        ],
        "new_ci99_ms": [
          821.8334261485116,
          834.7182979894192
        ],
        "new_times": [
          0.82,
          0.83,
          0.83,
          0.84,
          0.84,
          0.81,
          0.84,
          0.84,
          0.82,
          0.83,
          0.82,
          0.83,
          0.82,
          0.84,
          0.81,
          0.84,
          0.82,
          0.84,
          0.81,
          0.83,
          0.81,
          0.82,
          0.84,
          0.86,
          0.83,
          0.81,
          0.83,
          0.82,
          0.84
        ],
        "old_times": [
          0.83,
          0.82,
          0.83,
          0.83,
          0.82,
          0.81,
          0.82,
          0.83,
          0.83,
          0.83,
          0.81,
          0.82,
          0.81,
          0.83,
          0.84,
          0.8,
          0.83,
          0.81,
          0.81,
          0.83,
          0.83,
          0.81,
          0.83,
          0.84,
          0.83,
          0.81,
          0.81,
          0.82,
          0.8
        ]
      },
      {
        "test_name": "count_quintuplets",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 0.9999999999999261,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999987876217822,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.9925694375692045,
        "relative_improvement": -0.011794439764111254,
        "absolute_improvement_ms": -9.65517241379299,
        "old_mean_ms": 818.6206896551723,
        "new_mean_ms": 828.2758620689654,
        "old_std_ms": 13.289130341059714,
        "new_std_ms": 13.381481211318377,
        "effect_size_cohens_d": -0.724026482333387,
        "old_ci95_ms": [
          813.5657748152755,
          823.6756044950691
        ],
        "new_ci95_ms": [
          823.1858188367231,
          833.3659053012075
        ],
        "old_ci99_ms": [
          811.8017052317933,
          825.4396740785513
        ],
        "new_ci99_ms": [
          821.4094901093355,
          835.1422340285951
        ],
        "new_times": [
          0.84,
          0.82,
          0.84,
          0.83,
          0.82,
          0.82,
          0.81,
          0.84,
          0.82,
          0.84,
          0.81,
          0.82,
          0.84,
          0.84,
          0.86,
          0.84,
          0.83,
          0.81,
          0.83,
          0.82,
          0.82,
          0.82,
          0.85,
          0.8,
          0.83,
          0.83,
          0.82,
          0.84,
          0.83
        ],
        "old_times": [
          0.8,
          0.83,
          0.8,
          0.83,
          0.82,
          0.83,
          0.81,
          0.81,
          0.83,
          0.81,
          0.83,
          0.8,
          0.84,
          0.83,
          0.82,
          0.81,
          0.83,
          0.84,
          0.81,
          0.83,
          0.81,
          0.81,
          0.83,
          0.82,
          0.83,
          0.8,
          0.83,
          0.8,
          0.8
        ]
      },
      {
        "test_name": "count_sextuplets",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 0.9999999999999973,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999987933794551,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.9944984284016233,
        "relative_improvement": -0.010924369747899076,
        "absolute_improvement_ms": -8.965517241379285,
        "old_mean_ms": 820.6896551724136,
        "new_mean_ms": 829.6551724137929,
        "old_std_ms": 10.667385033281363,
        "new_std_ms": 12.951215778751543,
        "effect_size_cohens_d": -0.7556666389799157,
        "old_ci95_ms": [
          816.631998913221,
          824.7473114316062
        ],
        "new_ci95_ms": [
          824.7287933991752,
          834.5815514284108
        ],
        "old_ci99_ms": [
          815.2159536950955,
          826.1633566497318
        ],
        "new_ci99_ms": [
          823.0095803853769,
          836.3007644422089
        ],
        "new_times": [
          0.84,
          0.82,
          0.81,
          0.81,
          0.82,
          0.82,
          0.84,
          0.83,
          0.81,
          0.82,
          0.83,
          0.83,
          0.82,
          0.84,
          0.83,
          0.85,
          0.81,
          0.84,
          0.84,
          0.85,
          0.82,
          0.82,
          0.85,
          0.82,
          0.83,
          0.84,
          0.83,
          0.84,
          0.85
        ],
        "old_times": [
          0.8,
          0.83,
          0.81,
          0.83,
          0.81,
          0.82,
          0.82,
          0.82,
          0.81,
          0.82,
          0.84,
          0.83,
          0.83,
          0.82,
          0.81,
          0.8,
          0.82,
          0.81,
          0.82,
          0.83,
          0.84,
          0.83,
          0.82,
          0.82,
          0.82,
          0.84,
          0.81,
          0.82,
          0.82
        ]
      },
      {
        "test_name": "count_triplets",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999988234369682,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.9998480180516087,
        "relative_improvement": -0.014780405405405315,
        "absolute_improvement_ms": -12.068965517241569,
        "old_mean_ms": 816.5517241379307,
        "new_mean_ms": 828.6206896551723,
        "old_std_ms": 12.327629267209199,
        "new_std_ms": 9.900987660342084,
        "effect_size_cohens_d": -1.0794810925861247,
        "old_ci95_ms": [
          811.8625447466334,
          821.2409035292281
        ],
        "new_ci95_ms": [
          824.8545553657627,
          832.3868239445819
        ],
        "old_ci99_ms": [
          810.2261099108987,
          822.8773383649628
        ],
        "new_ci99_ms": [
          823.5402457962285,
          833.7011335141161
        ],
        "new_times": [
          0.83,
          0.82,
          0.81,
          0.85,
          0.84,
          0.83,
          0.82,
          0.83,
          0.84,
          0.84,
          0.82,
          0.83,
          0.82,
          0.83,
          0.82,
          0.83,
          0.83,
          0.83,
          0.82,
          0.83,
          0.84,
          0.84,
          0.83,
          0.82,
          0.81,
          0.82,
          0.84,
          0.84,
          0.82
        ],
        "old_times": [
          0.8,
          0.83,
          0.81,
          0.81,
          0.83,
          0.82,
          0.82,
          0.81,
          0.83,
          0.81,
          0.83,
          0.81,
          0.82,
          0.81,
          0.82,
          0.8,
          0.82,
          0.8,
          0.81,
          0.81,
          0.84,
          0.84,
          0.82,
          0.81,
          0.83,
          0.79,
          0.81,
          0.81,
          0.83
        ]
      },
      {
        "test_name": "count_twins",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 0.9999999999999928,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.999998774375669,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.9821043600120567,
        "relative_improvement": -0.008812421317666843,
        "absolute_improvement_ms": -7.241379310344742,
        "old_mean_ms": 821.7241379310344,
        "new_mean_ms": 828.9655172413791,
        "old_std_ms": 11.041792529567337,
        "new_std_ms": 13.18679739799482,
        "effect_size_cohens_d": -0.5954260178683783,
        "old_ci95_ms": [
          817.5240646768563,
          825.9242111852126
        ],
        "new_ci95_ms": [
          823.9495277712568,
          833.9815067115014
        ],
        "old_ci99_ms": [
          816.0583186236064,
          827.3899572384623
        ],
        "new_ci99_ms": [
          822.1990424049219,
          835.7319920778364
        ],
        "new_times": [
          0.85,
          0.84,
          0.81,
          0.85,
          0.84,
          0.82,
          0.83,
          0.83,
          0.85,
          0.84,
          0.81,
          0.84,
          0.84,
          0.83,
          0.83,
          0.81,
          0.83,
          0.83,
          0.82,
          0.82,
          0.82,
          0.83,
          0.81,
          0.84,
          0.81,
          0.84,
          0.84,
          0.81,
          0.82
        ],
        "old_times": [
          0.83,
          0.81,
          0.82,
          0.83,
          0.83,
          0.81,
          0.82,
          0.83,
          0.83,
          0.83,
          0.82,
          0.81,
          0.81,
          0.83,
          0.83,
          0.83,
          0.82,
          0.83,
          0.81,
          0.83,
          0.84,
          0.8,
          0.84,
          0.81,
          0.81,
          0.82,
          0.8,
          0.82,
          0.83
        ]
      },
      {
        "test_name": "floorPow2",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999999638108507,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 1.0,
        "relative_improvement": 0.0,
        "absolute_improvement_ms": 0.0,
        "old_mean_ms": 50.000000000000014,
        "new_mean_ms": 50.000000000000014,
        "old_std_ms": 1.4123431441001795e-14,
        "new_std_ms": 1.4123431441001795e-14,
        "effect_size_cohens_d": 0.0,
        "old_ci95_ms": [
          50.00000000000001,
          50.00000000000002
        ],
        "new_ci95_ms": [
          50.00000000000001,
          50.00000000000002
        ],
        "old_ci99_ms": [
          50.00000000000001,
          50.00000000000002
        ],
        "new_ci99_ms": [
          50.00000000000001,
          50.00000000000002
        ],
        "new_times": [
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05
        ],
        "old_times": [
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05
        ]
      },
      {
        "test_name": "generate_n_primes1",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 0.9999999999958173,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999987193211256,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.9945248547290132,
        "relative_improvement": -0.014487400476073222,
        "absolute_improvement_ms": -121.7241379310341,
        "old_mean_ms": 8402.068965517241,
        "new_mean_ms": 8523.793103448275,
        "old_std_ms": 194.81455120089436,
        "new_std_ms": 123.47393574306184,
        "effect_size_cohens_d": -0.7463489417175658,
        "old_ci95_ms": [
          8327.96547336843,
          8476.172457666053
        ],
        "new_ci95_ms": [
          8476.826130131773,
          8570.760076764778
        ],
        "old_ci99_ms": [
          8302.104757477084,
          8502.033173557398
        ],
        "new_ci99_ms": [
          8460.435545585833,
          8587.150661310718
        ],
        "new_times": [
          8.51,
          8.43,
          8.46,
          8.51,
          8.75,
          8.45,
          8.38,
          8.51,
          8.4,
          8.44,
          8.4,
          8.82,
          8.53,
          8.59,
          8.64,
          8.28,
          8.67,
          8.4,
          8.55,
          8.6,
          8.6,
          8.62,
          8.69,
          8.4,
          8.49,
          8.65,
          8.46,
          8.54,
          8.42
        ],
        "old_times": [
          8.5,
          8.48,
          8.4,
          8.2,
          8.54,
          8.22,
          8.48,
          8.17,
          8.59,
          8.69,
          8.58,
          8.31,
          8.79,
          8.37,
          8.27,
          8.39,
          8.26,
          8.21,
          8.16,
          8.18,
          8.27,
          8.04,
          8.27,
          8.69,
          8.64,
          8.5,
          8.3,
          8.5,
          8.66
        ]
      },
      {
        "test_name": "generate_n_primes2",
        "is_significant": false,
        "p_value": 0.9999999957316027,
        "is_pair_significant": false,
        "pair_p_value": 0.9999999749810651,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999990873905196,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.4229699465498251,
        "relative_improvement": 0.0015673981191222236,
        "absolute_improvement_ms": 0.3448275862069361,
        "old_mean_ms": 220.0,
        "new_mean_ms": 219.65517241379305,
        "old_std_ms": 7.559289460184552,
        "new_std_ms": 1.8569533817705202,
        "effect_size_cohens_d": 0.06264875764830567,
        "old_ci95_ms": [
          217.12460006857637,
          222.87539993142363
        ],
        "new_ci95_ms": [
          218.94882512351884,
          220.3615197040673
        ],
        "old_ci99_ms": [
          216.12113992730235,
          223.87886007269765
        ],
        "new_ci99_ms": [
          218.70232329122027,
          220.60802153636587
        ],
        "new_times": [
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.22,
          0.21,
          0.22
        ],
        "old_times": [
          0.22,
          0.23,
          0.21,
          0.22,
          0.22,
          0.23,
          0.21,
          0.22,
          0.22,
          0.23,
          0.21,
          0.23,
          0.22,
          0.22,
          0.21,
          0.22,
          0.23,
          0.23,
          0.22,
          0.21,
          0.23,
          0.22,
          0.22,
          0.21,
          0.21,
          0.23,
          0.22,
          0.22,
          0.21
        ]
      },
      {
        "test_name": "generate_primes1",
        "is_significant": false,
        "p_value": 0.9894880212207191,
        "is_pair_significant": false,
        "pair_p_value": 0.991799877898981,
        "is_binom_significant": false,
        "binom_p_value": 0.9988421499729156,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9413019280540794,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.30432357340130256,
        "relative_improvement": 0.009132420091324209,
        "absolute_improvement_ms": 0.6896551724137889,
        "old_mean_ms": 75.51724137931036,
        "new_mean_ms": 74.82758620689657,
        "old_std_ms": 5.061201788784756,
        "new_std_ms": 5.085476277156075,
        "effect_size_cohens_d": 0.13593674587127913,
        "old_ci95_ms": [
          73.59206317928975,
          77.44241957933097
        ],
        "new_ci95_ms": [
          72.89317448531736,
          76.76199792847578
        ],
        "old_ci99_ms": [
          72.92021243343059,
          78.11427032519012
        ],
        "new_ci99_ms": [
          72.21810141523599,
          77.43707099855715
        ],
        "new_times": [
          0.07,
          0.08,
          0.08,
          0.07,
          0.07,
          0.08,
          0.07,
          0.07,
          0.07,
          0.08,
          0.07,
          0.07,
          0.07,
          0.08,
          0.08,
          0.08,
          0.08,
          0.08,
          0.08,
          0.08,
          0.07,
          0.08,
          0.07,
          0.07,
          0.07,
          0.07,
          0.07,
          0.08,
          0.08
        ],
        "old_times": [
          0.08,
          0.07,
          0.08,
          0.07,
          0.07,
          0.08,
          0.07,
          0.08,
          0.07,
          0.07,
          0.08,
          0.07,
          0.08,
          0.07,
          0.07,
          0.08,
          0.08,
          0.08,
          0.08,
          0.08,
          0.07,
          0.08,
          0.08,
          0.08,
          0.07,
          0.07,
          0.08,
          0.08,
          0.07
        ]
      },
      {
        "test_name": "generate_primes2",
        "is_significant": false,
        "p_value": 0.9999999999998118,
        "is_pair_significant": false,
        "pair_p_value": 0.999999999994971,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 1.0,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.0479089975698739,
        "relative_improvement": 0.006320395429867929,
        "absolute_improvement_ms": 53.79310344827637,
        "old_mean_ms": 8511.034482758621,
        "new_mean_ms": 8457.241379310344,
        "old_std_ms": 175.8112792494555,
        "new_std_ms": 55.28475324071459,
        "effect_size_cohens_d": 0.4127806519762431,
        "old_ci95_ms": [
          8444.159448675055,
          8577.909516842186
        ],
        "new_ci95_ms": [
          8436.212183839738,
          8478.270574780952
        ],
        "old_ci99_ms": [
          8420.821327805039,
          8601.247637712204
        ],
        "new_ci99_ms": [
          8428.873392728558,
          8485.60936589213
        ],
        "new_times": [
          8.52,
          8.54,
          8.5,
          8.47,
          8.44,
          8.46,
          8.36,
          8.51,
          8.51,
          8.44,
          8.4,
          8.41,
          8.45,
          8.5,
          8.43,
          8.39,
          8.52,
          8.36,
          8.5,
          8.42,
          8.44,
          8.45,
          8.51,
          8.48,
          8.51,
          8.39,
          8.37,
          8.55,
          8.43
        ],
        "old_times": [
          8.6,
          8.64,
          8.3,
          8.64,
          8.67,
          8.45,
          8.43,
          8.54,
          8.22,
          8.62,
          8.67,
          8.2,
          8.38,
          8.52,
          8.39,
          8.61,
          8.71,
          8.4,
          8.38,
          8.52,
          8.66,
          8.24,
          8.76,
          8.64,
          8.16,
          8.39,
          8.73,
          8.68,
          8.67
        ]
      },
      {
        "test_name": "ilog2",
        "is_significant": false,
        "p_value": 0.9990052162718073,
        "is_pair_significant": false,
        "pair_p_value": 0.9964752898929471,
        "is_binom_significant": false,
        "binom_p_value": 0.9999999441206455,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999308741884017,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.6549056676980608,
        "relative_improvement": -0.01167315175097286,
        "absolute_improvement_ms": -1.0344827586206973,
        "old_mean_ms": 88.62068965517238,
        "new_mean_ms": 89.65517241379308,
        "old_std_ms": 7.894002212817058,
        "new_std_ms": 4.987669525002673,
        "effect_size_cohens_d": -0.15667497729262272,
        "old_ci95_ms": [
          85.61797180173566,
          91.62340750860912
        ],
        "new_ci95_ms": [
          87.75796439104245,
          91.55238043654371
        ],
        "old_ci99_ms": [
          84.57008011596109,
          92.67129919438369
        ],
        "new_ci99_ms": [
          87.0958747075413,
          92.21447012004488
        ],
        "new_times": [
          0.09,
          0.09,
          0.1,
          0.1,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.08,
          0.09,
          0.09,
          0.09,
          0.07,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09
        ],
        "old_times": [
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.1,
          0.09,
          0.09,
          0.09,
          0.05,
          0.09,
          0.08,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09,
          0.09
        ]
      },
      {
        "test_name": "isqrt",
        "is_significant": false,
        "p_value": 0.9999989531043207,
        "is_pair_significant": false,
        "pair_p_value": 0.9999886142802323,
        "is_binom_significant": false,
        "binom_p_value": 0.9999999981373549,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999974056963806,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.5098128844337928,
        "relative_improvement": 0.0,
        "absolute_improvement_ms": 0.0,
        "old_mean_ms": 50.34482758620691,
        "new_mean_ms": 50.34482758620691,
        "old_std_ms": 1.8569533817705177,
        "new_std_ms": 1.8569533817705177,
        "effect_size_cohens_d": 0.0,
        "old_ci95_ms": [
          49.63848029593269,
          51.051174876481134
        ],
        "new_ci95_ms": [
          49.63848029593269,
          51.051174876481134
        ],
        "old_ci99_ms": [
          49.391978463634125,
          51.2976767087797
        ],
        "new_ci99_ms": [
          49.391978463634125,
          51.2976767087797
        ],
        "new_times": [
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.06,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05
        ],
        "old_times": [
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.06,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05,
          0.05
        ]
      },
      {
        "test_name": "move_primesieve_iterator",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999987760379752,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.7887628435698402,
        "relative_improvement": -0.0002820476660557077,
        "absolute_improvement_ms": -0.6896551724135946,
        "old_mean_ms": 2445.1724137931037,
        "new_mean_ms": 2445.862068965517,
        "old_std_ms": 34.18653553407628,
        "new_std_ms": 25.56745159926558,
        "effect_size_cohens_d": -0.02284670103710433,
        "old_ci95_ms": [
          2432.16855113537,
          2458.1762764508376
        ],
        "new_ci95_ms": [
          2436.1367304978708,
          2455.5874074331637
        ],
        "old_ci99_ms": [
          2427.630449246644,
          2462.7143783395636
        ],
        "new_ci99_ms": [
          2432.7427714850637,
          2458.981366445971
        ],
        "new_times": [
          2.41,
          2.44,
          2.48,
          2.46,
          2.44,
          2.44,
          2.42,
          2.47,
          2.44,
          2.47,
          2.44,
          2.44,
          2.53,
          2.44,
          2.43,
          2.42,
          2.48,
          2.43,
          2.42,
          2.48,
          2.42,
          2.45,
          2.44,
          2.44,
          2.42,
          2.44,
          2.47,
          2.44,
          2.43
        ],
        "old_times": [
          2.43,
          2.41,
          2.45,
          2.43,
          2.41,
          2.41,
          2.47,
          2.42,
          2.43,
          2.42,
          2.45,
          2.41,
          2.49,
          2.47,
          2.42,
          2.42,
          2.47,
          2.42,
          2.41,
          2.45,
          2.51,
          2.51,
          2.42,
          2.47,
          2.46,
          2.49,
          2.52,
          2.42,
          2.42
        ]
      },
      {
        "test_name": "next_prime1",
        "is_significant": false,
        "p_value": 0.9999999961065494,
        "is_pair_significant": false,
        "pair_p_value": 0.9999999570541281,
        "is_binom_significant": false,
        "binom_p_value": 0.9999999441206455,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999967990094816,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.0005714083659740435,
        "relative_improvement": 0.017626101631351917,
        "absolute_improvement_ms": 32.4137931034485,
        "old_mean_ms": 1838.9655172413798,
        "new_mean_ms": 1806.5517241379312,
        "old_std_ms": 24.83442708163218,
        "new_std_ms": 38.93913401239773,
        "effect_size_cohens_d": 0.9925420709885209,
        "old_ci95_ms": [
          1829.5190063882646,
          1848.4120280944946
        ],
        "new_ci95_ms": [
          1791.740069701535,
          1821.3633785743273
        ],
        "old_ci99_ms": [
          1826.222352934385,
          1851.7086815483742
        ],
        "new_ci99_ms": [
          1786.5710827057371,
          1826.5323655701254
        ],
        "new_times": [
          1.82,
          1.82,
          1.76,
          1.81,
          1.77,
          1.8,
          1.76,
          1.85,
          1.8,
          1.76,
          1.88,
          1.84,
          1.8,
          1.87,
          1.75,
          1.83,
          1.83,
          1.8,
          1.8,
          1.76,
          1.85,
          1.84,
          1.84,
          1.76,
          1.76,
          1.84,
          1.84,
          1.81,
          1.74
        ],
        "old_times": [
          1.83,
          1.82,
          1.82,
          1.86,
          1.85,
          1.81,
          1.85,
          1.85,
          1.85,
          1.81,
          1.8,
          1.81,
          1.86,
          1.86,
          1.81,
          1.85,
          1.82,
          1.82,
          1.87,
          1.85,
          1.89,
          1.89,
          1.81,
          1.86,
          1.81,
          1.84,
          1.84,
          1.83,
          1.86
        ]
      },
      {
        "test_name": "next_prime2",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 0.9999999999999708,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999987193211256,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.4968952254601092,
        "relative_improvement": 0.0018859184753837782,
        "absolute_improvement_ms": 19.655172413791888,
        "old_mean_ms": 10422.06896551724,
        "new_mean_ms": 10402.413793103447,
        "old_std_ms": 181.78439565172545,
        "new_std_ms": 93.68088585396838,
        "effect_size_cohens_d": 0.13592243459629322,
        "old_ci95_ms": [
          10352.921879465834,
          10491.216051568645
        ],
        "new_ci95_ms": [
          10366.779489882356,
          10438.048096324537
        ],
        "old_ci99_ms": [
          10328.79085547173,
          10515.347075562748
        ],
        "new_ci99_ms": [
          10354.343792658587,
          10450.483793548308
        ],
        "new_times": [
          10.48,
          10.35,
          10.29,
          10.49,
          10.46,
          10.4,
          10.33,
          10.3,
          10.36,
          10.35,
          10.66,
          10.42,
          10.25,
          10.37,
          10.47,
          10.51,
          10.35,
          10.38,
          10.36,
          10.45,
          10.33,
          10.48,
          10.58,
          10.37,
          10.34,
          10.32,
          10.32,
          10.53,
          10.37
        ],
        "old_times": [
          10.25,
          10.28,
          10.36,
          10.22,
          10.58,
          10.32,
          10.36,
          10.41,
          10.68,
          10.19,
          10.68,
          10.33,
          10.19,
          10.64,
          10.36,
          10.59,
          10.72,
          10.13,
          10.32,
          10.39,
          10.67,
          10.27,
          10.37,
          10.62,
          10.4,
          10.21,
          10.67,
          10.4,
          10.63
        ]
      },
      {
        "test_name": "nth_prime1",
        "is_significant": true,
        "p_value": 0.0006421911566120842,
        "is_pair_significant": true,
        "pair_p_value": 0.0013579799191059745,
        "is_binom_significant": true,
        "binom_p_value": 0.004065029323101044,
        "is_wilcoxon_significant": true,
        "wilcoxon_p_value": 0.0004476882177654263,
        "is_mannwhitney_significant": true,
        "mannwhitney_p_value": 3.0388200116559583e-11,
        "relative_improvement": 0.06128717018009215,
        "absolute_improvement_ms": 151.37931034482799,
        "old_mean_ms": 2470.0,
        "new_mean_ms": 2318.620689655172,
        "old_std_ms": 30.58944729337687,
        "new_std_ms": 33.351390839603084,
        "effect_size_cohens_d": 4.730569312709918,
        "old_ci95_ms": [
          2458.3643965331744,
          2481.635603466826
        ],
        "new_ci95_ms": [
          2305.9344990498007,
          2331.3068802605435
        ],
        "old_ci99_ms": [
          2454.303791199276,
          2485.696208800724
        ],
        "new_ci99_ms": [
          2301.5072586934334,
          2335.7341206169112
        ],
        "new_times": [
          2.29,
          2.31,
          2.32,
          2.34,
          2.34,
          2.3,
          2.38,
          2.29,
          2.36,
          2.32,
          2.28,
          2.34,
          2.33,
          2.31,
          2.27,
          2.29,
          2.31,
          2.33,
          2.37,
          2.34,
          2.31,
          2.3,
          2.39,
          2.36,
          2.3,
          2.33,
          2.29,
          2.29,
          2.25
        ],
        "old_times": [
          2.43,
          2.47,
          2.47,
          2.51,
          2.48,
          2.46,
          2.46,
          2.48,
          2.48,
          2.45,
          2.46,
          2.47,
          2.45,
          2.43,
          2.51,
          2.46,
          2.44,
          2.45,
          2.5,
          2.47,
          2.44,
          2.5,
          2.42,
          2.52,
          2.41,
          2.51,
          2.51,
          2.52,
          2.47
        ]
      },
      {
        "test_name": "nth_prime2",
        "is_significant": false,
        "p_value": 0.9999999999651646,
        "is_pair_significant": false,
        "pair_p_value": 0.9999999998259868,
        "is_binom_significant": false,
        "binom_p_value": 0.9999999981373549,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999985774488067,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.549533630685933,
        "relative_improvement": 0.0030284428074482533,
        "absolute_improvement_ms": 25.517241379311884,
        "old_mean_ms": 8425.862068965518,
        "new_mean_ms": 8400.344827586207,
        "old_std_ms": 227.11729570830192,
        "new_std_ms": 58.644373656612146,
        "effect_size_cohens_d": 0.15384478831843962,
        "old_ci95_ms": [
          8339.471269943406,
          8512.25286798763
        ],
        "new_ci95_ms": [
          8378.037700854418,
          8422.651954317993
        ],
        "old_ci99_ms": [
          8309.322516566834,
          8542.401621364203
        ],
        "new_ci99_ms": [
          8370.252935925871,
          8430.436719246542
        ],
        "new_times": [
          8.42,
          8.32,
          8.41,
          8.42,
          8.38,
          8.49,
          8.33,
          8.38,
          8.49,
          8.48,
          8.39,
          8.32,
          8.49,
          8.43,
          8.52,
          8.44,
          8.39,
          8.45,
          8.3,
          8.38,
          8.37,
          8.38,
          8.35,
          8.35,
          8.35,
          8.42,
          8.37,
          8.34,
          8.45
        ],
        "old_times": [
          8.19,
          8.19,
          8.21,
          8.46,
          8.18,
          8.72,
          8.37,
          8.76,
          8.1,
          8.56,
          8.48,
          8.27,
          8.22,
          8.74,
          8.73,
          8.3,
          8.52,
          8.25,
          8.75,
          8.73,
          8.15,
          8.27,
          8.36,
          8.31,
          8.61,
          8.5,
          8.52,
          8.12,
          8.78
        ]
      },
      {
        "test_name": "nth_prime3",
        "is_significant": false,
        "p_value": 0.9930336231415425,
        "is_pair_significant": false,
        "pair_p_value": 0.9943737230608621,
        "is_binom_significant": false,
        "binom_p_value": 0.987940227612853,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9843438851112957,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.015773317421674187,
        "relative_improvement": 0.022919937205651504,
        "absolute_improvement_ms": 25.17241379310331,
        "old_mean_ms": 1098.2758620689654,
        "new_mean_ms": 1073.103448275862,
        "old_std_ms": 55.101786691102134,
        "new_std_ms": 34.651679847536364,
        "effect_size_cohens_d": 0.5469069031884327,
        "old_ci95_ms": [
          1077.3162633517275,
          1119.2354607862035
        ],
        "new_ci95_ms": [
          1059.922654183756,
          1086.284242367968
        ],
        "old_ci99_ms": [
          1070.0017601899247,
          1126.5499639480063
        ],
        "new_ci99_ms": [
          1055.3228065739595,
          1090.8840899777647
        ],
        "new_times": [
          1.04,
          1.09,
          1.07,
          1.07,
          1.04,
          1.09,
          1.03,
          1.01,
          1.09,
          1.05,
          1.02,
          1.07,
          1.12,
          1.11,
          1.08,
          1.09,
          1.07,
          1.02,
          1.12,
          1.14,
          1.09,
          1.07,
          1.06,
          1.13,
          1.09,
          1.04,
          1.1,
          1.03,
          1.09
        ],
        "old_times": [
          1.06,
          1.1,
          1.1,
          1.18,
          1.15,
          1.11,
          1.15,
          1.08,
          1.1,
          1.04,
          1.04,
          1.15,
          1.16,
          1.16,
          0.99,
          1.09,
          0.99,
          1.09,
          1.11,
          1.16,
          1.1,
          1.18,
          1.18,
          1.09,
          1.04,
          1.02,
          1.04,
          1.1,
          1.09
        ]
      },
      {
        "test_name": "prev_prime1",
        "is_significant": false,
        "p_value": 0.9999999999983821,
        "is_pair_significant": false,
        "pair_p_value": 0.9999999999843986,
        "is_binom_significant": false,
        "binom_p_value": 0.9999999981373549,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999984184616395,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.4628015612618296,
        "relative_improvement": 0.004809268772543423,
        "absolute_improvement_ms": 45.51724137930968,
        "old_mean_ms": 9464.482758620688,
        "new_mean_ms": 9418.965517241379,
        "old_std_ms": 223.0884867186204,
        "new_std_ms": 102.34203254584986,
        "effect_size_cohens_d": 0.262264752186717,
        "old_ci95_ms": [
          9379.624436579867,
          9549.34108066151
        ],
        "new_ci95_ms": [
          9380.036690013098,
          9457.89434446966
        ],
        "old_ci99_ms": [
          9350.010488658127,
          9578.95502858325
        ],
        "new_ci99_ms": [
          9366.451266280133,
          9471.479768202624
        ],
        "new_times": [
          9.36,
          9.34,
          9.4,
          9.43,
          9.32,
          9.43,
          9.38,
          9.34,
          9.33,
          9.34,
          9.57,
          9.45,
          9.55,
          9.35,
          9.33,
          9.38,
          9.45,
          9.49,
          9.53,
          9.38,
          9.48,
          9.63,
          9.41,
          9.39,
          9.43,
          9.27,
          9.72,
          9.33,
          9.34
        ],
        "old_times": [
          9.29,
          9.36,
          9.19,
          9.28,
          9.35,
          9.24,
          9.35,
          9.65,
          9.65,
          9.41,
          9.65,
          9.24,
          9.56,
          9.71,
          9.27,
          9.25,
          9.74,
          9.43,
          9.28,
          9.78,
          9.44,
          9.63,
          9.92,
          9.27,
          9.59,
          9.73,
          9.82,
          9.28,
          9.11
        ]
      },
      {
        "test_name": "prev_prime2",
        "is_significant": true,
        "p_value": 0.003492636760810642,
        "is_pair_significant": true,
        "pair_p_value": 0.00579114467319696,
        "is_binom_significant": true,
        "binom_p_value": 0.004065029323101044,
        "is_wilcoxon_significant": true,
        "wilcoxon_p_value": 0.0009495879921098845,
        "is_mannwhitney_significant": true,
        "mannwhitney_p_value": 7.611907858056857e-11,
        "relative_improvement": 0.0635240011497557,
        "absolute_improvement_ms": 76.20689655172418,
        "old_mean_ms": 1199.6551724137933,
        "new_mean_ms": 1123.448275862069,
        "old_std_ms": 25.978391930422518,
        "new_std_ms": 18.950284971277032,
        "effect_size_cohens_d": 3.3515914456043796,
        "old_ci95_ms": [
          1189.7735206039667,
          1209.5368242236195
        ],
        "new_ci95_ms": [
          1116.2399729661593,
          1130.6565787579787
        ],
        "old_ci99_ms": [
          1186.3250111939387,
          1212.9853336336475
        ],
        "new_ci99_ms": [
          1113.7244117173648,
          1133.1721400067731
        ],
        "new_times": [
          1.13,
          1.11,
          1.18,
          1.14,
          1.14,
          1.1,
          1.13,
          1.11,
          1.13,
          1.17,
          1.12,
          1.13,
          1.11,
          1.11,
          1.12,
          1.11,
          1.13,
          1.11,
          1.13,
          1.13,
          1.11,
          1.13,
          1.11,
          1.12,
          1.11,
          1.09,
          1.14,
          1.11,
          1.12
        ],
        "old_times": [
          1.18,
          1.23,
          1.15,
          1.22,
          1.22,
          1.18,
          1.21,
          1.18,
          1.21,
          1.23,
          1.2,
          1.22,
          1.16,
          1.21,
          1.23,
          1.22,
          1.22,
          1.2,
          1.18,
          1.19,
          1.23,
          1.15,
          1.24,
          1.21,
          1.2,
          1.15,
          1.18,
          1.19,
          1.2
        ]
      }
    ]
  },
  "logs": {
    "full_log_path": "/logs/full.log",
    "config_log_path": "/logs/config.log",
    "build_log_path": "/logs/build.log",
    "test_log_path": "/logs/test.log",
    "build_success": true,
    "test_success": true
  },
  "raw_timing_data": {
    "warmup_runs": 1,
    "measurement_runs": 30,
    "min_exec_time_improvement": 0.05,
    "min_p_value": 0.05
  }
}