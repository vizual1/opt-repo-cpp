{
  "metadata": {
    "collection_date": "2026-01-11T17:49:47.015926",
    "repository": "https://github.com/CrowCpp/Crow",
    "repository_name": "CrowCpp/Crow"
  },
  "commit_info": {
    "old_sha": "4f3f5deaaa01825c63c83431bfa96ccec195f741",
    "new_sha": "ae8643a1b638d18f57b7cd90a3ef8653f4c7ba50",
    "commit_message": [
      "Performance fix for non-static streaming data"
    ],
    "commit_date": "2023-12-06T20:37:14+00:00",
    "patch": [
      "--- include/crow/http_connection.h\n@@ -436,26 +436,16 @@ namespace crow\n                 cancel_deadline_timer();\n                 if (res.body.length() > 0)\n                 {\n-                    std::string buf;\n-                    std::vector<asio::const_buffer> buffers;\n-\n-                    while (res.body.length() > 16384)\n+                    std::vector<asio::const_buffer> buffers{1};\n+                    const uint8_t *data = reinterpret_cast<const uint8_t*>(res.body.data());\n+                    size_t length = res.body.length();\n+                    for(size_t transferred = 0; transferred < length;)\n                     {\n-                        //buf.reserve(16385);\n-                        buf = res.body.substr(0, 16384);\n-                        res.body = res.body.substr(16384);\n-                        buffers.clear();\n-                        buffers.push_back(asio::buffer(buf));\n+                        size_t to_transfer = std::min(16385UL, length-transferred);\n+                        buffers[0] = asio::const_buffer(data+transferred, to_transfer);\n                         do_write_sync(buffers);\n+                        transferred += to_transfer;\n                     }\n-                    // Collect whatever is left (less than 16KB) and send it down the socket\n-                    // buf.reserve(is.length());\n-                    buf = res.body;\n-                    res.body.clear();\n-\n-                    buffers.clear();\n-                    buffers.push_back(asio::buffer(buf));\n-                    do_write_sync(buffers);\n                 }\n                 if (close_connection_)\n                 {"
    ],
    "files_changed": [
      {
        "filename": "include/crow/http_connection.h",
        "status": "modified",
        "additions": 7,
        "deletions": 17,
        "changes": 24,
        "patch": "@@ -436,26 +436,16 @@ namespace crow\n                 cancel_deadline_timer();\n                 if (res.body.length() > 0)\n                 {\n-                    std::string buf;\n-                    std::vector<asio::const_buffer> buffers;\n-\n-                    while (res.body.length() > 16384)\n+                    std::vector<asio::const_buffer> buffers{1};\n+                    const uint8_t *data = reinterpret_cast<const uint8_t*>(res.body.data());\n+                    size_t length = res.body.length();\n+                    for(size_t transferred = 0; transferred < length;)\n                     {\n-                        //buf.reserve(16385);\n-                        buf = res.body.substr(0, 16384);\n-                        res.body = res.body.substr(16384);\n-                        buffers.clear();\n-                        buffers.push_back(asio::buffer(buf));\n+                        size_t to_transfer = std::min(16385UL, length-transferred);\n+                        buffers[0] = asio::const_buffer(data+transferred, to_transfer);\n                         do_write_sync(buffers);\n+                        transferred += to_transfer;\n                     }\n-                    // Collect whatever is left (less than 16KB) and send it down the socket\n-                    // buf.reserve(is.length());\n-                    buf = res.body;\n-                    res.body.clear();\n-\n-                    buffers.clear();\n-                    buffers.push_back(asio::buffer(buf));\n-                    do_write_sync(buffers);\n                 }\n                 if (close_connection_)\n                 {"
      }
    ],
    "lines_added": 7,
    "lines_removed": 17
  },
  "issues": [],
  "pull_requests": [],
  "build_info": {
    "old_build_script": "#!/bin/bash\n#!/bin/bash\ncmake --build /test_workspace/workspace/old/build -- -j 1",
    "new_build_script": "#!/bin/bash\n#!/bin/bash\ncmake --build /test_workspace/workspace/old/build -- -j 1",
    "old_test_script": "#!/bin/bash\ncmake -S /test_workspace/workspace/old -B /test_workspace/workspace/old/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DCROW_BUILD_TESTS=ON",
    "new_test_script": "#!/bin/bash\ncmake -S /test_workspace/workspace/old -B /test_workspace/workspace/old/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DCROW_BUILD_TESTS=ON",
    "build_system": "cmake"
  },
  "performance_analysis": {
    "is_significant": false,
    "p_value": 0.9999999995298589,
    "is_pair_significant": false,
    "pair_p_value": 0.9999999999996544,
    "is_binom_significant": false,
    "binom_p_value": 1.0,
    "is_wilcoxon_significant": false,
    "wilcoxon_p_value": 0.9999993536140127,
    "is_mannwhitney_significant": false,
    "mannwhitney_p_value": 0.0195558019916633,
    "relative_improvement": -0.0056001520667923075,
    "absolute_improvement_ms": -127.66666666666637,
    "old_mean_ms": 22796.999999999993,
    "new_mean_ms": 22924.66666666666,
    "old_std_ms": 639.542670653184,
    "new_std_ms": 725.6090584792383,
    "effect_size_cohens_d": -0.18666599307591256,
    "old_ci95_ms": [
      22558.19084205943,
      23035.809157940555
    ],
    "new_ci95_ms": [
      22653.719791343246,
      23195.613541990075
    ],
    "old_ci99_ms": [
      22475.15340485269,
      23118.8465951473
    ],
    "new_ci99_ms": [
      22559.507599733613,
      23289.825733599704
    ],
    "new_times_s": [
      24.52,
      24.53,
      24.53,
      24.53,
      24.53,
      22.53,
      22.52,
      22.52,
      22.52,
      22.52,
      22.52,
      23.52,
      22.53,
      22.52,
      23.52,
      23.53,
      22.52,
      22.53,
      22.52,
      22.53,
      22.52,
      22.53,
      22.53,
      22.52,
      22.53,
      22.53,
      22.52,
      22.52,
      22.52,
      22.53,
      23.52
    ],
    "old_times_s": [
      23.52,
      24.53,
      24.53,
      24.53,
      22.53,
      22.53,
      22.53,
      22.53,
      22.53,
      22.53,
      22.53,
      22.53,
      22.53,
      22.53,
      22.53,
      22.53,
      22.54,
      22.53,
      22.53,
      22.53,
      22.53,
      22.53,
      22.53,
      22.53,
      22.53,
      22.53,
      23.53,
      22.53,
      23.53,
      22.53,
      22.53
    ]
  },
  "tests": {
    "total_tests": 2,
    "significant_improvements": 0,
    "significant_improvements_tests": [],
    "significant_regressions": 0,
    "significant_regressions_tests": [],
    "significant_pair_improvements": 0,
    "significant_pair_improvements_tests": [],
    "significant_pair_regressions": 0,
    "significant_pair_regressions_tests": [],
    "significant_binom_improvements": 0,
    "significant_binom_improvements_tests": [],
    "significant_binom_regressions": 0,
    "significant_binom_regressions_tests": [],
    "significant_wilcoxon_improvements": 0,
    "significant_wilcoxon_improvements_tests": [],
    "significant_wilcoxon_regressions": 0,
    "significant_wilcoxon_regressions_tests": [],
    "significant_mannwhitney_improvements": 0,
    "significant_mannwhitney_improvements_tests": [],
    "significant_mannwhitney_regressions": 0,
    "significant_mannwhitney_regressions_tests": [],
    "tests": [
      {
        "test_name": "crow_test",
        "is_significant": false,
        "p_value": 0.9999999999240994,
        "is_pair_significant": false,
        "pair_p_value": 0.999999999998381,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999991219647325,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.1870114746176924,
        "relative_improvement": -0.005980015372790141,
        "absolute_improvement_ms": -134.13793103448057,
        "old_mean_ms": 22431.034482758627,
        "new_mean_ms": 22565.17241379311,
        "old_std_ms": 560.2827400237072,
        "new_std_ms": 669.3526760431366,
        "effect_size_cohens_d": -0.21732187069299289,
        "old_ci95_ms": [
          22217.914326330236,
          22644.154639187018
        ],
        "new_ci95_ms": [
          22310.564272521366,
          22819.780555064848
        ],
        "old_ci99_ms": [
          22143.53942635864,
          22718.52953915861
        ],
        "new_ci99_ms": [
          22221.71085125709,
          22908.633976329125
        ],
        "new_times": [
          24.22,
          24.22,
          24.22,
          22.22,
          22.22,
          22.22,
          22.22,
          22.22,
          22.22,
          23.22,
          22.22,
          22.22,
          23.22,
          23.22,
          22.22,
          22.22,
          22.22,
          22.23,
          22.22,
          22.22,
          22.22,
          22.22,
          22.22,
          22.22,
          22.22,
          22.22,
          22.22,
          22.22,
          23.22
        ],
        "old_times": [
          24.23,
          24.22,
          22.22,
          22.22,
          22.23,
          22.22,
          22.22,
          22.23,
          22.22,
          22.22,
          22.22,
          22.22,
          22.22,
          22.22,
          22.23,
          22.22,
          22.22,
          22.23,
          22.23,
          22.23,
          22.22,
          22.22,
          22.23,
          22.22,
          23.23,
          22.23,
          23.23,
          22.22,
          22.23
        ]
      },
      {
        "test_name": "template_test",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999997277626866,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.5058797177023625,
        "relative_improvement": 0.0,
        "absolute_improvement_ms": 0.0,
        "old_mean_ms": 301.0344827586207,
        "new_mean_ms": 301.0344827586207,
        "old_std_ms": 3.0993404669460363,
        "new_std_ms": 3.0993404669460363,
        "effect_size_cohens_d": 0.0,
        "old_ci95_ms": [
          299.85555669512564,
          302.21340882211575
        ],
        "new_ci95_ms": [
          299.85555669512564,
          302.21340882211575
        ],
        "old_ci99_ms": [
          299.44413381745983,
          302.6248316997816
        ],
        "new_ci99_ms": [
          299.44413381745983,
          302.6248316997816
        ],
        "new_times": [
          0.31,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.31,
          0.3,
          0.3,
          0.31,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3
        ],
        "old_times": [
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.31,
          0.3,
          0.3,
          0.31,
          0.3,
          0.31,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3,
          0.3
        ]
      }
    ]
  },
  "logs": {
    "full_log_path": "/logs/full.log",
    "config_log_path": "/logs/config.log",
    "build_log_path": "/logs/build.log",
    "test_log_path": "/logs/test.log",
    "build_success": true,
    "test_success": true
  },
  "raw_timing_data": {
    "warmup_runs": 1,
    "measurement_runs": 30,
    "min_exec_time_improvement": 0.05,
    "min_p_value": 0.05
  }
}