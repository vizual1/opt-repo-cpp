{
    "metadata": {
        "collection_date": "2026-01-14T18:37:50.065284",
        "repository": "https://github.com/jupp0r/prometheus-cpp",
        "repository_name": "jupp0r/prometheus-cpp"
    },
    "commit_info": {
        "old_sha": "e1c9c0c59f80f81c45884b82cafc9d49a20a89b1",
        "new_sha": "4d668074b094c720cd6d0506115f7c198eed4487",
        "commit_message": [
            "Binary search for bucket boundaries in Histogram::Observe"
        ],
        "commit_date": "2022-03-28T15:17:23+00:00",
        "patch": [
            "--- core/src/histogram.cc\n@@ -30,12 +30,10 @@ Histogram::Histogram(const BucketBoundaries& buckets)\n }\n \n void Histogram::Observe(const double value) {\n-  // TODO: determine bucket list size at which binary search would be faster\n-  const auto bucket_index = static_cast<std::size_t>(std::distance(\n-      bucket_boundaries_.begin(),\n-      std::find_if(\n-          std::begin(bucket_boundaries_), std::end(bucket_boundaries_),\n-          [value](const double boundary) { return boundary >= value; })));\n+  const auto bucket_index = static_cast<std::size_t>(\n+      std::distance(bucket_boundaries_.begin(),\n+                    std::lower_bound(bucket_boundaries_.begin(),\n+                                     bucket_boundaries_.end(), value)));\n \n   std::lock_guard<std::mutex> lock(mutex_);\n   sum_.Increment(value);"
        ],
        "files_changed": [
            {
                "filename": "core/src/histogram.cc",
                "status": "modified",
                "additions": 4,
                "deletions": 6,
                "changes": 10,
                "patch": "@@ -30,12 +30,10 @@ Histogram::Histogram(const BucketBoundaries& buckets)\n }\n \n void Histogram::Observe(const double value) {\n-  // TODO: determine bucket list size at which binary search would be faster\n-  const auto bucket_index = static_cast<std::size_t>(std::distance(\n-      bucket_boundaries_.begin(),\n-      std::find_if(\n-          std::begin(bucket_boundaries_), std::end(bucket_boundaries_),\n-          [value](const double boundary) { return boundary >= value; })));\n+  const auto bucket_index = static_cast<std::size_t>(\n+      std::distance(bucket_boundaries_.begin(),\n+                    std::lower_bound(bucket_boundaries_.begin(),\n+                                     bucket_boundaries_.end(), value)));\n \n   std::lock_guard<std::mutex> lock(mutex_);\n   sum_.Increment(value);"
            }
        ],
        "lines_added": 4,
        "lines_removed": 6
    },
    "issues": [],
    "pull_requests": [],
    "build_info": {
        "old_build_script": [
            "apt-get update",
            "cmake -S /test_workspace/workspace/old -B /test_workspace/workspace/old/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DCIVETWEB_BUILD_TESTING=ON -DBUILD_TESTING=ON -DENABLE_TESTING=ON",
            "cmake --build /test_workspace/workspace/old/build -- -j 1"
        ],
        "new_build_script": [
            "apt-get update",
            "cmake -S /test_workspace/workspace/new -B /test_workspace/workspace/new/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DCIVETWEB_BUILD_TESTING=ON -DBUILD_TESTING=ON -DENABLE_TESTING=ON",
            "cmake --build /test_workspace/workspace/new/build -- -j 1"
        ],
        "old_test_script": [
            "cd /test_workspace/workspace/old/build",
            "ctest --output-on-failure"
        ],
        "new_test_script": [
            "cd /test_workspace/workspace/new/build",
            "ctest --output-on-failure"
        ],
        "build_system": "cmake"
    },
    "performance_analysis": {
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.999999151187875,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.28639572425255166,
        "relative_improvement": 0.0004906236371565821,
        "absolute_improvement_ms": 2.9999999999992255,
        "old_mean_ms": 6114.666666666667,
        "new_mean_ms": 6111.666666666668,
        "old_std_ms": 20.80008841714191,
        "new_std_ms": 22.2963323616601,
        "effect_size_cohens_d": 0.13913886653619273,
        "old_ci95_ms": [
            6106.899786006596,
            6122.433547326739
        ],
        "new_ci95_ms": [
            6103.341079335626,
            6119.99225399771
        ],
        "old_ci99_ms": [
            6104.199127997225,
            6125.1342053361095
        ],
        "new_ci99_ms": [
            6100.446150844723,
            6122.887182488613
        ],
        "new_times_s": [
            6.1,
            6.11,
            6.1,
            6.11,
            6.11,
            6.13,
            6.1,
            6.14,
            6.1,
            6.11,
            6.12,
            6.09,
            6.1,
            6.17,
            6.12,
            6.09,
            6.09,
            6.16,
            6.12,
            6.09,
            6.11,
            6.13,
            6.08,
            6.08,
            6.12,
            6.12,
            6.09,
            6.11,
            6.09,
            6.11,
            6.15
        ],
        "old_times_s": [
            6.12,
            6.1,
            6.11,
            6.14,
            6.12,
            6.12,
            6.14,
            6.11,
            6.11,
            6.15,
            6.1,
            6.1,
            6.13,
            6.11,
            6.12,
            6.11,
            6.1,
            6.13,
            6.11,
            6.1,
            6.11,
            6.1,
            6.1,
            6.11,
            6.18,
            6.15,
            6.1,
            6.08,
            6.11,
            6.09,
            6.1
        ]
    },
    "tests": {
        "total_tests": 3,
        "significant_improvements": 0,
        "significant_improvements_tests": [],
        "significant_regressions": 0,
        "significant_regressions_tests": [],
        "significant_pair_improvements": 0,
        "significant_pair_improvements_tests": [],
        "significant_pair_regressions": 0,
        "significant_pair_regressions_tests": [],
        "significant_binom_improvements": 0,
        "significant_binom_improvements_tests": [],
        "significant_binom_regressions": 0,
        "significant_binom_regressions_tests": [],
        "significant_wilcoxon_improvements": 0,
        "significant_wilcoxon_improvements_tests": [],
        "significant_wilcoxon_regressions": 0,
        "significant_wilcoxon_regressions_tests": [],
        "significant_mannwhitney_improvements": 0,
        "significant_mannwhitney_improvements_tests": [],
        "significant_mannwhitney_regressions": 0,
        "significant_mannwhitney_regressions_tests": [],
        "tests": [
            {
                "test_name": "prometheus_core_test",
                "is_significant": false,
                "p_value": 1.0,
                "is_pair_significant": false,
                "pair_p_value": 1.0,
                "is_binom_significant": false,
                "binom_p_value": 1.0,
                "is_wilcoxon_significant": false,
                "wilcoxon_p_value": 0.9999987500608026,
                "is_mannwhitney_significant": false,
                "mannwhitney_p_value": 0.20713696815767885,
                "relative_improvement": 0.0009736308316430389,
                "absolute_improvement_ms": 4.137931034483344,
                "old_mean_ms": 4250.0,
                "new_mean_ms": 4245.862068965516,
                "old_std_ms": 20.873770280289175,
                "new_std_ms": 22.44314107429672,
                "effect_size_cohens_d": 0.19092856937815217,
                "old_ci95_ms": [
                    4242.0600424221575,
                    4257.9399575778425
                ],
                "new_ci95_ms": [
                    4237.32515466347,
                    4254.398983267563
                ],
                "old_ci99_ms": [
                    4239.289147540475,
                    4260.710852459525
                ],
                "new_ci99_ms": [
                    4234.345933186151,
                    4257.378204744881
                ],
                "new_times": [
                    4.24,
                    4.25,
                    4.25,
                    4.26,
                    4.23,
                    4.27,
                    4.23,
                    4.24,
                    4.25,
                    4.23,
                    4.24,
                    4.31,
                    4.25,
                    4.23,
                    4.22,
                    4.3,
                    4.25,
                    4.22,
                    4.24,
                    4.26,
                    4.22,
                    4.22,
                    4.25,
                    4.25,
                    4.23,
                    4.25,
                    4.22,
                    4.24,
                    4.28
                ],
                "old_times": [
                    4.24,
                    4.27,
                    4.25,
                    4.25,
                    4.28,
                    4.24,
                    4.24,
                    4.28,
                    4.23,
                    4.24,
                    4.26,
                    4.25,
                    4.26,
                    4.25,
                    4.24,
                    4.27,
                    4.25,
                    4.23,
                    4.24,
                    4.24,
                    4.24,
                    4.24,
                    4.32,
                    4.28,
                    4.24,
                    4.22,
                    4.24,
                    4.23,
                    4.23
                ]
            },
            {
                "test_name": "prometheus_pull_integration_test",
                "is_significant": false,
                "p_value": 1.0,
                "is_pair_significant": false,
                "pair_p_value": 1.0,
                "is_binom_significant": false,
                "binom_p_value": 1.0,
                "is_wilcoxon_significant": false,
                "wilcoxon_p_value": 0.9999999431363717,
                "is_mannwhitney_significant": false,
                "mannwhitney_p_value": 0.16714290224817413,
                "relative_improvement": 0.00020898641588292606,
                "absolute_improvement_ms": 0.3448275862067973,
                "old_mean_ms": 1649.9999999999995,
                "new_mean_ms": 1649.6551724137926,
                "old_std_ms": 4.5194980611205743e-13,
                "new_std_ms": 1.8569533817705206,
                "effect_size_cohens_d": 0.2626128657193693,
                "old_ci95_ms": [
                    1649.9999999999993,
                    1649.9999999999998
                ],
                "new_ci95_ms": [
                    1648.9488251235184,
                    1650.361519704067
                ],
                "old_ci99_ms": [
                    1649.9999999999993,
                    1649.9999999999998
                ],
                "new_ci99_ms": [
                    1648.70232329122,
                    1650.6080215363654
                ],
                "new_times": [
                    1.65,
                    1.65,
                    1.64,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65
                ],
                "old_times": [
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65,
                    1.65
                ]
            },
            {
                "test_name": "prometheus_pull_test",
                "is_significant": false,
                "p_value": 1.0,
                "is_pair_significant": false,
                "pair_p_value": 1.0,
                "is_binom_significant": false,
                "binom_p_value": 1.0,
                "is_wilcoxon_significant": false,
                "wilcoxon_p_value": 0.9999999638108507,
                "is_mannwhitney_significant": false,
                "mannwhitney_p_value": 1.0,
                "relative_improvement": 0.0,
                "absolute_improvement_ms": 0.0,
                "old_mean_ms": 210.0,
                "new_mean_ms": 210.0,
                "old_std_ms": 0.0,
                "new_std_ms": 0.0,
                "effect_size_cohens_d": "NaN",
                "old_ci95_ms": [
                    210.0,
                    210.0
                ],
                "new_ci95_ms": [
                    210.0,
                    210.0
                ],
                "old_ci99_ms": [
                    210.0,
                    210.0
                ],
                "new_ci99_ms": [
                    210.0,
                    210.0
                ],
                "new_times": [
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21
                ],
                "old_times": [
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21,
                    0.21
                ]
            }
        ]
    },
    "logs": {
        "full_log_path": "/logs/full.log",
        "config_log_path": "/logs/config.log",
        "build_log_path": "/logs/build.log",
        "test_log_path": "/logs/test.log",
        "build_success": true,
        "test_success": true
    },
    "raw_timing_data": {
        "warmup_runs": 1,
        "measurement_runs": 30,
        "min_exec_time_improvement": 0.05,
        "min_p_value": 0.05
    }
}