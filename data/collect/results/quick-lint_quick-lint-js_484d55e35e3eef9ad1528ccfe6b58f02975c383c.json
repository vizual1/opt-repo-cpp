{
  "metadata": {
    "collection_date": "2026-01-14T18:38:05.797596",
    "repository": "https://github.com/quick-lint/quick-lint-js",
    "repository_name": "quick-lint/quick-lint-js"
  },
  "commit_info": {
    "old_sha": "150cb02e42105dd173778554f8e02eecaa743d52",
    "new_sha": "484d55e35e3eef9ad1528ccfe6b58f02975c383c",
    "commit_message": [
      "refactor(fe): use span_size instead of int for child indexes\n\nReduce narrow_cast-ing.\n\nOn x86_64, this seems to have no performance penalty:\n\n    Benchmark                                     Time             CPU      Time Old      Time New       CPU Old       CPU New\n    --------------------------------------------------------------------------------------------------------------------------\n    benchmark_parse_file                       +0.0013         +0.0013       2093468       2096186       2093456       2096140\n    benchmark_parse_file                       -0.0018         -0.0018       2090347       2086606       2090317       2086594\n    benchmark_parse_file                       -0.0030         -0.0030       2093381       2087100       2093362       2087045\n    benchmark_parse_file                       -0.0038         -0.0038       2095640       2087710       2095594       2087659\n    benchmark_parse_file                       -0.0033         -0.0033       2093896       2087037       2093830       2087014\n    benchmark_parse_file                       -0.0001         -0.0001       2088977       2088818       2088963       2088754\n    benchmark_parse_file                       -0.0040         -0.0040       2094990       2086705       2094951       2086637\n    benchmark_parse_file                       -0.0002         -0.0002       2096330       2095965       2096290       2095919\n    benchmark_parse_file                       +0.0001         +0.0001       2098723       2098967       2098694       2098919\n    benchmark_parse_file                       +0.0001         +0.0001       2097609       2097810       2097591       2097793\n    benchmark_parse_file_pvalue                 0.2123          0.2123      U Test, Repetitions: 10 vs 10\n    benchmark_parse_file_mean                  -0.0015         -0.0015       2094336       2091290       2094305       2091247\n    benchmark_parse_file_median                -0.0030         -0.0030       2094443       2088264       2094391       2088206\n    benchmark_parse_file_stddev                +0.7220         +0.7250          3029          5215          3025          5218\n    benchmark_parse_file_cv                    +0.7245         +0.7275             0             0             0             0\n    OVERALL_GEOMEAN                            -0.0015         -0.0015             0             0             0             0"
    ],
    "commit_date": "2023-01-26T04:34:42+00:00",
    "patch": [
      "--- src/quick-lint-js/fe/expression.h\n@@ -257,19 +257,20 @@ class expression {\n   identifier variable_identifier() const noexcept;\n   token_type variable_identifier_token_type() const noexcept;\n \n-  int child_count() const noexcept;\n+  span_size child_count() const noexcept;\n \n   expression *child_0() const noexcept { return this->child(0); }\n   expression *child_1() const noexcept { return this->child(1); }\n   expression *child_2() const noexcept { return this->child(2); }\n \n-  expression *child(int) const noexcept;\n+  expression *child(span_size) const noexcept;\n \n   expression_arena::array_ptr<expression *> children() const noexcept;\n \n   // Remove wrapping paren expressions, if any.\n   expression *without_paren() const noexcept;\n \n+  // TODO(strager): Return span_size instead.\n   int object_entry_count() const noexcept;\n \n   object_property_value_pair object_entry(int) const noexcept;\n@@ -1127,12 +1128,11 @@ inline token_type expression::variable_identifier_token_type() const noexcept {\n   }\n }\n \n-inline int expression::child_count() const noexcept {\n-  // TODO(strager): Remove this cast.\n-  return narrow_cast<int>(this->children().size());\n+inline span_size expression::child_count() const noexcept {\n+  return this->children().size();\n }\n \n-inline expression *expression::child(int index) const noexcept {\n+inline expression *expression::child(span_size index) const noexcept {\n   return this->children()[index];\n }\n \n--- src/quick-lint-js/fe/parse-expression.cpp\n@@ -2237,7 +2237,7 @@ expression* parser::parse_arrow_function_expression_remainder(\n     auto* call = expression_cast<expression::call>(parameters_expression);\n     if (this->peek().type == token_type::left_curly) {\n       parameter_list_begin = call->left_paren_span().begin();\n-      for (int i = 1; i < call->child_count(); ++i) {\n+      for (span_size i = 1; i < call->child_count(); ++i) {\n         parameters.emplace_back(call->child(i));\n       }\n       // We will report\n--- src/quick-lint-js/fe/parse.cpp\n@@ -337,7 +337,7 @@ void parser::error_on_pointless_string_compare(\n     return *s == '\"' || *s == '\\'' || *s == '`';\n   };\n \n-  for (int i = 0; i < ast->child_count() - 1; i++) {\n+  for (span_size i = 0; i < ast->child_count() - 1; i++) {\n     expression* lhs = ast->child(i)->without_paren();\n     expression* rhs = ast->child(i + 1)->without_paren();\n \n@@ -420,7 +420,7 @@ void parser::error_on_pointless_compare_against_literal(\n     return s == u8\"==\"sv || s == u8\"===\"sv || s == u8\"!=\"sv || s == u8\"!==\"sv;\n   };\n \n-  for (int i = 0; i < ast->child_count() - 1; i++) {\n+  for (span_size i = 0; i < ast->child_count() - 1; i++) {\n     source_code_span op_span = ast->operator_spans_[i];\n     if (is_comparison_operator(op_span.string_view())) {\n       this->check_compare_against_literal(ast->child(i), ast->child(i + 1),"
    ],
    "files_changed": [
      {
        "filename": "src/quick-lint-js/fe/expression.h",
        "status": "modified",
        "additions": 6,
        "deletions": 6,
        "changes": 12,
        "patch": "@@ -257,19 +257,20 @@ class expression {\n   identifier variable_identifier() const noexcept;\n   token_type variable_identifier_token_type() const noexcept;\n \n-  int child_count() const noexcept;\n+  span_size child_count() const noexcept;\n \n   expression *child_0() const noexcept { return this->child(0); }\n   expression *child_1() const noexcept { return this->child(1); }\n   expression *child_2() const noexcept { return this->child(2); }\n \n-  expression *child(int) const noexcept;\n+  expression *child(span_size) const noexcept;\n \n   expression_arena::array_ptr<expression *> children() const noexcept;\n \n   // Remove wrapping paren expressions, if any.\n   expression *without_paren() const noexcept;\n \n+  // TODO(strager): Return span_size instead.\n   int object_entry_count() const noexcept;\n \n   object_property_value_pair object_entry(int) const noexcept;\n@@ -1127,12 +1128,11 @@ inline token_type expression::variable_identifier_token_type() const noexcept {\n   }\n }\n \n-inline int expression::child_count() const noexcept {\n-  // TODO(strager): Remove this cast.\n-  return narrow_cast<int>(this->children().size());\n+inline span_size expression::child_count() const noexcept {\n+  return this->children().size();\n }\n \n-inline expression *expression::child(int index) const noexcept {\n+inline expression *expression::child(span_size index) const noexcept {\n   return this->children()[index];\n }\n "
      },
      {
        "filename": "src/quick-lint-js/fe/parse-expression.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "patch": "@@ -2237,7 +2237,7 @@ expression* parser::parse_arrow_function_expression_remainder(\n     auto* call = expression_cast<expression::call>(parameters_expression);\n     if (this->peek().type == token_type::left_curly) {\n       parameter_list_begin = call->left_paren_span().begin();\n-      for (int i = 1; i < call->child_count(); ++i) {\n+      for (span_size i = 1; i < call->child_count(); ++i) {\n         parameters.emplace_back(call->child(i));\n       }\n       // We will report"
      },
      {
        "filename": "src/quick-lint-js/fe/parse.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "patch": "@@ -337,7 +337,7 @@ void parser::error_on_pointless_string_compare(\n     return *s == '\"' || *s == '\\'' || *s == '`';\n   };\n \n-  for (int i = 0; i < ast->child_count() - 1; i++) {\n+  for (span_size i = 0; i < ast->child_count() - 1; i++) {\n     expression* lhs = ast->child(i)->without_paren();\n     expression* rhs = ast->child(i + 1)->without_paren();\n \n@@ -420,7 +420,7 @@ void parser::error_on_pointless_compare_against_literal(\n     return s == u8\"==\"sv || s == u8\"===\"sv || s == u8\"!=\"sv || s == u8\"!==\"sv;\n   };\n \n-  for (int i = 0; i < ast->child_count() - 1; i++) {\n+  for (span_size i = 0; i < ast->child_count() - 1; i++) {\n     source_code_span op_span = ast->operator_spans_[i];\n     if (is_comparison_operator(op_span.string_view())) {\n       this->check_compare_against_literal(ast->child(i), ast->child(i + 1),"
      }
    ],
    "lines_added": 9,
    "lines_removed": 9
  },
  "issues": [],
  "pull_requests": [],
  "build_info": {
    "old_build_script": "#!/bin/bash\n#!/bin/bash\ncmake -S /test_workspace/workspace/old -B /test_workspace/workspace/old/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DBENCHMARK_ENABLE_GTEST_TESTS=ON -DBUILD_TESTING=ON -DBENCHMARK_ENABLE_TESTING=ON -DBENCHMARK_USE_BUNDLED_GTEST=ON -DBENCHMARK_ENABLE_ASSEMBLY_TESTS=ON",
    "new_build_script": "#!/bin/bash\n#!/bin/bash\ncmake -S /test_workspace/workspace/old -B /test_workspace/workspace/old/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DBENCHMARK_ENABLE_GTEST_TESTS=ON -DBUILD_TESTING=ON -DBENCHMARK_ENABLE_TESTING=ON -DBENCHMARK_USE_BUNDLED_GTEST=ON -DBENCHMARK_ENABLE_ASSEMBLY_TESTS=ON",
    "old_test_script": "#!/bin/bash\ncmake --build /test_workspace/workspace/old/build -- -j 1",
    "new_test_script": "#!/bin/bash\ncmake --build /test_workspace/workspace/old/build -- -j 1",
    "build_system": "cmake"
  },
  "performance_analysis": {
    "is_significant": false,
    "p_value": 1.0,
    "is_pair_significant": false,
    "pair_p_value": 1.0,
    "is_binom_significant": false,
    "binom_p_value": 1.0,
    "is_wilcoxon_significant": false,
    "wilcoxon_p_value": 0.9999995006436991,
    "is_mannwhitney_significant": false,
    "mannwhitney_p_value": 0.7165003289624856,
    "relative_improvement": -0.0014209591474244813,
    "absolute_improvement_ms": -1.3333333333331865,
    "old_mean_ms": 938.3333333333336,
    "new_mean_ms": 939.6666666666667,
    "old_std_ms": 5.306686305052286,
    "new_std_ms": 7.648904962570544,
    "effect_size_cohens_d": -0.20254787341671207,
    "old_ci95_ms": [
      936.3517841011769,
      940.3148825654903
    ],
    "new_ci95_ms": [
      936.8105186141635,
      942.5228147191701
    ],
    "old_ci99_ms": [
      935.6627704496224,
      941.0038962170447
    ],
    "new_ci99_ms": [
      935.8173941602765,
      943.515939173057
    ],
    "new_times_s": [
      0.93,
      0.94,
      0.93,
      0.93,
      0.94,
      0.94,
      0.94,
      0.93,
      0.94,
      0.93,
      0.94,
      0.94,
      0.93,
      0.94,
      0.94,
      0.94,
      0.94,
      0.95,
      0.94,
      0.94,
      0.93,
      0.95,
      0.94,
      0.96,
      0.94,
      0.95,
      0.95,
      0.93,
      0.93,
      0.95,
      0.94
    ],
    "old_times_s": [
      0.95,
      0.94,
      0.94,
      0.93,
      0.94,
      0.94,
      0.94,
      0.94,
      0.94,
      0.94,
      0.94,
      0.94,
      0.95,
      0.94,
      0.93,
      0.94,
      0.93,
      0.93,
      0.94,
      0.94,
      0.93,
      0.93,
      0.94,
      0.93,
      0.94,
      0.94,
      0.94,
      0.94,
      0.94,
      0.95,
      0.94
    ]
  },
  "tests": {
    "total_tests": 2,
    "significant_improvements": 0,
    "significant_improvements_tests": [],
    "significant_regressions": 0,
    "significant_regressions_tests": [],
    "significant_pair_improvements": 0,
    "significant_pair_improvements_tests": [],
    "significant_pair_regressions": 0,
    "significant_pair_regressions_tests": [],
    "significant_binom_improvements": 0,
    "significant_binom_improvements_tests": [],
    "significant_binom_regressions": 0,
    "significant_binom_regressions_tests": [],
    "significant_wilcoxon_improvements": 0,
    "significant_wilcoxon_improvements_tests": [],
    "significant_wilcoxon_regressions": 0,
    "significant_wilcoxon_regressions_tests": [],
    "significant_mannwhitney_improvements": 0,
    "significant_mannwhitney_improvements_tests": [],
    "significant_mannwhitney_regressions": 0,
    "significant_mannwhitney_regressions_tests": [],
    "tests": [
      {
        "test_name": "quick-lint-js-test",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999993015495038,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.7673381472516912,
        "relative_improvement": -0.002176278563656295,
        "absolute_improvement_ms": -1.3793103448277444,
        "old_mean_ms": 633.7931034482758,
        "new_mean_ms": 635.1724137931035,
        "old_std_ms": 4.938039737912405,
        "new_std_ms": 6.33622784085544,
        "effect_size_cohens_d": -0.2428227439300987,
        "old_ci95_ms": [
          631.9147735869115,
          635.6714333096401
        ],
        "new_ci95_ms": [
          632.7622416208322,
          637.5825859653747
        ],
        "old_ci99_ms": [
          631.2592720243479,
          636.3269348722038
        ],
        "new_ci99_ms": [
          631.9211371601791,
          638.4236904260279
        ],
        "new_times": [
          0.63,
          0.63,
          0.63,
          0.63,
          0.63,
          0.63,
          0.64,
          0.63,
          0.64,
          0.64,
          0.63,
          0.64,
          0.63,
          0.64,
          0.63,
          0.64,
          0.64,
          0.64,
          0.63,
          0.65,
          0.63,
          0.65,
          0.63,
          0.64,
          0.63,
          0.63,
          0.63,
          0.64,
          0.64
        ],
        "old_times": [
          0.63,
          0.63,
          0.64,
          0.63,
          0.64,
          0.63,
          0.64,
          0.63,
          0.63,
          0.64,
          0.64,
          0.64,
          0.63,
          0.63,
          0.63,
          0.63,
          0.63,
          0.64,
          0.63,
          0.63,
          0.63,
          0.63,
          0.64,
          0.64,
          0.64,
          0.63,
          0.63,
          0.64,
          0.63
        ]
      },
      {
        "test_name": "quick-lint-js-test-cli",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999999638108507,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 1.0,
        "relative_improvement": 0.0,
        "absolute_improvement_ms": 0.0,
        "old_mean_ms": 100.00000000000003,
        "new_mean_ms": 100.00000000000003,
        "old_std_ms": 2.824686288200359e-14,
        "new_std_ms": 2.824686288200359e-14,
        "effect_size_cohens_d": 0.0,
        "old_ci95_ms": [
          100.00000000000001,
          100.00000000000004
        ],
        "new_ci95_ms": [
          100.00000000000001,
          100.00000000000004
        ],
        "old_ci99_ms": [
          100.00000000000001,
          100.00000000000004
        ],
        "new_ci99_ms": [
          100.00000000000001,
          100.00000000000004
        ],
        "new_times": [
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1
        ],
        "old_times": [
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1
        ]
      }
    ]
  },
  "logs": {
    "full_log_path": "/logs/full.log",
    "config_log_path": "/logs/config.log",
    "build_log_path": "/logs/build.log",
    "test_log_path": "/logs/test.log",
    "build_success": true,
    "test_success": true
  },
  "raw_timing_data": {
    "warmup_runs": 1,
    "measurement_runs": 30,
    "min_exec_time_improvement": 0.05,
    "min_p_value": 0.05
  }
}