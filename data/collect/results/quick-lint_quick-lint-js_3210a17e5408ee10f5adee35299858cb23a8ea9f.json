{
    "metadata": {
        "collection_date": "2026-01-14T18:38:03.472166",
        "repository": "https://github.com/quick-lint/quick-lint-js",
        "repository_name": "quick-lint/quick-lint-js"
    },
    "commit_info": {
        "old_sha": "7fdb7615a7a42b7db762b1c3d69dbcd75018eb40",
        "new_sha": "3210a17e5408ee10f5adee35299858cb23a8ea9f",
        "commit_message": [
            "perf(fe): optimize identifier parsing in wasm\n\nTeach our identifier parsing about WebAssembly's SIMD128. This slows\ndown parsing of tiny identifiers, but overall is a perf win (34%\nreduction in lexing time on a jQuery snippet).\n\nThis new code only be used when compiling with\n-DCMAKE_CXX_FLAGS=-msimd128, so this patch will not affect production\nbuilds yet.\n\n    Benchmark                                                           Time             CPU      Time Old      Time New       CPU Old       CPU New\n    ------------------------------------------------------------------------------------------------------------------------------------------------\n    benchmark_lex/empty_mean                                         -0.0016         -0.0016             9             9             9             9\n    benchmark_lex/tiny_number_mean                                   -0.0017         -0.0017            22            22            22            22\n    benchmark_lex/small_number_mean                                  -0.0023         -0.0023            24            24            24            24\n    benchmark_lex/tiny_identifier_mean                               +0.0341         +0.0341            19            20            19            20\n    benchmark_lex/tiny_identifiers_with_spaces_mean                  +0.1140         +0.1140           126           141           126           141\n    benchmark_lex/tiny_identifiers_with_dots_mean                    +0.1120         +0.1120           147           163           147           163\n    benchmark_lex/20_spaces_mean                                     -0.0205         -0.0205            22            22            22            22\n    benchmark_lex/small_identifier_mean                              -0.1585         -0.1585            28            24            28            24\n    benchmark_lex/normal_identifier_mean                             -0.4959         -0.4959            47            24            47            24\n    benchmark_lex/mixed_case_identifier_mean                         -0.7295         -0.7295            73            20            73            20\n    benchmark_lex/long_identifier_1_mean                             -0.7774         -0.7774           226            50           226            50\n    benchmark_lex/long_identifier_2_mean                             -0.7757         -0.7757           225            51           225            51\n    benchmark_lex/jquery_snippet_mean                                -0.3210         -0.3210          1532          1040          1532          1040\n    OVERALL_GEOMEAN                                                  -0.3399         -0.3399             0             0             0             0"
        ],
        "commit_date": "2022-07-24T02:34:21+00:00",
        "patch": [
            "--- src/quick-lint-js/fe/lex.cpp\n@@ -1604,6 +1604,8 @@ const char8* lexer::parse_identifier_fast_only(const char8* input) {\n \n #if QLJS_HAVE_ARM_NEON\n   using char_vector = char_vector_16_neon;\n+#elif QLJS_HAVE_WEB_ASSEMBLY_SIMD128\n+  using char_vector = char_vector_16_wasm_simd128;\n #elif QLJS_HAVE_X86_SSE2\n   using char_vector = char_vector_16_sse2;\n #else\n@@ -1629,6 +1631,8 @@ const char8* lexer::parse_identifier_fast_only(const char8* input) {\n #else\n #if QLJS_HAVE_ARM_NEON\n     using bool_vector = bool_vector_16_neon;\n+#elif QLJS_HAVE_WEB_ASSEMBLY_SIMD128\n+    using bool_vector = bool_vector_16_wasm_simd128;\n #elif QLJS_HAVE_X86_SSE2\n     using bool_vector = bool_vector_16_sse2;\n #else\n--- src/quick-lint-js/port/have.h\n@@ -292,6 +292,14 @@\n #endif\n #endif\n \n+#if !defined(QLJS_HAVE_WEB_ASSEMBLY_SIMD128)\n+#if defined(__wasm_simd128__)\n+#define QLJS_HAVE_WEB_ASSEMBLY_SIMD128 1\n+#else\n+#define QLJS_HAVE_WEB_ASSEMBLY_SIMD128 0\n+#endif\n+#endif\n+\n #if !defined(QLJS_HAVE_X86_SSE2)\n #if defined(_M_AMD64) || defined(_M_X64) || \\\n     (defined(_M_IX86_FP) && _M_IX86_FP == 2) || defined(__SSE2__)\n--- src/quick-lint-js/port/simd.h\n@@ -16,11 +16,86 @@\n #include <arm_neon.h>\n #endif\n \n+#if QLJS_HAVE_WEB_ASSEMBLY_SIMD128\n+#include <wasm_simd128.h>\n+#endif\n+\n #if QLJS_HAVE_X86_SSE2\n #include <emmintrin.h>\n #endif\n \n namespace quick_lint_js {\n+#if QLJS_HAVE_WEB_ASSEMBLY_SIMD128\n+class alignas(::v128_t) bool_vector_16_wasm_simd128 {\n+ public:\n+  static constexpr int size = 16;\n+\n+  QLJS_FORCE_INLINE explicit bool_vector_16_wasm_simd128(::v128_t data) noexcept\n+      : data_(data) {}\n+\n+  QLJS_FORCE_INLINE friend bool_vector_16_wasm_simd128 operator|(\n+      bool_vector_16_wasm_simd128 x, bool_vector_16_wasm_simd128 y) noexcept {\n+    return bool_vector_16_wasm_simd128(::wasm_v128_or(x.data_, y.data_));\n+  }\n+\n+  QLJS_FORCE_INLINE friend bool_vector_16_wasm_simd128 operator&(\n+      bool_vector_16_wasm_simd128 x, bool_vector_16_wasm_simd128 y) noexcept {\n+    return bool_vector_16_wasm_simd128(::wasm_v128_and(x.data_, y.data_));\n+  }\n+\n+  QLJS_FORCE_INLINE int find_first_false() const noexcept {\n+    return countr_one(this->mask());\n+  }\n+\n+  QLJS_FORCE_INLINE std::uint32_t mask() const noexcept {\n+    return ::wasm_i8x16_bitmask(this->data_);\n+  }\n+\n+ private:\n+  ::v128_t data_;\n+};\n+\n+class alignas(::v128_t) char_vector_16_wasm_simd128 {\n+ public:\n+  static constexpr int size = 16;\n+\n+  QLJS_FORCE_INLINE explicit char_vector_16_wasm_simd128(::v128_t data) noexcept\n+      : data_(data) {}\n+\n+  QLJS_FORCE_INLINE static char_vector_16_wasm_simd128 load(const char8* data) {\n+    return char_vector_16_wasm_simd128(::wasm_v128_load(data));\n+  }\n+\n+  QLJS_FORCE_INLINE static char_vector_16_wasm_simd128 repeated(\n+      std::uint8_t c) {\n+    return char_vector_16_wasm_simd128(::wasm_u8x16_splat(c));\n+  }\n+\n+  QLJS_FORCE_INLINE friend char_vector_16_wasm_simd128 operator|(\n+      char_vector_16_wasm_simd128 x, char_vector_16_wasm_simd128 y) noexcept {\n+    return char_vector_16_wasm_simd128(::wasm_v128_or(x.data_, y.data_));\n+  }\n+\n+  QLJS_FORCE_INLINE friend bool_vector_16_wasm_simd128 operator==(\n+      char_vector_16_wasm_simd128 x, char_vector_16_wasm_simd128 y) noexcept {\n+    return bool_vector_16_wasm_simd128(::wasm_i8x16_eq(x.data_, y.data_));\n+  }\n+\n+  QLJS_FORCE_INLINE friend bool_vector_16_wasm_simd128 operator<(\n+      char_vector_16_wasm_simd128 x, char_vector_16_wasm_simd128 y) noexcept {\n+    return bool_vector_16_wasm_simd128(::wasm_u8x16_lt(x.data_, y.data_));\n+  }\n+\n+  QLJS_FORCE_INLINE friend bool_vector_16_wasm_simd128 operator>(\n+      char_vector_16_wasm_simd128 x, char_vector_16_wasm_simd128 y) noexcept {\n+    return bool_vector_16_wasm_simd128(::wasm_u8x16_gt(x.data_, y.data_));\n+  }\n+\n+ private:\n+  ::v128_t data_;\n+};\n+#endif\n+\n #if QLJS_HAVE_X86_SSE2\n class alignas(__m128i) bool_vector_16_sse2 {\n  public:"
        ],
        "files_changed": [
            {
                "filename": "src/quick-lint-js/fe/lex.cpp",
                "status": "modified",
                "additions": 4,
                "deletions": 0,
                "changes": 4,
                "patch": "@@ -1604,6 +1604,8 @@ const char8* lexer::parse_identifier_fast_only(const char8* input) {\n \n #if QLJS_HAVE_ARM_NEON\n   using char_vector = char_vector_16_neon;\n+#elif QLJS_HAVE_WEB_ASSEMBLY_SIMD128\n+  using char_vector = char_vector_16_wasm_simd128;\n #elif QLJS_HAVE_X86_SSE2\n   using char_vector = char_vector_16_sse2;\n #else\n@@ -1629,6 +1631,8 @@ const char8* lexer::parse_identifier_fast_only(const char8* input) {\n #else\n #if QLJS_HAVE_ARM_NEON\n     using bool_vector = bool_vector_16_neon;\n+#elif QLJS_HAVE_WEB_ASSEMBLY_SIMD128\n+    using bool_vector = bool_vector_16_wasm_simd128;\n #elif QLJS_HAVE_X86_SSE2\n     using bool_vector = bool_vector_16_sse2;\n #else"
            },
            {
                "filename": "src/quick-lint-js/port/have.h",
                "status": "modified",
                "additions": 8,
                "deletions": 0,
                "changes": 8,
                "patch": "@@ -292,6 +292,14 @@\n #endif\n #endif\n \n+#if !defined(QLJS_HAVE_WEB_ASSEMBLY_SIMD128)\n+#if defined(__wasm_simd128__)\n+#define QLJS_HAVE_WEB_ASSEMBLY_SIMD128 1\n+#else\n+#define QLJS_HAVE_WEB_ASSEMBLY_SIMD128 0\n+#endif\n+#endif\n+\n #if !defined(QLJS_HAVE_X86_SSE2)\n #if defined(_M_AMD64) || defined(_M_X64) || \\\n     (defined(_M_IX86_FP) && _M_IX86_FP == 2) || defined(__SSE2__)"
            },
            {
                "filename": "src/quick-lint-js/port/simd.h",
                "status": "modified",
                "additions": 75,
                "deletions": 0,
                "changes": 75,
                "patch": "@@ -16,11 +16,86 @@\n #include <arm_neon.h>\n #endif\n \n+#if QLJS_HAVE_WEB_ASSEMBLY_SIMD128\n+#include <wasm_simd128.h>\n+#endif\n+\n #if QLJS_HAVE_X86_SSE2\n #include <emmintrin.h>\n #endif\n \n namespace quick_lint_js {\n+#if QLJS_HAVE_WEB_ASSEMBLY_SIMD128\n+class alignas(::v128_t) bool_vector_16_wasm_simd128 {\n+ public:\n+  static constexpr int size = 16;\n+\n+  QLJS_FORCE_INLINE explicit bool_vector_16_wasm_simd128(::v128_t data) noexcept\n+      : data_(data) {}\n+\n+  QLJS_FORCE_INLINE friend bool_vector_16_wasm_simd128 operator|(\n+      bool_vector_16_wasm_simd128 x, bool_vector_16_wasm_simd128 y) noexcept {\n+    return bool_vector_16_wasm_simd128(::wasm_v128_or(x.data_, y.data_));\n+  }\n+\n+  QLJS_FORCE_INLINE friend bool_vector_16_wasm_simd128 operator&(\n+      bool_vector_16_wasm_simd128 x, bool_vector_16_wasm_simd128 y) noexcept {\n+    return bool_vector_16_wasm_simd128(::wasm_v128_and(x.data_, y.data_));\n+  }\n+\n+  QLJS_FORCE_INLINE int find_first_false() const noexcept {\n+    return countr_one(this->mask());\n+  }\n+\n+  QLJS_FORCE_INLINE std::uint32_t mask() const noexcept {\n+    return ::wasm_i8x16_bitmask(this->data_);\n+  }\n+\n+ private:\n+  ::v128_t data_;\n+};\n+\n+class alignas(::v128_t) char_vector_16_wasm_simd128 {\n+ public:\n+  static constexpr int size = 16;\n+\n+  QLJS_FORCE_INLINE explicit char_vector_16_wasm_simd128(::v128_t data) noexcept\n+      : data_(data) {}\n+\n+  QLJS_FORCE_INLINE static char_vector_16_wasm_simd128 load(const char8* data) {\n+    return char_vector_16_wasm_simd128(::wasm_v128_load(data));\n+  }\n+\n+  QLJS_FORCE_INLINE static char_vector_16_wasm_simd128 repeated(\n+      std::uint8_t c) {\n+    return char_vector_16_wasm_simd128(::wasm_u8x16_splat(c));\n+  }\n+\n+  QLJS_FORCE_INLINE friend char_vector_16_wasm_simd128 operator|(\n+      char_vector_16_wasm_simd128 x, char_vector_16_wasm_simd128 y) noexcept {\n+    return char_vector_16_wasm_simd128(::wasm_v128_or(x.data_, y.data_));\n+  }\n+\n+  QLJS_FORCE_INLINE friend bool_vector_16_wasm_simd128 operator==(\n+      char_vector_16_wasm_simd128 x, char_vector_16_wasm_simd128 y) noexcept {\n+    return bool_vector_16_wasm_simd128(::wasm_i8x16_eq(x.data_, y.data_));\n+  }\n+\n+  QLJS_FORCE_INLINE friend bool_vector_16_wasm_simd128 operator<(\n+      char_vector_16_wasm_simd128 x, char_vector_16_wasm_simd128 y) noexcept {\n+    return bool_vector_16_wasm_simd128(::wasm_u8x16_lt(x.data_, y.data_));\n+  }\n+\n+  QLJS_FORCE_INLINE friend bool_vector_16_wasm_simd128 operator>(\n+      char_vector_16_wasm_simd128 x, char_vector_16_wasm_simd128 y) noexcept {\n+    return bool_vector_16_wasm_simd128(::wasm_u8x16_gt(x.data_, y.data_));\n+  }\n+\n+ private:\n+  ::v128_t data_;\n+};\n+#endif\n+\n #if QLJS_HAVE_X86_SSE2\n class alignas(__m128i) bool_vector_16_sse2 {\n  public:"
            }
        ],
        "lines_added": 87,
        "lines_removed": 0
    },
    "issues": [],
    "pull_requests": [],
    "build_info": {
        "old_build_script": [
            "apt-get update",
            "cmake -S /test_workspace/workspace/old -B /test_workspace/workspace/old/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DBENCHMARK_ENABLE_ASSEMBLY_TESTS=ON -DBUILD_TESTING=ON -DBENCHMARK_ENABLE_GTEST_TESTS=ON -DBENCHMARK_USE_BUNDLED_GTEST=ON -DBENCHMARK_ENABLE_TESTING=ON",
            "cmake --build /test_workspace/workspace/old/build -- -j 1"
        ],
        "new_build_script": [
            "apt-get update",
            "cmake -S /test_workspace/workspace/new -B /test_workspace/workspace/new/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DBENCHMARK_ENABLE_ASSEMBLY_TESTS=ON -DBUILD_TESTING=ON -DBENCHMARK_ENABLE_GTEST_TESTS=ON -DBENCHMARK_USE_BUNDLED_GTEST=ON -DBENCHMARK_ENABLE_TESTING=ON",
            "cmake --build /test_workspace/workspace/new/build -- -j 1"
        ],
        "old_test_script": [
            "cd /test_workspace/workspace/old/build",
            "ctest --output-on-failure"
        ],
        "new_test_script": [
            "cd /test_workspace/workspace/new/build",
            "ctest --output-on-failure"
        ],
        "build_system": "cmake"
    },
    "performance_analysis": {
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999993213863474,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.02335511713472469,
        "relative_improvement": 0.00457535030025747,
        "absolute_improvement_ms": 5.333333333333412,
        "old_mean_ms": 1165.6666666666665,
        "new_mean_ms": 1160.333333333333,
        "old_std_ms": 11.65105688067747,
        "new_std_ms": 4.901325178535613,
        "effect_size_cohens_d": 0.5967136216670301,
        "old_ci95_ms": [
            1161.3160905277039,
            1170.017242805629
        ],
        "new_ci95_ms": [
            1158.5031484334206,
            1162.1635182332452
        ],
        "old_ci99_ms": [
            1159.8033315695982,
            1171.5300017637346
        ],
        "new_ci99_ms": [
            1157.8667663741492,
            1162.799900292517
        ],
        "new_times_s": [
            1.16,
            1.15,
            1.17,
            1.16,
            1.16,
            1.16,
            1.16,
            1.16,
            1.16,
            1.16,
            1.16,
            1.16,
            1.16,
            1.16,
            1.16,
            1.17,
            1.16,
            1.16,
            1.15,
            1.17,
            1.16,
            1.16,
            1.16,
            1.15,
            1.16,
            1.17,
            1.16,
            1.16,
            1.16,
            1.16,
            1.16
        ],
        "old_times_s": [
            1.18,
            1.17,
            1.15,
            1.15,
            1.17,
            1.16,
            1.16,
            1.17,
            1.16,
            1.16,
            1.17,
            1.19,
            1.17,
            1.16,
            1.15,
            1.16,
            1.17,
            1.16,
            1.16,
            1.17,
            1.16,
            1.17,
            1.2,
            1.16,
            1.16,
            1.16,
            1.16,
            1.18,
            1.19,
            1.16,
            1.16
        ]
    },
    "tests": {
        "total_tests": 2,
        "significant_improvements": 0,
        "significant_improvements_tests": [],
        "significant_regressions": 0,
        "significant_regressions_tests": [],
        "significant_pair_improvements": 0,
        "significant_pair_improvements_tests": [],
        "significant_pair_regressions": 0,
        "significant_pair_regressions_tests": [],
        "significant_binom_improvements": 0,
        "significant_binom_improvements_tests": [],
        "significant_binom_regressions": 0,
        "significant_binom_regressions_tests": [],
        "significant_wilcoxon_improvements": 0,
        "significant_wilcoxon_improvements_tests": [],
        "significant_wilcoxon_regressions": 0,
        "significant_wilcoxon_regressions_tests": [],
        "significant_mannwhitney_improvements": 0,
        "significant_mannwhitney_improvements_tests": [],
        "significant_mannwhitney_regressions": 0,
        "significant_mannwhitney_regressions_tests": [],
        "tests": [
            {
                "test_name": "quick-lint-js-test",
                "is_significant": false,
                "p_value": 1.0,
                "is_pair_significant": false,
                "pair_p_value": 0.9999999999995626,
                "is_binom_significant": false,
                "binom_p_value": 0.9999999981373549,
                "is_wilcoxon_significant": false,
                "wilcoxon_p_value": 0.9999987793029006,
                "is_mannwhitney_significant": false,
                "mannwhitney_p_value": 0.4834163951175003,
                "relative_improvement": 0.002145922746781197,
                "absolute_improvement_ms": 1.0344827586206695,
                "old_mean_ms": 482.0689655172414,
                "new_mean_ms": 481.0344827586207,
                "old_std_ms": 8.610338613230198,
                "new_std_ms": 4.887906056356196,
                "effect_size_cohens_d": 0.14776097066986293,
                "old_ci95_ms": [
                    478.79376786957624,
                    485.34416316490655
                ],
                "new_ci95_ms": [
                    479.17522272984695,
                    482.89374278739444
                ],
                "old_ci99_ms": [
                    477.65078589398746,
                    486.4871451404953
                ],
                "new_ci99_ms": [
                    478.5263761778424,
                    483.54258933939906
                ],
                "new_times": [
                    0.49,
                    0.48,
                    0.48,
                    0.47,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.49,
                    0.48,
                    0.47,
                    0.48,
                    0.49,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.49,
                    0.49,
                    0.48,
                    0.48,
                    0.48,
                    0.48
                ],
                "old_times": [
                    0.47,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.49,
                    0.49,
                    0.48,
                    0.48,
                    0.47,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.49,
                    0.48,
                    0.49,
                    0.52,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.48,
                    0.48
                ]
            },
            {
                "test_name": "quick-lint-js-test-cli",
                "is_significant": false,
                "p_value": 1.0,
                "is_pair_significant": false,
                "pair_p_value": 1.0,
                "is_binom_significant": false,
                "binom_p_value": 1.0,
                "is_wilcoxon_significant": false,
                "wilcoxon_p_value": 0.9999999638108507,
                "is_mannwhitney_significant": false,
                "mannwhitney_p_value": 1.0,
                "relative_improvement": 0.0,
                "absolute_improvement_ms": 0.0,
                "old_mean_ms": 89.99999999999999,
                "new_mean_ms": 89.99999999999999,
                "old_std_ms": 1.4123431441001795e-14,
                "new_std_ms": 1.4123431441001795e-14,
                "effect_size_cohens_d": 0.0,
                "old_ci95_ms": [
                    89.99999999999999,
                    89.99999999999999
                ],
                "new_ci95_ms": [
                    89.99999999999999,
                    89.99999999999999
                ],
                "old_ci99_ms": [
                    89.99999999999997,
                    90.0
                ],
                "new_ci99_ms": [
                    89.99999999999997,
                    90.0
                ],
                "new_times": [
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09
                ],
                "old_times": [
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09
                ]
            }
        ]
    },
    "logs": {
        "full_log_path": "/logs/full.log",
        "config_log_path": "/logs/config.log",
        "build_log_path": "/logs/build.log",
        "test_log_path": "/logs/test.log",
        "build_success": true,
        "test_success": true
    },
    "raw_timing_data": {
        "warmup_runs": 1,
        "measurement_runs": 30,
        "min_exec_time_improvement": 0.05,
        "min_p_value": 0.05
    }
}