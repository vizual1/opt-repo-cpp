{
  "metadata": {
    "collection_date": "2026-01-11T17:55:29.637753",
    "repository": "https://github.com/zxing-cpp/zxing-cpp",
    "repository_name": "zxing-cpp/zxing-cpp"
  },
  "commit_info": {
    "old_sha": "47df03d5312f61730c5c863b9df1f876485302cf",
    "new_sha": "19470ad786d534ba78025ae88b82013820721c26",
    "commit_message": [
      "ReadBarcode: help gcc's auto-vectorizer with the RGB->Lum conversion\n\nThis makes the `RGBToLum` loop 2-3 times faster with gcc but does currently\nnot help llvm. No idea what msvc is able to make of this.\n\nFor very specific use cases, like\n`ZXingReader samples/falsepositives-1/09.png -s -format qrcode -nos -bin global`\nthis can make a substantial difference (.43ms instead of .76ms)."
    ],
    "commit_date": "2024-02-07T23:48:47+00:00",
    "patch": [
      "--- core/src/ReadBarcode.cpp\n@@ -107,7 +107,14 @@ ImageView SetupLumImageView(ImageView iv, LumImage& lum, const ReaderOptions& op\n \t\tthrow std::invalid_argument(\"Invalid image format\");\n \n \tif (opts.binarizer() == Binarizer::GlobalHistogram || opts.binarizer() == Binarizer::LocalAverage) {\n-\t\tif (iv.format() != ImageFormat::Lum) {\n+\t\t// manually spell out the 3 most common pixel formats to get at least gcc to vectorize the code\n+\t\tif (iv.format() == ImageFormat::RGB && iv.pixStride() == 3) {\n+\t\t\tlum = ExtractLum(iv, [](const uint8_t* src) { return RGBToLum(src[0], src[1], src[2]); });\n+\t\t} else if (iv.format() == ImageFormat::RGBX && iv.pixStride() == 4) {\n+\t\t\tlum = ExtractLum(iv, [](const uint8_t* src) { return RGBToLum(src[0], src[1], src[2]); });\n+\t\t} else if (iv.format() == ImageFormat::BGR && iv.pixStride() == 3) {\n+\t\t\tlum = ExtractLum(iv, [](const uint8_t* src) { return RGBToLum(src[2], src[1], src[0]); });\n+\t\t} else if (iv.format() != ImageFormat::Lum) {\n \t\t\tlum = ExtractLum(iv, [r = RedIndex(iv.format()), g = GreenIndex(iv.format()), b = BlueIndex(iv.format())](\n \t\t\t\t\t\t\t\t\t const uint8_t* src) { return RGBToLum(src[r], src[g], src[b]); });\n \t\t} else if (iv.pixStride() != 1) {"
    ],
    "files_changed": [
      {
        "filename": "core/src/ReadBarcode.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 1,
        "changes": 9,
        "patch": "@@ -107,7 +107,14 @@ ImageView SetupLumImageView(ImageView iv, LumImage& lum, const ReaderOptions& op\n \t\tthrow std::invalid_argument(\"Invalid image format\");\n \n \tif (opts.binarizer() == Binarizer::GlobalHistogram || opts.binarizer() == Binarizer::LocalAverage) {\n-\t\tif (iv.format() != ImageFormat::Lum) {\n+\t\t// manually spell out the 3 most common pixel formats to get at least gcc to vectorize the code\n+\t\tif (iv.format() == ImageFormat::RGB && iv.pixStride() == 3) {\n+\t\t\tlum = ExtractLum(iv, [](const uint8_t* src) { return RGBToLum(src[0], src[1], src[2]); });\n+\t\t} else if (iv.format() == ImageFormat::RGBX && iv.pixStride() == 4) {\n+\t\t\tlum = ExtractLum(iv, [](const uint8_t* src) { return RGBToLum(src[0], src[1], src[2]); });\n+\t\t} else if (iv.format() == ImageFormat::BGR && iv.pixStride() == 3) {\n+\t\t\tlum = ExtractLum(iv, [](const uint8_t* src) { return RGBToLum(src[2], src[1], src[0]); });\n+\t\t} else if (iv.format() != ImageFormat::Lum) {\n \t\t\tlum = ExtractLum(iv, [r = RedIndex(iv.format()), g = GreenIndex(iv.format()), b = BlueIndex(iv.format())](\n \t\t\t\t\t\t\t\t\t const uint8_t* src) { return RGBToLum(src[r], src[g], src[b]); });\n \t\t} else if (iv.pixStride() != 1) {"
      }
    ],
    "lines_added": 8,
    "lines_removed": 1
  },
  "issues": [],
  "pull_requests": [],
  "build_info": {
    "old_build_script": "#!/bin/bash\n#!/bin/bash\ncmake -S /test_workspace/workspace/old -B /test_workspace/workspace/old/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DBUILD_UNIT_TESTS=ON",
    "new_build_script": "#!/bin/bash\n#!/bin/bash\ncmake -S /test_workspace/workspace/old -B /test_workspace/workspace/old/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DBUILD_UNIT_TESTS=ON",
    "old_test_script": "#!/bin/bash\ncmake --build /test_workspace/workspace/old/build -- -j 1",
    "new_test_script": "#!/bin/bash\ncmake --build /test_workspace/workspace/old/build -- -j 1",
    "build_system": "cmake"
  },
  "performance_analysis": {
    "is_significant": false,
    "p_value": 0.9999971529295065,
    "is_pair_significant": false,
    "pair_p_value": 0.9999764642161961,
    "is_binom_significant": false,
    "binom_p_value": 0.9998375428840518,
    "is_wilcoxon_significant": false,
    "wilcoxon_p_value": 0.9998888440619358,
    "is_mannwhitney_significant": false,
    "mannwhitney_p_value": 0.11113214826037154,
    "relative_improvement": 0.009283293126087947,
    "absolute_improvement_ms": 101.3333333333275,
    "old_mean_ms": 10915.666666666662,
    "new_mean_ms": 10814.333333333336,
    "old_std_ms": 346.96400820330877,
    "new_std_ms": 358.3552786650791,
    "effect_size_cohens_d": 0.2873028483789929,
    "old_ci95_ms": [
      10786.108176769361,
      11045.225156563965
    ],
    "new_ci95_ms": [
      10680.521273140137,
      10948.145393526534
    ],
    "old_ci99_ms": [
      10741.058794818417,
      11090.27453851491
    ],
    "new_ci99_ms": [
      10633.992862581597,
      10994.673804085074
    ],
    "new_times_s": [
      11.66,
      11.32,
      10.71,
      10.3,
      11.23,
      11.03,
      10.72,
      11.0,
      10.69,
      10.88,
      10.67,
      11.23,
      10.72,
      10.68,
      11.63,
      10.57,
      10.7,
      10.69,
      10.73,
      10.65,
      10.38,
      10.61,
      11.14,
      10.54,
      11.33,
      11.1,
      11.41,
      10.06,
      10.68,
      10.41,
      10.62
    ],
    "old_times_s": [
      10.83,
      10.68,
      11.23,
      10.72,
      10.89,
      10.41,
      10.95,
      11.08,
      10.53,
      10.68,
      11.48,
      11.4,
      11.03,
      11.47,
      10.7,
      10.95,
      10.76,
      10.47,
      10.63,
      11.56,
      11.37,
      10.88,
      10.72,
      10.38,
      11.2,
      10.94,
      10.69,
      10.68,
      11.53,
      10.76,
      10.7
    ]
  },
  "tests": {
    "total_tests": 3,
    "significant_improvements": 0,
    "significant_improvements_tests": [],
    "significant_regressions": 0,
    "significant_regressions_tests": [],
    "significant_pair_improvements": 0,
    "significant_pair_improvements_tests": [],
    "significant_pair_regressions": 0,
    "significant_pair_regressions_tests": [],
    "significant_binom_improvements": 0,
    "significant_binom_improvements_tests": [],
    "significant_binom_regressions": 0,
    "significant_binom_regressions_tests": [],
    "significant_wilcoxon_improvements": 0,
    "significant_wilcoxon_improvements_tests": [],
    "significant_wilcoxon_regressions": 0,
    "significant_wilcoxon_regressions_tests": [],
    "significant_mannwhitney_improvements": 0,
    "significant_mannwhitney_improvements_tests": [],
    "significant_mannwhitney_regressions": 0,
    "significant_mannwhitney_regressions_tests": [],
    "tests": [
      {
        "test_name": "ZXingWriterTest",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999999638108507,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 1.0,
        "relative_improvement": 0.0,
        "absolute_improvement_ms": 0.0,
        "old_mean_ms": 10.000000000000002,
        "new_mean_ms": 10.000000000000002,
        "old_std_ms": 1.7654289301252243e-15,
        "new_std_ms": 1.7654289301252243e-15,
        "effect_size_cohens_d": 0.0,
        "old_ci95_ms": [
          10.000000000000002,
          10.000000000000002
        ],
        "new_ci95_ms": [
          10.000000000000002,
          10.000000000000002
        ],
        "old_ci99_ms": [
          10.0,
          10.000000000000004
        ],
        "new_ci99_ms": [
          10.0,
          10.000000000000004
        ],
        "new_times": [
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01
        ],
        "old_times": [
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01
        ]
      },
      {
        "test_name": "ZXingReaderTest",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999999638108507,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 1.0,
        "relative_improvement": 0.0,
        "absolute_improvement_ms": 0.0,
        "old_mean_ms": 10.000000000000002,
        "new_mean_ms": 10.000000000000002,
        "old_std_ms": 1.7654289301252243e-15,
        "new_std_ms": 1.7654289301252243e-15,
        "effect_size_cohens_d": 0.0,
        "old_ci95_ms": [
          10.000000000000002,
          10.000000000000002
        ],
        "new_ci95_ms": [
          10.000000000000002,
          10.000000000000002
        ],
        "old_ci99_ms": [
          10.0,
          10.000000000000004
        ],
        "new_ci99_ms": [
          10.0,
          10.000000000000004
        ],
        "new_times": [
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01
        ],
        "old_times": [
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01,
          0.01
        ]
      },
      {
        "test_name": "UnitTest",
        "is_significant": false,
        "p_value": 0.9999881373104677,
        "is_pair_significant": false,
        "pair_p_value": 0.9999446194076574,
        "is_binom_significant": false,
        "binom_p_value": 0.9997269436717033,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9998126030822043,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.0707434906985243,
        "relative_improvement": 0.011728629236216426,
        "absolute_improvement_ms": 127.93103448276,
        "old_mean_ms": 10907.586206896553,
        "new_mean_ms": 10779.655172413792,
        "old_std_ms": 351.9096390959902,
        "new_std_ms": 354.71802441839736,
        "effect_size_cohens_d": 0.36208609069754405,
        "old_ci95_ms": [
          10773.726939110393,
          11041.44547468271
        ],
        "new_ci95_ms": [
          10644.727651982197,
          10914.582692845386
        ],
        "old_ci99_ms": [
          10727.012588770602,
          11088.159825022502
        ],
        "new_ci99_ms": [
          10597.640501692462,
          10961.669843135121
        ],
        "new_times": [
          10.7,
          10.27,
          11.22,
          11.02,
          10.7,
          10.97,
          10.67,
          10.86,
          10.65,
          11.22,
          10.7,
          10.67,
          11.62,
          10.56,
          10.68,
          10.67,
          10.71,
          10.63,
          10.36,
          10.59,
          11.13,
          10.52,
          11.31,
          11.09,
          11.4,
          10.04,
          10.67,
          10.39,
          10.59
        ],
        "old_times": [
          11.21,
          10.7,
          10.88,
          10.4,
          10.93,
          11.07,
          10.51,
          10.66,
          11.47,
          11.39,
          11.01,
          11.46,
          10.68,
          10.93,
          10.74,
          10.45,
          10.61,
          11.55,
          11.35,
          10.85,
          10.71,
          10.36,
          11.18,
          10.92,
          10.68,
          10.66,
          11.52,
          10.75,
          10.69
        ]
      }
    ]
  },
  "logs": {
    "full_log_path": "/logs/full.log",
    "config_log_path": "/logs/config.log",
    "build_log_path": "/logs/build.log",
    "test_log_path": "/logs/test.log",
    "build_success": true,
    "test_success": true
  },
  "raw_timing_data": {
    "warmup_runs": 1,
    "measurement_runs": 30,
    "min_exec_time_improvement": 0.05,
    "min_p_value": 0.05
  }
}