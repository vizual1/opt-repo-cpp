{
  "metadata": {
    "collection_date": "2026-01-11T17:53:13.337744",
    "repository": "https://github.com/quick-lint/quick-lint-js",
    "repository_name": "quick-lint/quick-lint-js"
  },
  "commit_info": {
    "old_sha": "484d55e35e3eef9ad1528ccfe6b58f02975c383c",
    "new_sha": "d73e32f162836751c7d00c68da1336a169e8148a",
    "commit_message": [
      "refactor(fe): use span_size instead of int for object literal sizes\n\nReduce narrow_cast-ing.\n\nOn x86_64, this seems to have no performance penalty:\n\n    Benchmark                                     Time             CPU      Time Old      Time New       CPU Old       CPU New\n    --------------------------------------------------------------------------------------------------------------------------\n    benchmark_parse_file                       +0.0034         +0.0034       2074253       2081328       2074235       2081259\n    benchmark_parse_file                       +0.0026         +0.0026       2070954       2076320       2070943       2076303\n    benchmark_parse_file                       +0.0005         +0.0005       2069999       2071135       2069965       2071102\n    benchmark_parse_file                       -0.0011         -0.0012       2075410       2073025       2075382       2072956\n    benchmark_parse_file                       -0.0061         -0.0061       2086029       2073215       2086002       2073176\n    benchmark_parse_file                       -0.0033         -0.0032       2080115       2073346       2080054       2073305\n    benchmark_parse_file                       -0.0004         -0.0004       2074856       2074118       2074823       2074050\n    benchmark_parse_file                       +0.0058         +0.0058       2066870       2078872       2066839       2078835\n    benchmark_parse_file                       +0.0064         +0.0064       2065419       2078649       2065359       2078608\n    benchmark_parse_file                       +0.0065         +0.0065       2065748       2079127       2065716       2079083\n    benchmark_parse_file_pvalue                 0.2413          0.2413      U Test, Repetitions: 10 vs 10\n    benchmark_parse_file_mean                  +0.0014         +0.0014       2072965       2075914       2072932       2075868\n    benchmark_parse_file_median                +0.0013         +0.0012       2072603       2075219       2072589       2075177\n    benchmark_parse_file_stddev                -0.4841         -0.4845          6600          3405          6601          3403\n    benchmark_parse_file_cv                    -0.4849         -0.4852             0             0             0             0\n    OVERALL_GEOMEAN                            +0.0014         +0.0014             0             0             0             0"
    ],
    "commit_date": "2023-01-26T04:34:42+00:00",
    "patch": [
      "--- src/quick-lint-js/fe/expression.h\n@@ -270,10 +270,9 @@ class expression {\n   // Remove wrapping paren expressions, if any.\n   expression *without_paren() const noexcept;\n \n-  // TODO(strager): Return span_size instead.\n-  int object_entry_count() const noexcept;\n+  span_size object_entry_count() const noexcept;\n \n-  object_property_value_pair object_entry(int) const noexcept;\n+  object_property_value_pair object_entry(span_size) const noexcept;\n \n   source_code_span span() const noexcept;\n \n@@ -1243,19 +1242,18 @@ inline expression *expression::without_paren() const noexcept {\n   return const_cast<expression *>(ast);\n }\n \n-inline int expression::object_entry_count() const noexcept {\n+inline span_size expression::object_entry_count() const noexcept {\n   switch (this->kind_) {\n   case expression_kind::object:\n-    // TODO(strager): Remove this cast.\n-    return narrow_cast<int>(static_cast<const expression::object *>(this)->entries_.size());\n+    return static_cast<const expression::object *>(this)->entries_.size();\n \n   default:\n     QLJS_UNEXPECTED_EXPRESSION_KIND();\n   }\n }\n \n-inline object_property_value_pair expression::object_entry(int index) const\n-    noexcept {\n+inline object_property_value_pair expression::object_entry(\n+    span_size index) const noexcept {\n   switch (this->kind_) {\n   case expression_kind::object:\n     return static_cast<const expression::object *>(this)->entries_[index];\n--- src/quick-lint-js/fe/parse-expression.cpp\n@@ -148,7 +148,7 @@ void parser::visit_expression(expression* ast, parse_visitor_base& v,\n     break;\n   }\n   case expression_kind::object:\n-    for (int i = 0; i < ast->object_entry_count(); ++i) {\n+    for (span_size i = 0; i < ast->object_entry_count(); ++i) {\n       auto entry = ast->object_entry(i);\n \n       if (entry.init && entry.is_merged_property_and_value_shorthand()) {\n@@ -251,7 +251,7 @@ void parser::maybe_visit_assignment(expression* ast, parse_visitor_base& v) {\n     }\n     break;\n   case expression_kind::object:\n-    for (int i = 0; i < ast->object_entry_count(); ++i) {\n+    for (span_size i = 0; i < ast->object_entry_count(); ++i) {\n       expression* value = ast->object_entry(i).value;\n       this->maybe_visit_assignment(value, v);\n     }"
    ],
    "files_changed": [
      {
        "filename": "src/quick-lint-js/fe/expression.h",
        "status": "modified",
        "additions": 6,
        "deletions": 8,
        "changes": 14,
        "patch": "@@ -270,10 +270,9 @@ class expression {\n   // Remove wrapping paren expressions, if any.\n   expression *without_paren() const noexcept;\n \n-  // TODO(strager): Return span_size instead.\n-  int object_entry_count() const noexcept;\n+  span_size object_entry_count() const noexcept;\n \n-  object_property_value_pair object_entry(int) const noexcept;\n+  object_property_value_pair object_entry(span_size) const noexcept;\n \n   source_code_span span() const noexcept;\n \n@@ -1243,19 +1242,18 @@ inline expression *expression::without_paren() const noexcept {\n   return const_cast<expression *>(ast);\n }\n \n-inline int expression::object_entry_count() const noexcept {\n+inline span_size expression::object_entry_count() const noexcept {\n   switch (this->kind_) {\n   case expression_kind::object:\n-    // TODO(strager): Remove this cast.\n-    return narrow_cast<int>(static_cast<const expression::object *>(this)->entries_.size());\n+    return static_cast<const expression::object *>(this)->entries_.size();\n \n   default:\n     QLJS_UNEXPECTED_EXPRESSION_KIND();\n   }\n }\n \n-inline object_property_value_pair expression::object_entry(int index) const\n-    noexcept {\n+inline object_property_value_pair expression::object_entry(\n+    span_size index) const noexcept {\n   switch (this->kind_) {\n   case expression_kind::object:\n     return static_cast<const expression::object *>(this)->entries_[index];"
      },
      {
        "filename": "src/quick-lint-js/fe/parse-expression.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "patch": "@@ -148,7 +148,7 @@ void parser::visit_expression(expression* ast, parse_visitor_base& v,\n     break;\n   }\n   case expression_kind::object:\n-    for (int i = 0; i < ast->object_entry_count(); ++i) {\n+    for (span_size i = 0; i < ast->object_entry_count(); ++i) {\n       auto entry = ast->object_entry(i);\n \n       if (entry.init && entry.is_merged_property_and_value_shorthand()) {\n@@ -251,7 +251,7 @@ void parser::maybe_visit_assignment(expression* ast, parse_visitor_base& v) {\n     }\n     break;\n   case expression_kind::object:\n-    for (int i = 0; i < ast->object_entry_count(); ++i) {\n+    for (span_size i = 0; i < ast->object_entry_count(); ++i) {\n       expression* value = ast->object_entry(i).value;\n       this->maybe_visit_assignment(value, v);\n     }"
      }
    ],
    "lines_added": 8,
    "lines_removed": 10
  },
  "issues": [],
  "pull_requests": [],
  "build_info": {
    "old_build_script": "#!/bin/bash\n#!/bin/bash\ncmake -S /test_workspace/workspace/old -B /test_workspace/workspace/old/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DBENCHMARK_ENABLE_GTEST_TESTS=ON -DBUILD_TESTING=ON -DBENCHMARK_ENABLE_TESTING=ON -DBENCHMARK_USE_BUNDLED_GTEST=ON -DBENCHMARK_ENABLE_ASSEMBLY_TESTS=ON",
    "new_build_script": "#!/bin/bash\n#!/bin/bash\ncmake -S /test_workspace/workspace/old -B /test_workspace/workspace/old/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DBENCHMARK_ENABLE_GTEST_TESTS=ON -DBUILD_TESTING=ON -DBENCHMARK_ENABLE_TESTING=ON -DBENCHMARK_USE_BUNDLED_GTEST=ON -DBENCHMARK_ENABLE_ASSEMBLY_TESTS=ON",
    "old_test_script": "#!/bin/bash\ncmake --build /test_workspace/workspace/old/build -- -j 1",
    "new_test_script": "#!/bin/bash\ncmake --build /test_workspace/workspace/old/build -- -j 1",
    "build_system": "cmake"
  },
  "performance_analysis": {
    "is_significant": false,
    "p_value": 1.0,
    "is_pair_significant": false,
    "pair_p_value": 1.0,
    "is_binom_significant": false,
    "binom_p_value": 1.0,
    "is_wilcoxon_significant": false,
    "wilcoxon_p_value": 0.9999992705263888,
    "is_mannwhitney_significant": false,
    "mannwhitney_p_value": 0.9807084806676925,
    "relative_improvement": -0.004265908282971952,
    "absolute_improvement_ms": -4.0000000000000036,
    "old_mean_ms": 937.6666666666667,
    "new_mean_ms": 941.6666666666667,
    "old_std_ms": 7.738543627276631,
    "new_std_ms": 6.47719252365602,
    "effect_size_cohens_d": -0.5605543853736483,
    "old_ci95_ms": [
      934.7770469866714,
      940.5562863466621
    ],
    "new_ci95_ms": [
      939.24804322937,
      944.0852901039635
    ],
    "old_ci99_ms": [
      933.772283958326,
      941.5610493750075
    ],
    "new_ci99_ms": [
      938.4070524837332,
      944.9262808496003
    ],
    "new_times_s": [
      0.94,
      0.94,
      0.94,
      0.94,
      0.94,
      0.94,
      0.94,
      0.93,
      0.94,
      0.95,
      0.93,
      0.95,
      0.94,
      0.93,
      0.94,
      0.95,
      0.94,
      0.95,
      0.95,
      0.95,
      0.94,
      0.95,
      0.94,
      0.93,
      0.94,
      0.94,
      0.94,
      0.95,
      0.95,
      0.94,
      0.94
    ],
    "old_times_s": [
      0.95,
      0.95,
      0.94,
      0.94,
      0.94,
      0.94,
      0.93,
      0.92,
      0.94,
      0.94,
      0.93,
      0.94,
      0.94,
      0.94,
      0.95,
      0.93,
      0.94,
      0.93,
      0.93,
      0.93,
      0.94,
      0.93,
      0.95,
      0.94,
      0.93,
      0.94,
      0.95,
      0.95,
      0.94,
      0.93,
      0.93
    ]
  },
  "tests": {
    "total_tests": 2,
    "significant_improvements": 0,
    "significant_improvements_tests": [],
    "significant_regressions": 0,
    "significant_regressions_tests": [],
    "significant_pair_improvements": 0,
    "significant_pair_improvements_tests": [],
    "significant_pair_regressions": 0,
    "significant_pair_regressions_tests": [],
    "significant_binom_improvements": 0,
    "significant_binom_improvements_tests": [],
    "significant_binom_regressions": 0,
    "significant_binom_regressions_tests": [],
    "significant_wilcoxon_improvements": 0,
    "significant_wilcoxon_improvements_tests": [],
    "significant_wilcoxon_regressions": 0,
    "significant_wilcoxon_regressions_tests": [],
    "significant_mannwhitney_improvements": 0,
    "significant_mannwhitney_improvements_tests": [],
    "significant_mannwhitney_regressions": 1,
    "significant_mannwhitney_regressions_tests": [
      "quick-lint-js-test"
    ],
    "tests": [
      {
        "test_name": "quick-lint-js-test",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999992100120968,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.996695456706646,
        "relative_improvement": -0.0070999453850356395,
        "absolute_improvement_ms": -4.4827586206898085,
        "old_mean_ms": 631.3793103448276,
        "new_mean_ms": 635.8620689655173,
        "old_std_ms": 5.808945030255672,
        "new_std_ms": 5.6803177597927395,
        "effect_size_cohens_d": -0.780289875797972,
        "old_ci95_ms": [
          629.169705827152,
          633.588914862503
        ],
        "new_ci95_ms": [
          633.701391644851,
          638.0227462861836
        ],
        "old_ci99_ms": [
          628.398595680965,
          634.3600250086902
        ],
        "new_ci99_ms": [
          632.9473561641693,
          638.7767817668654
        ],
        "new_times": [
          0.63,
          0.63,
          0.64,
          0.63,
          0.64,
          0.63,
          0.64,
          0.64,
          0.63,
          0.64,
          0.64,
          0.63,
          0.64,
          0.63,
          0.63,
          0.63,
          0.64,
          0.64,
          0.64,
          0.64,
          0.63,
          0.63,
          0.64,
          0.64,
          0.63,
          0.65,
          0.64,
          0.63,
          0.64
        ],
        "old_times": [
          0.63,
          0.63,
          0.63,
          0.63,
          0.63,
          0.62,
          0.63,
          0.63,
          0.63,
          0.63,
          0.64,
          0.64,
          0.64,
          0.63,
          0.63,
          0.63,
          0.63,
          0.63,
          0.63,
          0.62,
          0.64,
          0.64,
          0.63,
          0.63,
          0.64,
          0.64,
          0.63,
          0.62,
          0.63
        ]
      },
      {
        "test_name": "quick-lint-js-test-cli",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999999638108507,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 1.0,
        "relative_improvement": 0.0,
        "absolute_improvement_ms": 0.0,
        "old_mean_ms": 100.00000000000003,
        "new_mean_ms": 100.00000000000003,
        "old_std_ms": 2.824686288200359e-14,
        "new_std_ms": 2.824686288200359e-14,
        "effect_size_cohens_d": 0.0,
        "old_ci95_ms": [
          100.00000000000001,
          100.00000000000004
        ],
        "new_ci95_ms": [
          100.00000000000001,
          100.00000000000004
        ],
        "old_ci99_ms": [
          100.00000000000001,
          100.00000000000004
        ],
        "new_ci99_ms": [
          100.00000000000001,
          100.00000000000004
        ],
        "new_times": [
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1
        ],
        "old_times": [
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1,
          0.1
        ]
      }
    ]
  },
  "logs": {
    "full_log_path": "/logs/full.log",
    "config_log_path": "/logs/config.log",
    "build_log_path": "/logs/build.log",
    "test_log_path": "/logs/test.log",
    "build_success": true,
    "test_success": true
  },
  "raw_timing_data": {
    "warmup_runs": 1,
    "measurement_runs": 30,
    "min_exec_time_improvement": 0.05,
    "min_p_value": 0.05
  }
}