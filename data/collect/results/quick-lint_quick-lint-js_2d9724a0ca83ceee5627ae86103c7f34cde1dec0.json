{
    "metadata": {
        "collection_date": "2026-01-14T18:38:02.949350",
        "repository": "https://github.com/quick-lint/quick-lint-js",
        "repository_name": "quick-lint/quick-lint-js"
    },
    "commit_info": {
        "old_sha": "635792c94ce9cc1fa4f2148ae9943fdae64390bf",
        "new_sha": "2d9724a0ca83ceee5627ae86103c7f34cde1dec0",
        "commit_message": [
            "Optimize buffering_error_reporter memory usage\n\nFuzz testing found a 630 KiB file which causes quick-lint-js to consume\n1.2 GiB of memory (peak RSS). Most of the memory is from\nbuffering_error_reporter. Each time its vector resizes, the old\nallocation is not freed (due to us using a monotonic_buffer_resource).\n\nMake buffering_error_reporter not reallocate/free memory by using a\ndeque instead of a vector. This works around monotonic_buffer_resource's\nweakness.\n\nWith this change, peak RSS drops from 1178.6 MiB to 398.1 MiB."
        ],
        "commit_date": "2021-10-21T05:04:43+00:00",
        "patch": [
            "--- src/buffering-error-reporter.cpp\n@@ -2,15 +2,15 @@\n // See end of file for extended copyright information.\n \n #include <boost/container/pmr/memory_resource.hpp>\n+#include <boost/container/pmr/polymorphic_allocator.hpp>\n+#include <deque>\n #include <memory>\n #include <quick-lint-js/allocator.h>\n #include <quick-lint-js/buffering-error-reporter.h>\n #include <quick-lint-js/char8.h>\n #include <quick-lint-js/token.h>\n #include <quick-lint-js/unreachable.h>\n-#include <quick-lint-js/vector.h>\n #include <type_traits>\n-#include <vector>\n \n namespace quick_lint_js {\n struct buffering_error_reporter::impl {\n@@ -34,7 +34,8 @@ struct buffering_error_reporter::impl {\n   };\n \n   boost::container::pmr::memory_resource *memory_;\n-  vector<any_error> errors_{\"buffering_error_reporter\", this->memory_};\n+  std::deque<any_error, boost::container::pmr::polymorphic_allocator<any_error>>\n+      errors_{this->memory_};\n };\n \n void buffering_error_reporter::impl_deleter::operator()(impl *i) noexcept {"
        ],
        "files_changed": [
            {
                "filename": "src/buffering-error-reporter.cpp",
                "status": "modified",
                "additions": 4,
                "deletions": 3,
                "changes": 7,
                "patch": "@@ -2,15 +2,15 @@\n // See end of file for extended copyright information.\n \n #include <boost/container/pmr/memory_resource.hpp>\n+#include <boost/container/pmr/polymorphic_allocator.hpp>\n+#include <deque>\n #include <memory>\n #include <quick-lint-js/allocator.h>\n #include <quick-lint-js/buffering-error-reporter.h>\n #include <quick-lint-js/char8.h>\n #include <quick-lint-js/token.h>\n #include <quick-lint-js/unreachable.h>\n-#include <quick-lint-js/vector.h>\n #include <type_traits>\n-#include <vector>\n \n namespace quick_lint_js {\n struct buffering_error_reporter::impl {\n@@ -34,7 +34,8 @@ struct buffering_error_reporter::impl {\n   };\n \n   boost::container::pmr::memory_resource *memory_;\n-  vector<any_error> errors_{\"buffering_error_reporter\", this->memory_};\n+  std::deque<any_error, boost::container::pmr::polymorphic_allocator<any_error>>\n+      errors_{this->memory_};\n };\n \n void buffering_error_reporter::impl_deleter::operator()(impl *i) noexcept {"
            }
        ],
        "lines_added": 4,
        "lines_removed": 3
    },
    "issues": [],
    "pull_requests": [],
    "build_info": {
        "old_build_script": [
            "apt-get update",
            "cmake -S /test_workspace/workspace/old -B /test_workspace/workspace/old/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DBENCHMARK_ENABLE_ASSEMBLY_TESTS=ON -DBUILD_TESTING=ON -DBENCHMARK_ENABLE_GTEST_TESTS=ON -DBENCHMARK_ENABLE_TESTING=ON",
            "cmake --build /test_workspace/workspace/old/build -- -j 1"
        ],
        "new_build_script": [
            "apt-get update",
            "cmake -S /test_workspace/workspace/new -B /test_workspace/workspace/new/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DBENCHMARK_ENABLE_ASSEMBLY_TESTS=ON -DBUILD_TESTING=ON -DBENCHMARK_ENABLE_GTEST_TESTS=ON -DBENCHMARK_ENABLE_TESTING=ON",
            "cmake --build /test_workspace/workspace/new/build -- -j 1"
        ],
        "old_test_script": [
            "cd /test_workspace/workspace/old/build",
            "ctest --output-on-failure"
        ],
        "new_test_script": [
            "cd /test_workspace/workspace/new/build",
            "ctest --output-on-failure"
        ],
        "build_system": "cmake"
    },
    "performance_analysis": {
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.9999993849573857,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.9588008888949371,
        "relative_improvement": -0.002740476842970521,
        "absolute_improvement_ms": -3.3333333333331883,
        "old_mean_ms": 1216.3333333333335,
        "new_mean_ms": 1219.6666666666667,
        "old_std_ms": 11.290317283753202,
        "new_std_ms": 9.278574999588496,
        "effect_size_cohens_d": -0.32257485787137946,
        "old_ci95_ms": [
            1212.1174595736338,
            1220.5492070930331
        ],
        "new_ci95_ms": [
            1216.20198982145,
            1223.1313435118834
        ],
        "old_ci99_ms": [
            1210.6515386030499,
            1222.015128063617
        ],
        "new_ci99_ms": [
            1214.9972710055663,
            1224.336062327767
        ],
        "new_times_s": [
            1.23,
            1.22,
            1.22,
            1.21,
            1.22,
            1.22,
            1.22,
            1.22,
            1.22,
            1.22,
            1.23,
            1.22,
            1.26,
            1.21,
            1.22,
            1.22,
            1.22,
            1.22,
            1.21,
            1.22,
            1.22,
            1.22,
            1.22,
            1.22,
            1.23,
            1.22,
            1.21,
            1.21,
            1.21,
            1.22,
            1.21
        ],
        "old_times_s": [
            1.21,
            1.21,
            1.22,
            1.23,
            1.22,
            1.22,
            1.22,
            1.21,
            1.2,
            1.21,
            1.22,
            1.22,
            1.21,
            1.22,
            1.22,
            1.22,
            1.22,
            1.22,
            1.21,
            1.2,
            1.21,
            1.23,
            1.21,
            1.21,
            1.22,
            1.22,
            1.21,
            1.21,
            1.2,
            1.21,
            1.26
        ]
    },
    "tests": {
        "total_tests": 2,
        "significant_improvements": 0,
        "significant_improvements_tests": [],
        "significant_regressions": 0,
        "significant_regressions_tests": [],
        "significant_pair_improvements": 0,
        "significant_pair_improvements_tests": [],
        "significant_pair_regressions": 0,
        "significant_pair_regressions_tests": [],
        "significant_binom_improvements": 0,
        "significant_binom_improvements_tests": [],
        "significant_binom_regressions": 0,
        "significant_binom_regressions_tests": [],
        "significant_wilcoxon_improvements": 0,
        "significant_wilcoxon_improvements_tests": [],
        "significant_wilcoxon_regressions": 0,
        "significant_wilcoxon_regressions_tests": [],
        "significant_mannwhitney_improvements": 0,
        "significant_mannwhitney_improvements_tests": [],
        "significant_mannwhitney_regressions": 1,
        "significant_mannwhitney_regressions_tests": [
            "quick-lint-js-test"
        ],
        "tests": [
            {
                "test_name": "quick-lint-js-test",
                "is_significant": false,
                "p_value": 0.9999999999999771,
                "is_pair_significant": false,
                "pair_p_value": 0.9999999999990579,
                "is_binom_significant": false,
                "binom_p_value": 0.9999999981373549,
                "is_wilcoxon_significant": false,
                "wilcoxon_p_value": 0.999994910577808,
                "is_mannwhitney_significant": false,
                "mannwhitney_p_value": 0.9679905895653377,
                "relative_improvement": -0.0013812154696132301,
                "absolute_improvement_ms": -0.6896551724137057,
                "old_mean_ms": 499.3103448275863,
                "new_mean_ms": 500.0,
                "old_std_ms": 10.99708873252977,
                "new_std_ms": 2.672612419124246,
                "effect_size_cohens_d": -0.08618036727071819,
                "old_ci95_ms": [
                    495.1272759883883,
                    503.49341366678425
                ],
                "new_ci95_ms": [
                    498.9833926049335,
                    501.0166073950665
                ],
                "old_ci99_ms": [
                    493.66746415405254,
                    504.9532255011201
                ],
                "new_ci99_ms": [
                    498.6286158696609,
                    501.3713841303391
                ],
                "new_times": [
                    0.5,
                    0.49,
                    0.5,
                    0.5,
                    0.5,
                    0.51,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5
                ],
                "old_times": [
                    0.5,
                    0.51,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.49,
                    0.5,
                    0.5,
                    0.49,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.49,
                    0.5,
                    0.5,
                    0.5,
                    0.5,
                    0.49,
                    0.49,
                    0.5,
                    0.5,
                    0.49,
                    0.5,
                    0.49,
                    0.49,
                    0.55
                ]
            },
            {
                "test_name": "quick-lint-js-test-cli",
                "is_significant": false,
                "p_value": 0.9999993694514655,
                "is_pair_significant": false,
                "pair_p_value": 0.9999993694514655,
                "is_binom_significant": false,
                "binom_p_value": 1.0,
                "is_wilcoxon_significant": false,
                "wilcoxon_p_value": 0.99999991548966,
                "is_mannwhitney_significant": false,
                "mannwhitney_p_value": 0.926663564827266,
                "relative_improvement": -0.015325670498084306,
                "absolute_improvement_ms": -1.3793103448275916,
                "old_mean_ms": 89.99999999999999,
                "new_mean_ms": 91.37931034482757,
                "old_std_ms": 1.4123431441001795e-14,
                "new_std_ms": 5.157614295551276,
                "effect_size_cohens_d": -0.3782057526207851,
                "old_ci95_ms": [
                    89.99999999999999,
                    89.99999999999999
                ],
                "new_ci95_ms": [
                    89.41745878856032,
                    93.34116190109484
                ],
                "old_ci99_ms": [
                    89.99999999999997,
                    90.0
                ],
                "new_ci99_ms": [
                    88.73280973564202,
                    94.02581095401314
                ],
                "new_times": [
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.11,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.11,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09
                ],
                "old_times": [
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09,
                    0.09
                ]
            }
        ]
    },
    "logs": {
        "full_log_path": "/logs/full.log",
        "config_log_path": "/logs/config.log",
        "build_log_path": "/logs/build.log",
        "test_log_path": "/logs/test.log",
        "build_success": true,
        "test_success": true
    },
    "raw_timing_data": {
        "warmup_runs": 1,
        "measurement_runs": 30,
        "min_exec_time_improvement": 0.05,
        "min_p_value": 0.05
    }
}