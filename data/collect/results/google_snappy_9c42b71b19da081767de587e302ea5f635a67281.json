{
  "metadata": {
    "collection_date": "2026-01-11T17:52:31.408206",
    "repository": "https://github.com/google/snappy",
    "repository_name": "google/snappy"
  },
  "commit_info": {
    "old_sha": "dc05e026488865bc69313a68bcc03ef2e4ea8e83",
    "new_sha": "9c42b71b19da081767de587e302ea5f635a67281",
    "commit_message": [
      "Optimize check for uncommon decompression for ARM, saving two instructions and three cycles.\n\nPiperOrigin-RevId: 517141646"
    ],
    "commit_date": "2023-03-16T16:20:43+00:00",
    "patch": [
      "--- snappy.cc\n@@ -1234,16 +1234,21 @@ std::pair<const uint8_t*, ptrdiff_t> DecompressBranchless(\n         assert(tag == ip[-1]);\n         // For literals tag_type = 0, hence we will always obtain 0 from\n         // ExtractLowBytes. For literals offset will thus be kLiteralOffset.\n-        ptrdiff_t len_min_offset = kLengthMinusOffset[tag];\n+        ptrdiff_t len_minus_offset = kLengthMinusOffset[tag];\n+        uint32_t next;\n #if defined(__aarch64__)\n         size_t tag_type = AdvanceToNextTagARMOptimized(&ip, &tag);\n+        // We never need more than 16 bits. Doing a Load16 allows the compiler\n+        // to elide the masking operation in ExtractOffset.\n+        next = LittleEndian::Load16(old_ip);\n #else\n         size_t tag_type = AdvanceToNextTagX86Optimized(&ip, &tag);\n+        next = LittleEndian::Load32(old_ip);\n #endif\n-        uint32_t next = LittleEndian::Load32(old_ip);\n-        size_t len = len_min_offset & 0xFF;\n-        len_min_offset -= ExtractOffset(next, tag_type);\n-        if (SNAPPY_PREDICT_FALSE(len_min_offset > 0)) {\n+        size_t len = len_minus_offset & 0xFF;\n+        ptrdiff_t extracted = ExtractOffset(next, tag_type);\n+        ptrdiff_t len_min_offset = len_minus_offset - extracted;\n+        if (SNAPPY_PREDICT_FALSE(len_minus_offset > extracted)) {\n           if (SNAPPY_PREDICT_FALSE(len & 0x80)) {\n             // Exceptional case (long literal or copy 4).\n             // Actually doing the copy here is negatively impacting the main"
    ],
    "files_changed": [
      {
        "filename": "snappy.cc",
        "status": "modified",
        "additions": 10,
        "deletions": 5,
        "changes": 15,
        "patch": "@@ -1234,16 +1234,21 @@ std::pair<const uint8_t*, ptrdiff_t> DecompressBranchless(\n         assert(tag == ip[-1]);\n         // For literals tag_type = 0, hence we will always obtain 0 from\n         // ExtractLowBytes. For literals offset will thus be kLiteralOffset.\n-        ptrdiff_t len_min_offset = kLengthMinusOffset[tag];\n+        ptrdiff_t len_minus_offset = kLengthMinusOffset[tag];\n+        uint32_t next;\n #if defined(__aarch64__)\n         size_t tag_type = AdvanceToNextTagARMOptimized(&ip, &tag);\n+        // We never need more than 16 bits. Doing a Load16 allows the compiler\n+        // to elide the masking operation in ExtractOffset.\n+        next = LittleEndian::Load16(old_ip);\n #else\n         size_t tag_type = AdvanceToNextTagX86Optimized(&ip, &tag);\n+        next = LittleEndian::Load32(old_ip);\n #endif\n-        uint32_t next = LittleEndian::Load32(old_ip);\n-        size_t len = len_min_offset & 0xFF;\n-        len_min_offset -= ExtractOffset(next, tag_type);\n-        if (SNAPPY_PREDICT_FALSE(len_min_offset > 0)) {\n+        size_t len = len_minus_offset & 0xFF;\n+        ptrdiff_t extracted = ExtractOffset(next, tag_type);\n+        ptrdiff_t len_min_offset = len_minus_offset - extracted;\n+        if (SNAPPY_PREDICT_FALSE(len_minus_offset > extracted)) {\n           if (SNAPPY_PREDICT_FALSE(len & 0x80)) {\n             // Exceptional case (long literal or copy 4).\n             // Actually doing the copy here is negatively impacting the main"
      }
    ],
    "lines_added": 10,
    "lines_removed": 5
  },
  "issues": [],
  "pull_requests": [],
  "build_info": {
    "old_build_script": "#!/bin/bash\n#!/bin/bash\ncmake -S /test_workspace/workspace/old -B /test_workspace/workspace/old/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DSNAPPY_BUILD_TESTS=ON -DBENCHMARK_ENABLE_GTEST_TESTS=ON -DBENCHMARK_ENABLE_TESTING=ON -DBENCHMARK_ENABLE_ASSEMBLY_TESTS=ON",
    "new_build_script": "#!/bin/bash\n#!/bin/bash\ncmake -S /test_workspace/workspace/old -B /test_workspace/workspace/old/build -DCMAKE_BUILD_TYPE=Debug -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DSNAPPY_BUILD_TESTS=ON -DBENCHMARK_ENABLE_GTEST_TESTS=ON -DBENCHMARK_ENABLE_TESTING=ON -DBENCHMARK_ENABLE_ASSEMBLY_TESTS=ON",
    "old_test_script": "#!/bin/bash\ncmake --build /test_workspace/workspace/old/build -- -j 1",
    "new_test_script": "#!/bin/bash\ncmake --build /test_workspace/workspace/old/build -- -j 1",
    "build_system": "cmake"
  },
  "performance_analysis": {
    "is_significant": false,
    "p_value": 1.0,
    "is_pair_significant": false,
    "pair_p_value": 1.0,
    "is_binom_significant": false,
    "binom_p_value": 1.0,
    "is_wilcoxon_significant": false,
    "wilcoxon_p_value": 0.9999991681944211,
    "is_mannwhitney_significant": false,
    "mannwhitney_p_value": 0.9999999991156735,
    "relative_improvement": -0.0036794112941928563,
    "absolute_improvement_ms": -38.33333333333222,
    "old_mean_ms": 10418.333333333334,
    "new_mean_ms": 10456.666666666668,
    "old_std_ms": 13.412123525797721,
    "new_std_ms": 25.097510981594795,
    "effect_size_cohens_d": -1.9050690042746004,
    "old_ci95_ms": [
      10413.325164101843,
      10423.341502564826
    ],
    "new_ci95_ms": [
      10447.295102048785,
      10466.038231284549
    ],
    "old_ci99_ms": [
      10411.583750407048,
      10425.082916259622
    ],
    "new_ci99_ms": [
      10444.036471956048,
      10469.296861377286
    ],
    "new_times_s": [
      10.46,
      10.43,
      10.44,
      10.45,
      10.44,
      10.52,
      10.46,
      10.48,
      10.47,
      10.46,
      10.47,
      10.46,
      10.43,
      10.46,
      10.46,
      10.43,
      10.5,
      10.43,
      10.44,
      10.44,
      10.44,
      10.43,
      10.53,
      10.45,
      10.44,
      10.45,
      10.46,
      10.47,
      10.47,
      10.44,
      10.45
    ],
    "old_times_s": [
      10.45,
      10.4,
      10.45,
      10.42,
      10.44,
      10.42,
      10.44,
      10.42,
      10.44,
      10.41,
      10.41,
      10.42,
      10.43,
      10.41,
      10.41,
      10.41,
      10.41,
      10.39,
      10.42,
      10.42,
      10.42,
      10.42,
      10.43,
      10.42,
      10.4,
      10.41,
      10.41,
      10.4,
      10.42,
      10.42,
      10.43
    ]
  },
  "tests": {
    "total_tests": 1,
    "significant_improvements": 0,
    "significant_improvements_tests": [],
    "significant_regressions": 0,
    "significant_regressions_tests": [],
    "significant_pair_improvements": 0,
    "significant_pair_improvements_tests": [],
    "significant_pair_regressions": 0,
    "significant_pair_regressions_tests": [],
    "significant_binom_improvements": 0,
    "significant_binom_improvements_tests": [],
    "significant_binom_regressions": 0,
    "significant_binom_regressions_tests": [],
    "significant_wilcoxon_improvements": 0,
    "significant_wilcoxon_improvements_tests": [],
    "significant_wilcoxon_regressions": 0,
    "significant_wilcoxon_regressions_tests": [],
    "significant_mannwhitney_improvements": 0,
    "significant_mannwhitney_improvements_tests": [],
    "significant_mannwhitney_regressions": 1,
    "significant_mannwhitney_regressions_tests": [
      "snappy_unittest"
    ],
    "tests": [
      {
        "test_name": "snappy_unittest",
        "is_significant": false,
        "p_value": 1.0,
        "is_pair_significant": false,
        "pair_p_value": 1.0,
        "is_binom_significant": false,
        "binom_p_value": 1.0,
        "is_wilcoxon_significant": false,
        "wilcoxon_p_value": 0.999998777698409,
        "is_mannwhitney_significant": false,
        "mannwhitney_p_value": 0.9999999971966308,
        "relative_improvement": -0.003674280039721803,
        "absolute_improvement_ms": -38.27586206896605,
        "old_mean_ms": 10417.241379310346,
        "new_mean_ms": 10455.517241379312,
        "old_std_ms": 14.115986814382971,
        "new_std_ms": 24.140393963016905,
        "effect_size_cohens_d": -1.9356691598485833,
        "old_ci95_ms": [
          10411.871945088804,
          10422.610813531888
        ],
        "new_ci95_ms": [
          10446.334726605746,
          10464.699756152877
        ],
        "old_ci99_ms": [
          10409.99811419536,
          10424.484644425333
        ],
        "new_ci99_ms": [
          10443.130202785864,
          10467.90427997276
        ],
        "new_times": [
          10.44,
          10.45,
          10.44,
          10.51,
          10.46,
          10.48,
          10.46,
          10.46,
          10.47,
          10.45,
          10.43,
          10.46,
          10.46,
          10.43,
          10.49,
          10.43,
          10.44,
          10.44,
          10.44,
          10.42,
          10.53,
          10.45,
          10.44,
          10.44,
          10.46,
          10.47,
          10.47,
          10.44,
          10.45
        ],
        "old_times": [
          10.45,
          10.42,
          10.44,
          10.41,
          10.44,
          10.42,
          10.44,
          10.41,
          10.41,
          10.42,
          10.43,
          10.41,
          10.41,
          10.41,
          10.4,
          10.39,
          10.42,
          10.42,
          10.42,
          10.41,
          10.43,
          10.41,
          10.4,
          10.4,
          10.41,
          10.4,
          10.42,
          10.42,
          10.43
        ]
      }
    ]
  },
  "logs": {
    "full_log_path": "/logs/full.log",
    "config_log_path": "/logs/config.log",
    "build_log_path": "/logs/build.log",
    "test_log_path": "/logs/test.log",
    "build_success": true,
    "test_success": true
  },
  "raw_timing_data": {
    "warmup_runs": 1,
    "measurement_runs": 30,
    "min_exec_time_improvement": 0.05,
    "min_p_value": 0.05
  }
}